Echo Beth1:
Echo Beth1:======================================================
Echo Beth1:Performing Release Bethany specific things...
Echo Beth1:======================================================
Echo

Echo Beth1:In project Bethany, all we do is copy over the release note and ReadMe
Echo Beth1: files over the ones that come from the template.

Echo
Echo Beth1:It searches through these two files and replaces tokens with ones set in
Echo Beth1: system variables. This allows files to be altered in simple ways
Echo Beth1: without buildmaster invention.

Echo
Echo Beth1:Currently recognised tags are :
Echo Beth1:${Release} (the release number);
Echo Beth1:${BuildMaster} (the buildmaster's email address); 
Echo Beth1:${BuildDate} (The date that the build was performed).
Echo Beth1:${BuildImageName} (The name of the image that was produced from this source tree).
Echo Beth1:${CPUType} (The CPU type that was on the build machine)
Echo Beth1:${OSVersion} (The OS Version running on the build machine)
Echo Beth1:${DRAMSize} (The amount of DRAM in the build machine)
Echo Beth1:${VRAMSize} (The amount of VRAM in the build machine)

|
| Please note - the section below is copied from the DoRelease script.

Echo Beth1: ****************************************************************************** 
Echo Beth1: Preparing the image for release...
Echo Beth1: <Sys$Date> <Sys$Time>
Echo Beth1: ****************************************************************************** 

set AutoBuild$CurrentDoReleaseDir <obey$dir>

| ImageName still points to the Beth2 name. It needs to be the Beth1 name.
| Hence reset the var to point to the Beth1 one.
Set Build$ImageName <AutoBuild$ImageName1>

| Run the !SetEnvs file that was copied over from the build.
|<AutoBuild$CurrentDoReleaseDir>.^.sysvars

| Ensure that certain required files are present...

| Get the required image name
|<AutoBuild$ImageRepositoryDir>.<Build$ImageName>.Package.Releaser 

| Rename the image...
|Echo Beth1:
|Echo Beth1: Renaming the image...
|Rename <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.<Build$ImageName> <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.<AutoBuild$ReleaseName>
|Echo Beth1:
|Echo Beth1: Renaming the repository directory...
| Rename the repository directory...
|Rename <AutoBuild$ImageRepositoryDir>.<Build$ImageName> <AutoBuild$ImageRepositoryDir>.<AutoBuild$ReleaseName>

| Set the sys var to point to the new name.
|Set Build$ImageName <AutoBuild$ReleaseName>
|Set AutoBuild$CurrentDoReleaseDir <AutoBuild$ImageRepositoryDir>.<AutoBuild$ReleaseName>
|Set obey$dir <AutoBuild$CurrentDoReleaseDir>
|Dir <obey$dir>

| Now create a filecrc of the image
Echo Beth1:
Do Echo Beth1: Creating a FileCRC of the image <SrcBuild$ImageLocation>...
Inet:bin.X do filecrc -create -crc -single -d <SrcBuild$ImageLocation> -f <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.ImageCRC

| Now do a RomInfo of the image.
Echo Beth1:
Do Echo Beth1: Performing a ROMInfo of the image <SrcBuild$ImageLocation>...
Inet:bin.X do rominfo -csv <SrcBuild$ImageLocation> { > <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.RomInfo }
Settype <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.RomInfo fff

| Now zip up the image.
Echo Beth1:
Echo Beth1: Archiving the image...
Dir <AutoBuild$ImageRepositoryDir>.<Build$ImageName>
Inet:bin.X do zip <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.imagezip <Build$ImageName> -9 

| Now create a filecrc of the image archive
Echo Beth1:
Echo Beth1: Creating a FileCRC of the image archive...
Inet:bin.X do filecrc -create -crc -single -d <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.imagezip -f <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.ArcCRC


|
| Create the 'Altered' directory if not already there.
Set AutoBuild$TempAlterationsDir <obey$dir>.Altered
show <AutoBuild$TempAlterationsDir>
Ifthere <AutoBuild$TempAlterationsDir> Then Echo Beth1:Else mkdir -p <AutoBuild$TempAlterationsDir>

|
| Get the system information...
Do <AutoBuildBin$Dir>.CPU+Mem



|
| Now create the SIS for the Bethany UK/French/Italian main OS image.
| Need to set some system variables...
Set AutoBuildProject$DONumber 2503,013
Set AutoBuildProject$DOTitle Bethany OS for IAC hardware (UK, French and Italian)
^.^.Package.GetECO
Set AutoBuildProject$DOIssNumber $ENV{$Project_env_ReleaseNum};
Perl <AutoBuildBin$Dir>.CreateSIS <Obey$Dir>.Originals.Beth1SIS <AutoBuild$TempAlterationsDir>.Beth1SIS

|
| Now create the SIS for the first split UK/French/Italian image.
| Need to set some system variables...
Set AutoBuildProject$DONumber 2503,016
Set AutoBuildProject$DOTitle Bethany OS for IAC hardware (UK, French and Italian).
Set AutoBuildProject$DOTitle2 ROM 0 [data 0..15]
^.^.Package.GetECO
Set AutoBuildProject$DOIssNumber $ENV{$Project_env_ReleaseNum};
Perl <AutoBuildBin$Dir>.CreateSIS <Obey$Dir>.Originals.Split10SIS <AutoBuild$TempAlterationsDir>.Split10SIS

|
| Now create the SIS for the second split UK/French/Italian image.
| Need to set some system variables...
Set AutoBuildProject$DONumber 2503,017
Set AutoBuildProject$DOTitle Bethany OS for IAC hardware (UK, French and Italian).
Set AutoBuildProject$DOTitle2 ROM 0 [data 16..31]
^.^.Package.GetECO
Set AutoBuildProject$DOIssNumber $ENV{$Project_env_ReleaseNum};
Perl <AutoBuildBin$Dir>.CreateSIS <Obey$Dir>.Originals.Split11SIS <AutoBuild$TempAlterationsDir>.Split11SIS



|
| Now perform SED operations on the !ReadMe and HowBuild files...
Perl <AutoBuildBin$Dir>.CreateSIS <Obey$Dir>.Originals.!ReadMe <AutoBuild$TempAlterationsDir>.!ReadMe
Perl <AutoBuildBin$Dir>.CreateSIS <Obey$Dir>.Originals.HowBuild <AutoBuild$TempAlterationsDir>.HowBuild



|
| Now copy the files over to their proper location in the CD structure.
Do copy <AutoBuild$TempAlterationsDir>.HowBuild <AutoBuild$CDArchivePath>.<AutoBuild$ReleaseName>.ReadMe.HowBuild ~CF~V
Do copy <AutoBuild$TempAlterationsDir>.!ReadMe <AutoBuild$CDArchivePath>.<AutoBuild$ReleaseName>.ReadMe.!ReadMe ~CF~V


| Copy the SIS's over into their own directory in the image repository directory.
Do mkdir -p <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.SIS
settype <AutoBuild$TempAlterationsDir>.Beth1SIS FAF
settype <AutoBuild$TempAlterationsDir>.Split10SIS FAF
settype <AutoBuild$TempAlterationsDir>.Split11SIS FAF
Do copy <AutoBuild$TempAlterationsDir>.Beth1SIS <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.SIS.Beth1SIS ~CF~V
Do copy <AutoBuild$TempAlterationsDir>.Split10SIS <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.SIS.Split10SIS ~CF~V
Do copy <AutoBuild$TempAlterationsDir>.Split11SIS <AutoBuild$ImageRepositoryDir>.<Build$ImageName>.SIS.Split11SIS ~CF~V

| Open the altered files. Hopefully this will make people actually read them.
Filer_Run <AutoBuild$CDArchivePath>.<AutoBuild$ReleaseName>.ReadMe.HowBuild
Filer_Run <AutoBuild$CDArchivePath>.<AutoBuild$ReleaseName>.ReadMe.!ReadMe


|
| Tidy up - remove temporary files.
Remove <AutoBuild$TempAlterationsDir>.!ReadMe
Remove <AutoBuild$TempAlterationsDir>.!ReadMe2
Remove <AutoBuild$TempAlterationsDir>.!ReadMe3
Remove <AutoBuild$TempAlterationsDir>.HowBuild
Remove <AutoBuild$TempAlterationsDir>.HowBuild2
Remove <AutoBuild$TempAlterationsDir>.HowBuild3
Remove <AutoBuild$TempAlterationsDir>.Beth1SIS
Remove <AutoBuild$TempAlterationsDir>.Split10SIS
Remove <AutoBuild$TempAlterationsDir>.Split11SIS

|
| We have finished.
Echo
Echo Beth1:======================================================
Echo Beth1:Finished Release Bethany specific things...
Echo Beth1:======================================================
Echo
