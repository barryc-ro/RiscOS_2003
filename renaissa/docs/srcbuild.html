<html>
<head><title>srcbuild and !Builder instructions</title></head>
<body BGCOLOR="#ffffff">

<center><h1>srcbuild and !Builder instructions</h1></center>

<hr>

<center>
<table border="0" width="40%">
<tr><td>Project:	<td>Renaissance
<tr><td COLSPAN=2>$Revision$
<tr><td COLSPAN=2>$Date$
<tr><td>Author(s):	<td><a href="mailto:rbuckley">Rich Buckley</a>
</table>
</center>
<hr>
<p>
<h2>Overview</h2>
<p>
<code>srcbuild</code> is a RISC OS command line application used to drive the
ROM build process. It has a number of0 <a href="#srcbuild_depend">dependancies
</a> which are listed below.
<p>
<code>!Builder</code> is a RISC OS wimp application which presents a
graphical front end to the build process. It greatly simplifies the selection
of build parameters and  facilitates the management of image version numbers.

<p>
<h2>srcbuild usage</h2>
<p>
The following build process phases are provided by <code>srcbuild</code>, they are invoked
by specifing them on the command line as parameters to <code>srcbuild</code>.
<center>
<table border="1">
<tr><th>Phase       <th>Action
<tr><td>list        <td>list all items in build.
<tr><td>clean       <td>force a clean make of all items.
<tr><td>export_hdrs <td>export headers
<tr><td>export_libs <td>export libraries
<tr><td>resources   <td>export resources
<tr><td>rom	    <td>build for rom
<tr><td>install_rom <td>install and link C modules
<tr><td>join        <td>run joiner application
</table>
</center>
<p>
Each also corresponds to a tick-box on the !Builder build options window.
<p>
<h2>!Builder usage</h2>
<p>
!Builder is a Wimp application designed to ease the ROM building process. Clicking on
the icon bar for the first time will open a window as shown below.
<p>
<center>
<img src="./pics/builder_reg.gif">
</center>
<p>
This window can also be opened by the icon bar menu "Register build tree...". Dragging
directories onto this window adds them to the list of available build trees. The Add
button can be used if a directory path is typed into the window, Remove button is obvious.
Clicking Save will store the list of build directories away in the file 
<code>&lt;Choices$Write&gt;.Builder.Builds</code>.
<p>
Once !Builder knows about at least one build directory, clicking on the icon bar will
open the following window.
<p>
<center>
<img src="./pics/builder_opt.gif">
</center>
<p>
The build directory and Environment should be chosen from the list available. The 
Environment list is generated by enumerating the files in the <code>Env</code>
directory. Selecting an environment will run the appropriate file therefore setting
up the build environment for that target.
<p>
Clicking the Build button will remove the window and invoke a build using the given
options. The build is started by <code>Wimp_StartTask'ing</code> the file 
<code>!Builder.!build</code>. This ensures the wimpslot is big enough and runs the
following :
<p>
<ol>
 <li> optional script for version number control using parameter %0
 <li> <code>srcbuild</code> using all remaining parameters
</ol>
<p>
The method of version number control can be selected by the three radio buttons at the
bottom of the window. "Don't" is the default. Selecting different values passes different
parameters to the version control perl script.
<p>
Default values of build directory, environment and build options can be saved by the
menu option "Save as default". This stores values 
<code>&lt;Choices$Write&gt;.Builder.Defaults</code> which are read in next time the
application is loaded.
<p>
<h3><a name="srcbuild_depend">srcbuild dependancies</a></h3>
<p>
The following files and directories are all located off the root directory in
the build tree, otherwise known as &lt;Build$Dir&gt;.

<h4>Environment files</h4>
<p>
Environment files are used to establish what build options. An environment
file is an obey file that sets a number of build parameters and finally runs
a common environment file <code><b>!Common</b></code> that resides in the root build
directory.  All environment files should now reside in a directory <code>
<b>Env</b></code> off the root build directory. Filenames are not significant but
should be chosen to reflect the nature of the build being setup.
<p>
A typical environment file would look like this :
<p>
<blockquote>
<pre>
| Example environement obey file
|
| What lingo should be use ...
<b>set Locale     UK</b>
| ... and where is it going to used.
<b>set Keyboard   USA</b>
| What Hardware platform should it run on ...
<b>set Machine    Boca</b>
| ... and what software stack it to be used.
<b>set System     RCA</b>
| How is it going to look (user interface) ...
<b>set UserIF     NC2</b>
| ... and how are we going to display it.
<b>set Display    NTSC</b>
| How big will it be ...
<b>set ImageSize  8192K</b>
| ... and what we going to call it.
<b>set Build      RNBN</b>
|
| Now establish the generic build bits.
<b>Obey &lt;Obey$Dir&gt;.^.!Common</b>
</pre>
</blockquote>
<p>
<h4>Module Database</h4>
<p>
The module database constructed as described in the <a href="./srcbuild_wp.html">
srcbuild workpackage</a> should reside in the directory <code><b>BuildSys</b></code>
 and  should be called <code><b>ModuleDB</b></code>.
<p>
<h4>Component files</h4>
<p>
All component files should reside in the directory <code><b>BuildSys.Components
</b></code>. Filenames are significant and should be the same as the <code><b>
Build</b></code> environemt variable as set in the Env file.
<p>
<h4>Images</h4>
<p>
Final ROM images are written to the directory <code><b>Images</b></code>. The actual
filename is specified in the components file and should reflect both the build name
and version number.
<p>
<h4>Install</h4>
<p>
Prior to joining all modules to make a ROM, all build targets are copied to a 
directory <code><b>Install.&lt;Build&gt;</b></code>. This ensures that modules
from different builds do not conflict.
<p>
<h4>Logs</h4>
<p>
All log files are stored in the directory <code><b>BuildSys.Logs</b></code> the actual
filename is specified in the components file and should reflect both the build name
and version number.
<p>
<h2> <a name="history"> History </a> </h2>
<p>

<pre>
$Log$
</pre>
</body>
</html>