; Some useful macros

	MACRO
	FUNC $var
	EXPORT $var
	DCB "$var",0
	ALIGN 4
	DCD &FF000000+(:LEN:"$var"+4):AND::NOT:3
	ALIGN 16
$var
#ifdef PROFILE
        MOV R12,R13
        STMFD R13!,{R11,R14}
        SUB R11,R12,#4
        CMP R13,R10
        BLLT __rt_stkovf_split_small
        BL _count1
        DCD 0
        DCD &1000
        LDMFD R13!,{R11,R14}
#endif
	MEND

	MACRO
	FUNCEND
#ifdef PROFILE
	DCD &FFF12340
	DCB "asm",0
	DCD &31415926
#endif
	MEND

#ifdef PROFILE
	IMPORT _count1
	IMPORT __rt_stkovf_split_small
#endif

	MACRO
	COPYPAD $dst,$src,$len,$pad
	MOV R2,#$len
	MOV R3,$dst
1	 LDRB R14,[$src],#1
	 STRB R14,[$dst],#1
	 TEQ R14,#$pad
	 MOVNE R3,$dst
	 SUBS R2,R2,#1
	BGT %b1
	MOV R14,#0
	STRB R14,[R3]
	MEND

	MACRO
	COPYPAD_lenreg $dst,$src,$len,$pad
	MOV R3,$dst
1	 LDRB R14,[$src],#1
	 STRB R14,[$dst],#1
	 TEQ R14,#$pad
	 MOVNE R3,$dst
	 SUBS $len,$len,#1
	BGT %b1
	MOV R14,#0
	STRB R14,[R3]
	MEND

