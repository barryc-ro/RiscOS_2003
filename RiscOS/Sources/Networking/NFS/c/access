/* check object access permissions
 *
 * 28/7/92 by JRS
 */


#include "access.h"

bool_t access_Icanread(MountPoint *mount, fattr3 *attrib)
{
        mode3 mode = attrib->mode;

        if (mount->user->uid == attrib->uid)
                return (bool_t) (mode&NFSMODE_USER_READ);

        else if (mount->user->gid == attrib->gid)
                return (bool_t) (mode&NFSMODE_GROUP_READ);

        else
                return (bool_t) (mode&NFSMODE_OTHERS_READ);
}

bool_t access_Icanwrite(MountPoint *mount, fattr3 *attrib)
{
        mode3 mode = attrib->mode;

        if (mount->user->uid == attrib->uid)
                return (bool_t) (mode&NFSMODE_USER_WRITE);

        else if (mount->user->gid == attrib->gid)
                return (bool_t) (mode&NFSMODE_GROUP_WRITE);

        else
                return (bool_t) (mode&NFSMODE_OTHERS_WRITE);
}
