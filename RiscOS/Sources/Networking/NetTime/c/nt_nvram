#include <stdio.h>
#include "kernel.h"
#include "swis.h"

#include "nt_nvram.h"

#define TAG "SystemTime"

int nvram_gettime()
{
    int time[2];

    _swix(NVRAM_Read, _INR(0,2), TAG, time, sizeof time);

    return time[0];
}

void nvram_settime(int time)
{
    _swix(NVRAM_Write, _INR(0,2), TAG, time, sizeof time);
}

int read_os_var(char *varname, char *buff, int n)
{
  _kernel_swi_regs r;

  r.r[0] = (int)varname;
  r.r[1] = (int)buff;
  r.r[2] = (buff==NULL)?0x80000000:n;
  r.r[3] = 0;
  r.r[4] = 0;
  if(_kernel_swi(OS_ReadVarVal, &r, &r) != NULL) return(-1);
  if(buff) {
      *(buff + r.r[2]) = 0;
      return(r.r[2]);
  }
  return(-(r.r[2]));

}
