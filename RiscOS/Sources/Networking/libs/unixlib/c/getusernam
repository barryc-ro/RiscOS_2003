/* -*-C-*-
 *
 * $Header$
 * $Source$
 *
 * Copyright (c) 1995 Acorn Computers Ltd., Cambridge, England
 *
 * :RCS Log discontinued:
 * Revision 1.1  95/04/20  09:50:16  kwelton
 * Initial revision
 * 
 */
#include <stdio.h>

#include "kernel.h"
#include "swis.h"

#include "unixlib.h"
#include "stubs.h"

static const char usernamevar[] = "Inet$UserName";

/**********************************************************************/

char *getvarusername(void)
{
    int nread;
    _kernel_swi_regs r;
    _kernel_oserror *e;

    r.r[0] = (int)usernamevar;
    r.r[1] = (int)_varnamebuf;
    r.r[2] = (int)VARBUFSIZE;
    r.r[3] = 0;
    r.r[4] = 0;
    if( (e = _kernel_swi(XOS_Bit | OS_ReadVarVal, &r, &r)) != NULL )
	return(NULL);

    nread = r.r[2];
    _varnamebuf[nread] = '\0';
    return(nread ? _varnamebuf : NULL); 
}

/**********************************************************************/

/* EOF getusernam.c */
