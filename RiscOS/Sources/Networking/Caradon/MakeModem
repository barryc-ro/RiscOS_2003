# Project:   Caradon


# Toolflags:
# CCflags  = -c -depend !Depend -IC:, -throwback
CCflags  = -c -depend !Depend -IC:, -throwback -zM -DMODEM
C++flags = -c -depend !Depend -throwback -IC:
Pascalflags = -c -depend !Depend -throwback -IP:
# Linkflags = -aif -o $@
Linkflags = -m -o $@
ObjAsmflags = -depend !Depend -ThrowBack -Stamp -quit -CloseExec
CMHGflags =
LibFileflags = -c -o $@
Squeezeflags = -o $@
AAsmflags = -depend !Depend -quit -CloseExec -To $@ -From
Datatoaofflags = -d "" -l _len -dp -s -p

CP      = copy
CPFLAGS = ~cfr~v
COMPONENT   = Caradon
TARGET      = rm.Caradon

Files = o.module o.driver o.filegen o.headermod o.resourcefs o.screen \
        o.muldiv o.swiven o.backdrop o.connect o.onhook o.offhook o.ppp \
        o.enternnpc o.proceed o.proceedc
Libs  = C:o.Stubs C:o.inetlibzm

# Final targets:
rm.Caradon:  $(Files)  $(Libs)
        link $(linkflags) $(Files) $(Libs)
        modsqz $(TARGET)

o.resourcefs: @.ResModem.Apps.!Sennen.!RunImage
        genres ResModem -r -o $@

install_rom: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @echo ${COMPONENT}: rom module installed

install: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @echo ${COMPONENT}: module installed

# User-editable dependencies:

.SUFFIXES: .d

# Static dependencies:
.c.o:;        cc $(CCflags) $< -o $@
.s.o:;        objasm $(ObjAsmflags) -from $< -to $@
.cmhg.o:;     cmhg $(CMHGflags) $< -o $@ h.cmhg_modem
.d.o:;        datatoaof -f $< -o $@ $(Datatoaofflags)

# Dynamic dependencies:
o.module:	c.module
o.module:	h.cmhg_modem
o.module:	h.driver
o.module:	C:h.kernel
o.module:	h.screen
o.module:	h.defs
o.module:	C:h.kernel
o.module:	h.smartcard
o.module:	C:h.swis
o.module:	h.wimp
o.module:	h.defs
o.module:	Sockets.h.in
