# Makefile for OSLib Computer

# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date          Name         Description
# ----          ----         -----------
# 21st Jun 1995 JRC          Created.

LIBDIR = <Lib$Dir>.OSLib

#
# Generic options:
#
include StdTools

#
# Program specific options:
#
COMPONENT = OSLib

EXTRAHDRS = Hdr.NetFiler

LIBS = \
o.ADFS \
o.CD \
o.CDFS \
o.DeviceFS \
o.DOSFS \
o.Econet \
o.FileCore \
o.Filer \
o.FilerAction \
o.FileSwitch \
o.Free \
o.Freeway \
o.FSLock \
o.Joystick \
o.NetFS \
o.NetPrint \
o.NFS \
o.OSArgs \
o.OSFile \
o.OSFind \
o.OSFSControl \
o.OSGBPB \
o.OSSerialOp \
o.Parallel \
o.PipeFS \
o.RAMFS \
o.ResourceFS \
o.SCSI \
o.SCSIFS \
o.ShareFS \
o.Socket

HDRS     := ${patsubst o.%,Hdr.%,${LIBS}} ${EXTRAHDRS}
CHEADERS := ${patsubst Hdr.%,h.%,${HDRS}}
CSTRONG  := ${patsubst Hdr.%,Help.%,${HDRS}}

FILES    := ${HDRS} ${CHEADERS} ${CSTRONG} ${LIBS}

all: $(FILES)

release: ${FILES}
   ${CP} h       ${LIBDIR}.Computer.oslib.h    ${CPFLAGS}
   ${CP} Hdr     ${LIBDIR}.Computer.oslib.Hdr  ${CPFLAGS}
   Copy CStrong <StrongHelp$Dir>.HelpData ~CFLNR~V

#------------------------------------------------------------------------
hdrs: ${HDRS}
libs: ${LIBS}
cheaders: ${CHEADERS}
cstrong: ${CSTRONG}

.SUFFIXES: .o .h .h++ .def .ch .Hdr .ah .Help

.def.s:     ;DefMod -s -byte_wide ^.ByteWide < $< > $@
.def.h:     ;DefMod -h < $< > $@
.def.h++:   ;DefMod -h++ < $< > $@
.def.Hdr:   ;DefMod -hdr < $< > $@
.def.ch:    ;DefMod -chelp < $< > $@
.def.ah:    ;DefMod -asmhelp < $< > $@
.def.o:     ;DefMod -l -o l.$* -byte_wide ^.ByteWide < $<
            LibFile -c -o $@ -via ViaFile
            x LibFile -d ^.o.OSLib l.$*.*
            LibFile -i -o ^.o.OSLib -via ViaFile
            Wipe l.$* ~C~FR~V
.def.Help:  ;DefMod -cstrong -o CStrong.$* < $<
            Create $@

#------------------------------------------------------------------------
# RISC OS Build targets:
#
export: export_${PHASE}

export_hdrs:
        @echo ${COMPONENT}: export complete (hdrs)

export_libs: ${HDRS} ${CHEADERS} ${LIBS}
        ${CP} h       ${LIBDIR}.Computer.oslib.h    ${CPFLAGS}
        ${CP} Hdr     ${LIBDIR}.Computer.oslib.Hdr  ${CPFLAGS}
        @echo ${COMPONENT}: export complete (libs)

clean:
        @echo ${COMPONENT}: *** NOT cleaned *** clean locally if required

clean_lib:
        ${WIPE} o.* ${WFLAGS}
        @echo ${COMPONENT}: cleaned

# End of RISC OS Build targets
#------------------------------------------------------------------------
# Dynamic dependencies:
