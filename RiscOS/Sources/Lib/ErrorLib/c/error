/************************************************************************/
/* File:    Error.c                                                     */
/* Purpose: Various error handling functions to do with checking        */
/*          validaty of SWI calls.                                      */
/* Author:  Neil Bingham (mailto:NBingham@acorn.co.uk)                  */
/* History: Tue 12th November 1996 ver 0.01 - Created.                  */
/*          Tue 18th February 1997 ver 0.02 - Updated to use StrongHelp */
/*                                            docs Generator            */
/************************************************************************/


/* -------------------------------------- LIBRARY IMPORTS --------------------------------------- */
#include "errors.h"

/* ---------------------------------- PRE-PROCESSOR DIRECTIVES ---------------------------------- */


/* -------------------------------------- GLOBAL VARIABLES -------------------------------------- */


/* ----------------------------------------- FUNCTIONS ------------------------------------------ */

/************************************************************************/
/* wimp_error                                                           */
/*                                                                      */
/* Function produces a standard wimp message box for the program.       */
/*                                                                      */
/* Parameters: er - Pointer to error block containing error number and  */
/*                  error message to be displayed                       */
/*                                                                      */
/* Returns:    void.                                                    */
/*                                                                      */
/************************************************************************/
void wimp_error(_kernel_oserror *er)
{
/*   _kernel_oserror	*is_error; */
/*   _kernel_swi_regs	regs; */


  wimp_report_error(er, 0, "Toolbox Error",0,0,0);
  
  /* Setup registers */
/*  regs.r[0] = (int) &er;
  regs.r[1] = 2;
  regs.r[2] = (int) "Toolbox App Error";

  is_error = _kernel_swi(Wimp_ReportError, &regs, &regs); */

}


/************************************************************************/
/* error_check                                                          */
/*                                                                      */
/* Function checks that SWI calls do not return errors, otherwise it    */
/* displays an error box.                                               */
/*                                                                      */
/* Parameters: er - Pointer to error block to be checked that it is     */
/*                  NULL.                                               */
/*                                                                      */
/* Returns:    void.                                                    */
/*                                                                      */
/************************************************************************/
void error_check(_kernel_oserror *er)
{
  /* If an error has occurred */
  if (er != NULL)
  {
    /* Report the error */
    wimp_error(er);
  }
}


/************************************************************************/
/* error_check_exit                                                     */
/*                                                                      */
/* Function checks that SWI calls do not return errors, otherwise it    */
/* quits the program in a rather direct way.                            */
/*                                                                      */
/* Parameters: er - Pointer to error block to be checked that it is     */
/*                  NULL.                                               */
/*                                                                      */
/* Returns:    void.                                                    */
/*                                                                      */
/************************************************************************/
void error_check_exit(_kernel_oserror *er)
{
  /* If an error has occurred */
  if (er != NULL)
  {
    /* Report the error */
    wimp_error(er);

    /* Quit the program */
    exit(0);
  }
}
