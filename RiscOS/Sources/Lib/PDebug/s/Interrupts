	AREA	|C$$code|, CODE, READONLY
	
	GET C:Desk.sh.FnNames
	
	
	
	Desk_ASMacros_EXTERNALFUNCTION	PDebug__EnableInterrupts
	
	AND	a1, pc, #1<<27	; Returns current irq flag.
	BIC	a2, lr, #1<<27	; a2 = lr with IRQs enabled
	AND	a3, pc, #3
	CMP	a3, #0
	SWIEQ	0x16	; OS_EnterOS if in USR mode, so we can clear the irq flag. This may corrupt SVC_r14?
	MOVS	pc, a2	; Clear IRQ flag and return to original mode.
	
	
	Desk_ASMacros_EXTERNALFUNCTION	PDebug__DisableInterrupts
	
	AND	a1, pc, #1<<27	; Returns current irq flag.
	ORR	a2, lr, #1<<27	; a2 = lr with IRQs disabled
	AND	a3, pc, #3
	CMP	a3, #0
	SWIEQ	0x16	; OS_EnterOS if in USR mode, so we can set the irq flag. This may corrupts SVC_r14?
	MOVS	pc, a2	; Set IRQ flag and return to original mode.
	
	
	END
