#if !defined(__header_h)              /* Sentry, use file only if it's not already included. */
#define __header_h
/*	Project Post (769)
	Acorn Risc Technologies
	Copyright © 1997. All Rights Reserved.

	FILE:		header.h
	AUTHOR:		Richard D. Warren
	VERSION:	0.07D for RISC OS

	OVERVIEW
	========
	Class definition for a header object.
	header is a generic object for any email header.  It provides methods
	that apply to any RFC email header.  Specific email headers inherit
	from this class adding specific methods or overriding methods in this
	class

	HISTORY
	=======
	30/08/97	0.01	RDW	initial version
	09/09/97	0.02	RDW	SetName added and default constructor added
	10/09/97	0.03	RDW	SetBody added and WriteOut methods added
	12/09/97	0.04	RDW	Merged file and memory constructors into one
	19/09/97	0.05	RDW	Added to the NFE_HDR_TYPE enum support for
					all the XNetFax headers and X-Organization
	19/02/98	0.06	RDW	#include DebugLib path added
	20/02/98	0.07	RDW	added support for XNFreturnreceiptto
					NFE_HDR_X_NF_RETURN_RECEIPT_TO added to
					enum
	12/05/98	0.07D	RDW	virtual copy constructor, clone(), added
*/


/* ************************************************************************** */
/*                                                                            */
/* Include header files - System                                              */
/*                                                                            */
/* ************************************************************************** */
extern "C"
{
  #include <time.h>
  #include "DebugLib/DebugLib.h"
}


/* ************************************************************************** */
/*                                                                            */
/* Include header files - Project defined                                     */
/*                                                                            */
/* ************************************************************************** */
#include "elibbase.h"
extern "C"
{
  #include "ELib.h"
}


/* ************************************************************************** */
/*                                                                            */
/* New enumerated types                                                       */
/*                                                                            */
/* ************************************************************************** */
typedef enum
{
  NFE_HDR_UNKNOWN,
  NFE_HDR_DATE,
  NFE_HDR_RESENT_DATE,
  NFE_HDR_SUBJECT,
  NFE_HDR_FROM,
  NFE_HDR_TO,
  NFE_HDR_REPLY_TO,
  NFE_HDR_MESSAGE_ID,
  NFE_HDR_MIME_VERSION,
  NFE_HDR_CONTENT_TRANSFER_ENCODING,
  NFE_HDR_CONTENT_TYPE,
  NFE_HDR_X_NF_FAX_PAGES,
  NFE_HDR_X_NF_SERIAL,
  NFE_HDR_X_NF_SOFTWARE_REV,
  NFE_HDR_X_NF_MESSAGE_CLASS,
  NFE_HDR_X_ORGANIZATION,
  NFE_HDR_X_NF_FAX_NUMBER,
  NFE_HDR_X_NF_PHONE_NUMBER,
  NFE_HDR_X_NF_DEVICE,
  NFE_HDR_X_NF_DEVICE_CLASS,
  NFE_HDR_X_NF_RETURN_RECEIPT_TO
} NFE_HDR_TYPE;									// The types of headers supported specifically by other classes


/* ************************************************************************** */
/*                                                                            */
/* Class definition                                                           */
/*                                                                            */
/* ************************************************************************** */
class header : public elibbase
{
  // Declaration of PUBLIC member functions
  public:
    // Default Constructor - is memory version
    header(void);
    
    // Constructor
    header(BOOL f,								// file (TRUE) or memory(FALSE)?
           char   *membase,							// set to start of memory block that  header is in
           uint32  offset,							// number of characters from membase to start of  header
           uint32  length,							// length of  header in characters from it's start
           NFE_HDR_TYPE t = NFE_HDR_UNKNOWN,					// type of the header if known
           BOOL    owner = FALSE);						// does the object 'own' this memory block? (TRUE = destroy membase on destruction)
    header(const header &object);						// copy constructor
    virtual elibbase* clone(void) const { return new header(*this); }		// Virtual Copy constructor
    
    header & operator=(const header &object);					// assignment operator
    
    virtual ~header(void);							// Destructor

    NFE_rcode GetNameLen(uint32 &len) const;					// return length of header field name
    NFE_rcode GetBodyLen(uint32 &len) const;					// return length of header field real body
    NFE_rcode GetName(char *n, uint32 &len) const;				// return copy of header field name 
    NFE_rcode GetRealBody(char *n, uint32 &len) const;				// return copy of header field body contents AS IS (ie. includes any folding, etc.)
    virtual NFE_rcode GetUnfoldedBody(char *n, uint32 &len) const;		// return copy of header field body contents unfolded
    virtual NFE_rcode GetUnfoldedNoCommentsBody(char *n, uint32 &len) const;	// return copy of header field body contents unfolded and comments removed
    virtual void Display(void);							// for debug/development work.  Can go in final version
    NFE_rcode parse(NFE_CONTEXT &context, clock_t t_slice);			// parse the data from file or memory, called by ParseData method
    NFE_HDR_TYPE GetType(void) const {return type;};				// get the header's current NFE_HDR_TYPE setting
    NFE_HDR_TYPE GetNameType(void);						// process the header's field name string and return the NFE_HDR_TYPE for it.  Does not set the type
    										// in the object though.  The correct object for the type should be created (eg. date) and that object
    										// assigned with the properties from this header.  It will have it's type set correctly and the original
    										// header object can be destroyed
    										
    NFE_rcode SetName(char *n);							// Set the name of this header object
    NFE_rcode SetBody(char *n);							// Set the body of this header object

    virtual NFE_rcode WriteOut(NFE_CONTEXT &context, clock_t t_slice, FILE *file);		// function to write out the object to file
    virtual NFE_rcode WriteOut(NFE_CONTEXT &context, clock_t t_slice, char *mem, uint32 &l);	// function to write out the object to memory
    
  // Declaration of PRIVATE member functions
  private:
    void copyheaderobject(const header &object);				// method to copy object.  Used by copy constructor and assignment operator
    NFE_rcode param_check_Get(char *n, uint32 &len) const;			// check paramters of a "Get" method and object is in a state to do the method
    
    
  // Declaration of PUBLIC data members
  public:

  // Declaration of PROTECTED data members
  protected:
    uint32 fieldname_start;							// start offset in characters to the start of the header field name from the start of the header (start)
    uint32 fieldname_len;							// length in characters of the field name from the start of the field name (fieldname_start)
    uint32 fieldbody_start;							// start offset in characters to the start of the field body from the start of the header (start)
    uint32 fieldbody_len;							// length in characters of the field body from the start of the body (fieldbody_start)
    NFE_HDR_TYPE type;								// type of header
    char *fieldname;								// fieldname used when creating a header, not parsing it
    char *fieldbody;								// fieldbody used when creating a header, not parsing it

  // Declaration of PRIVATE data members
  private:
};

#endif  /* end of sentry #ifdef */

