#define GLOBAL
#include "config.h"
#include "glob.h"
#include <stdlib.h>
#include <stdio.h>
#include "tmndec.h"

#define INFILE "out"
#define OUTFILE "out2%d"
#define NUMFRAME 75

int main(argc,argv)
int argc;
char *argv[];
{
  int cc, size,leng,leng2;
  FILE *inf;

  outtype=T_TGA;

  horizontal_size = MBC*16;
  vertical_size = MBR*16;
  mb_width = horizontal_size/16;
  mb_height = vertical_size/16;
  coded_picture_width = 16*mb_width;
  coded_picture_height = 16*mb_height;
  chrom_width =  coded_picture_width>>1;
  chrom_height = coded_picture_height>>1;
  for (cc=0; cc<3; cc++) {
  if (cc==0)
    size = coded_picture_width*coded_picture_height;
  else
    size = chrom_width*chrom_height;

  if (!(refframe[cc] = (unsigned char *)calloc(size,sizeof(unsigned char))))
    error("calloc failed\n");

  }
  if (!(inf=fopen(INFILE,"rb")))
    error("could not open input file\n");
  outputname=OUTFILE;
  leng=horizontal_size*vertical_size;
  for (cc=0;cc<NUMFRAME;cc++)
  {

   leng2 = fread(refframe[0],sizeof(char),(size_t)leng,inf);
   if (leng2 !=leng)
     error("read error \n");
   storeframe(refframe,cc);

  }


}

void error(text)
char *text;
{
  fprintf(stderr,text);
  exit(1);
}
