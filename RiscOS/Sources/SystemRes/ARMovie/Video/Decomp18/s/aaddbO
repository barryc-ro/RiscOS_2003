        GET     Hdr:ListOpts
        GET     Hdr:Macros
        GET     Hdr:APCS.<APCS>

	AREA |test$$code|,CODE,READONLY

	EXPORT ab_cp
	EXPORT ab_ad
ab_cp
;bp	rfp	incr
;r0	r1	r2

        FunctionEntry "r4-r9"
	MOV r9,#8
	MOV r12,#255
ab_cp_loop;using 4,5,6,7,8,9,12,
 LDMIA r0 !,{r4,r5,r6,r7}

 MOVS r3,r4,ASR #8
 EORNE r4,r12,r3,LSR #24
 MOVS r3,r5,ASR #8
 EORNE r5,r12,r3,LSR #24
 MOVS r3,r6,ASR #8
 EORNE r6,r12,r3,LSR #24
 MOVS r3,r7,ASR #8
 EORNE r7,r12,r3,LSR #24
 ORR r8,r4,r5,LSL #8
 ORR r8,r8,r6,LSL #16
 ORR r8,r8,r7,LSL #24

 LDMIA r0 !,{r4,r5,r6,r7}


 MOVS r3,r4,ASR #8
 EORNE r4,r12,r3,LSR #24
 MOVS r3,r5,ASR #8
 EORNE r5,r12,r3,LSR #24
 MOVS r3,r6,ASR #8
 EORNE r6,r12,r3,LSR #24
 MOVS r3,r7,ASR #8
 EORNE r7,r12,r3,LSR #24
 ORR r3,r4,r5,LSL #8
 ORR r3,r3,r6,LSL #16
 ORR r3,r3,r7,LSL #24
 STMIA r1,{r8,r3}

	ADD R1,R1,R2
	SUBS R9,R9,#1
	BNE  ab_cp_loop
	Return "r4-r9"

ab_ad
;r0  r1   r2
;bp  rfp  incr

        FunctionEntry "r4-r9"
	MOV R8,#8
	MOV r12,#255
ab_ad_loop

 LDMIA r0 !,{r4,r5,r6,r7}   ;using: 2,3,4,5,6,7,9,12,
 LDMIA r1,{r14,r3}
 AND r9,r12,r14
 ADD r4,r4,r9
 AND r9,r12,r14,LSR #8
 ADD r5,r5,r9
 AND r9,r12,r14,LSR #16
 ADD r6,r6,r9
 ADD r7,r7,r14,LSR #24
 MOVS r3,r4,ASR #8
 EORNE r4,r12,r3,LSR #24
 MOVS r3,r5,ASR #8
 EORNE r5,r12,r3,LSR #24
 MOVS r3,r6,ASR #8
 EORNE r6,r12,r3,LSR #24
 MOVS r3,r7,ASR #8
 EORNE r7,r12,r3,LSR #24
 ORR r14,r4,r5,LSL #8
 ORR r14,r14,r5,LSL #16
 ORR r14,r14,r5,LSL #24

 LDMIA r0 !,{r4,r5,r6,r7}
 AND r9,r12,r3
 ADD r4,r4,r9
 AND r9,r12,r3,LSR #8
 ADD r5,r5,r9
 AND r9,r12,r3,LSR #16
 ADD r6,r6,r9
 ADD r7,r7,r3,LSR #24
 MOVS r3,r4,ASR #8
 EORNE r4,r12,r3,LSR #24
 MOVS r3,r5,ASR #8
 EORNE r5,r12,r3,LSR #24
 MOVS r3,r6,ASR #8
 EORNE r6,r12,r3,LSR #24
 MOVS r3,r7,ASR #8
 EORNE r7,r12,r3,LSR #24
 ORR r3,r4,r5,LSL #8
 ORR r3,r3,r5,LSL #16
 ORR r3,r3,r5,LSL #24
 STMIA r1,{r14,r3}



	ADD R1,R1,R2

	SUBS R8,R8,#1
	BNE  ab_ad_loop
	Return "r4-r9"

	END
