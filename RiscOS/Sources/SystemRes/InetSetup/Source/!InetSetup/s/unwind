	AREA	|ObjAsm$$Code|,CODE,READONLY

	EXPORT	do_unwind
	IMPORT	_kernel_unwind
do_unwind
	MOV	ip,sp
	STMDB	sp!,{v1,v2,fp,ip,lr,pc}
	SUB	fp,ip,#4
	MOV	v1,a1
	MOV	v2,a2
	STR	fp,[a1,#24]
	STR	sl,[a1,#36]
	STR	pc,[a1,#32]
	BL	_kernel_unwind
	CMPS	a1,#0
	LDMLEDB fp,{v1,v2,fp,sp,pc}^
	MOV	a1,v1
	MOV	a2,v2
	BL	_kernel_unwind
	CMPS	a1,#0
	LDMLEDB fp,{v1,v2,fp,sp,pc}^
	MOV	a1,v1
	MOV	a2,v2
	BL	_kernel_unwind
	;CMPS	a1,#0
	;LDMLEDB fp,{v1,v2,fp,sp,pc}^
	;MOV	a1,v1
	;MOV	a2,v2
	;BL	_kernel_unwind
	LDMDB	fp,{v1,v2,fp,sp,pc}^

	END
