<HTML>
<HEAD>
<META NAME="ncbrowsermode" CONTENT="SELECTED=movieOptions; NOSCROLL">
<TITLE>êêHTMLCtrl_Titleëë</TITLE>
<SCRIPT LANGUAGE="JavaScript1.1">

var mediaObject = new MediaCtrl();
var error = null;
var ResponseCallback = null;
var ScrollCallback = null;
var current_speed = 0;
var visible = false;
var loaded = false;
var image_count = 0;

// cache replaceable images.
var myImages = new Array(35);
for (i=0; i < 35; i++)
{
        myImages[i] = new Image();
        myImages[i].src = "../images/vod/"+i+".gif"
        myImages[i].onload = imageLoader();
}

// array of speeds
var speeds = new Array(9);

speeds[0] = new Object();
speeds[0].speed = "-3";
speeds[0].times = "now-beginning";

speeds[1] = new Object();
speeds[1].speed = "-2";
speeds[1].times = "now-beginning";

speeds[2] = new Object();
speeds[2].speed = "-1";
speeds[2].times = "now-beginning";

speeds[3] = new Object();
speeds[3].speed = "-0.5";
speeds[3].times = "now-beginning";

speeds[4] = new Object();
speeds[4].speed = "0";
speeds[4].times = "now-";

speeds[5] = new Object();
speeds[5].speed = "0.5";
speeds[5].times = "now-";

speeds[6] = new Object();
speeds[6].speed = "1";
speeds[6].times = "now-";

speeds[7] = new Object();
speeds[7].speed = "2";
speeds[7].times = "now-";

speeds[8] = new Object();
speeds[8].speed = "3";
speeds[8].times = "now-";

// this function uses the error object and based on what it is acts appropriately.
// in this case it just 'alerts' it.
function errorHandler()
{
        if (error != null)
        {
          alert("ERROR:("+error.identifier+") "+error.description);
          error = null;
        }
}

// this ensures all of the images are loaded before the display is shown
function imageLoader()
{
        image_count++;

        if (image_count >= 35)
        {
                loaded = true;
                ScrollCallBack = setTimeout("window.scroll(0,132); loaded = true; visable = true;", 10000);
        }
}

// set the default behaviour of the media objects
function setMediaObjects()
{
        //error = mediaObject.setOption("change screen mode", false);
        //if (error == null) error = mediaObject.setOption("clear screen after", false);
        if (error == null) error = mediaObject.setOption("clear screen before", false);
        //if (error == null) error = mediaObject.setOption("set palette", true);

        if (error != null)
        {
                errorHandler();
        }
}

// this function loads the current movie selected within the select form
function loadMovie()
{
        var option = document.movieOptions.elements[0].selectedIndex;
        var movie  = document.movieOptions.elements[0].options[option].text;

        if ((error = mediaObject.load("rtsp://neptune.eng.cam.pace.co.uk/asset/mds%3a/mds/video/"+movie+".mpi")) != null)
        {
                errorHandler();
        }
        else
        {
                getResponse();
        }
}

function unLoadMovie()
{
        if ((error = mediaObject.unload()) != null)
        {
                errorHandler();
        }
}

function playMovieBy(change)
{
        var proposed_speed = current_speed + change;

        if ((proposed_speed > 0) && (proposed_speed < 9))
        {
                playMovieAt(proposed_speed);
        }
}

function playMovieAt(array_offset)
{
        current_speed = array_offset;

        playMovie(speeds[array_offset].times, speeds[array_offset].speed);

        // the dial is 1-9 the background image is zero
        document.DIAL.src = myImages[array_offset+1].src;
}

function playMovie(times, speed)
{
        if ((error = mediaObject.play(times, speed)) != null)
        {
                errorHandler();
        }

        getResponse();
}

function getResponse()
{
        var response_received = false;
        var response_code = 0;
        var count = 0;

        error = null;

        error = mediaObject.getResponse(response_received, response_code);

        if (error != null)
        {
                errorHandler();
        }
        else
        {
                if (response_received == true)
                {
                        if (response_code != 200)
                        {
                                error = new Object();
                                error.identifier = -1;
                                error.description = "bad response from server "+response_code;

                                errorHandler();
                        }
                }
                else
                {
                        ResponseCallback = setTimeout("getResponse()", 100);
                }
        }
}

function key_handler(e)
{
        if ((loaded == true)&&(e.which < 0))
        {
                switch (e.which)
                {
                        case 0x80000082://info
                                if (visible == true)
                                {
                                        window.scroll(0,132);
                                        visible = false;
                                }
                                else
                                {
                                        window.scroll(0,-132);
                                        visible = true;
                                }
                                return false;

                        case 0x8000009e:// channel down (page down)
                                playMovieBy(-1);
                                return false;
                        case 0x8000009f:// channel up
                                playMovieBy(1);
                                return false;
                        case 0x80000086:// pause
                                javascript:playMovieAt(4);
                                return false;
                        case 0x80000089:// play
                                javascript:playMovieAt(6);
                                return false;
                        case 0x800000CA:// FF
                                javascript:playMovieAt(8);
                                return false;
                        case 0x80000088:// RW
                                javascript:playMovieAt(0);
                                return false;
                        case 0x80000085:// step back
                                javascript:playMovieAt(3);
                                return false;
                        case 0x80000087:// step forward
                                javascript:playMovieAt(5);
                                return false;
                        case 0x800000CB:// stop,
                                javascript:unLoadMovie();
                                return false;
                        default:
                                return true;
                }
        }

        return true;
}
</SCRIPT>
</HEAD>

<BODY onKeypress="javascript:return key_handler(event)" background="../images/vod/0.gif" bgcolor="transparent" onload="javascript:setMediaObjects()">
<DIV ALIGN="right">
<TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0">
<!-- spacing from the top of the page -->
<TR><TD COLSPAN=5 HEIGHT="146"></TD></TR>

<!-- select, eject, arrows, pause and right spacing -->
<TR>
   <TD ROWSPAN=5 WIDTH=104 VALIGN="TOP" ALIGN="Right">
   <FONT SIZE=-1>
   <FORM NAME="movieOptions" METHOD="GET" ACTION="javascript:loadMovie()"><SELECT  ID="CHANNELS" size="6" onChange="javascript:loadMovie()">
        <OPTiON>cortina
        <OPTION>bondclip
        <OPTION>dumbo1
        <OPTION>bondcom
        <OPTION>elvis-5mb
        <OPTION>shopfit
        <OPTION>shophits
        <OPTION>shopmat
   </SELECT>
   </FORM>
   </FONT>
   </TD>

   <TD ROWSPAN="5" WIDTH=40 VALIGN=TOP ALIGN=CENTER><FORM NAME="EJECT" METHOD="GET" ACTION="javascript:unLoadMovie()">
   <INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/11.gif" BORDERIMAGE="../images/vod/10.gif"></FORM></TD>

   <TD><FORM name="ARROW_LEFT" METHOD="GET" ACTION="javascript:playMovieBy(-1)">
   <INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/21.gif" BORDERIMAGE="../images/vod/20.gif" HEIGHT="20" WIDTH="34"></FORM></TD>

   <TD><FORM NAME="PAUSE" METHOD="GET" ACTION="javascript:playMovieBy(4)">
   <INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/23.gif" BORDERIMAGE="../images/vod/22.gif" HEIGHT="20" WIDTH="61"></FORM></TD>

   <TD><FORM NAME="ARROW_RIGHT" METHOD="GET" ACTION="javascript:playMovieBy(+1)">
   <INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/25.gif" BORDERIMAGE="../images/vod/24.gif" HEIGHT="20" WIDTH="34"></FORM></TD>
   <TD ROWSPAN="5">&nbsp; &nbsp;</TD>
</TR>

<!-- half speeds and the shuttle -->
<TR>
<TD><FORM name="RW_HALF" METHOD="GET" ACTION="javascript:playMovieAt(3)"><!-- use the array index -->
<INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/19.gif" BORDERIMAGE="../images/vod/18.gif" HEIGHT="20" WIDTH="34"></FORM></TD>

<TD ROWSPAN=3><img name="DIAL" src="../images/vod/5.gif" HEIGHT="60" WIDTH="61"></TD>

<TD><FORM name="FF_HALF" METHOD="GET" ACTION="javascript:playMovieAt(5)">
<INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/27.gif" BORDERIMAGE="../images/vod/26.gif" HEIGHT="20" WIDTH="34"></FORM></TD>
</TR>

<TR>
<TD><FORM name="RW_1" METHOD="GET" ACTION="javascript:playMovieAt(2)">
<INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/17.gif" BORDERIMAGE="../images/vod/16.gif" HEIGHT="20" WIDTH="34" ></FORM></TD>
<TD><FORM name="FF_1" METHOD="GET" ACTION="javascript:playMovieAt(6)">
<INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/29.gif" BORDERIMAGE="../images/vod/28.gif" HEIGHT="20" WIDTH="34"></FORM></TD>
</TR>

<TR>
<TD><FORM NAME="RW_2" METHOD="GET" ACTION="javascript:playMovieAt(1)">
<INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/15.gif" BORDERIMAGE="../images/vod/14.gif" HEIGHT="20" WIDTH="34"></FORM></TD>
<TD><FORM name="FF_2" METHOD="GET" ACTION="javascript:playMovieAt(7)">
<INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/31.gif" BORDERIMAGE="../images/vod/30.gif" HEIGHT="20" WIDTH="34"></FORM></TD>
</TR>

<TR>
<TD><FORM NAME="RW_3" METHOD="GET" ACTION="javascript:playMovieAt(0)">
<INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/13.gif" BORDERIMAGE="../images/vod/12.gif" HEIGHT="20" WIDTH="34"></FORM></TD>
<TD><img src="../images/vod/34.gif" Height="20" Width="60"></TD>
<TD><FORM NAME="FF_3" METHOD="GET" ACTION="javascript:playMovieAt(8)">
<INPUT TYPE=SUBMIT VALUE="" SELIMAGE="../images/vod/33.gif" BORDERIMAGE="../images/vod/32.gif" HEIGHT="20" WIDTH="34"></FORM></TD>
</TR>

</TABLE>
</DIV>
</BODY>
</HTML>
