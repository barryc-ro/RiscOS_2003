| >!STBBoot.Utilities.PreDesktop
| Copyright © Pace Micro Technology plc, 2000
| All rights reserved.

| Load the BootCommands module if not there already
RMEnsure BootCommands 1.20 RMLoad System:Modules.BootCmds

| Set sys vars for uniqie ID, RAM size and location of public directory
Set NFS$CreateAccess 0777
Run STBResources:!Internet.bin.IPVars
Run STBUtilities:Unique

| Load the splash screen stuff if it is configured to be on (display screen if network booting)
| NOTE: the SplashText string MUST use hard spaces (Alt-Space) as 'Do' screws things up nicely with
| quotes or soft spaces.
|If SplashScreen Then RMEnsure STBSplash 1.15 RMLoad System:Modules.STBSplash
If SplashScreen Then Obey STBChoices:Splash
If "<NetRoot$Dir>" = "<STBRoot$Dir>" Then SplashImage <Splash$Picture>
If "<NetRoot$Dir>" = "<STBRoot$Dir>" Then Do SplashText ««PreDesk_Vsn»»<Baseline$Version>

| Ensure that CacheFS is loaded because NCFresco uses it, and <Choices$Write> may also
If "<CacheFS$Size>" <> "" Then Do CacheFS_SetMax <CacheFS$Size>
If "<Wimp$ScrapDir>" = "" Then Set Wimp$ScrapDir Cache:$.ScrapDir
If "<Wimp$Scrap>" = ""    Then Set Wimp$Scrap    <Wimp$ScrapDir>.ScrapFile

| Load a clear iconsprite to stop the mouse pointer from appearing
IconSprites STBUtilities:ClearPtr

| Execute all the global PreDesktop scripts
If BootRun$PreDesk Then BootPreRun <STBPreDesk$Dir>

| Execute all the STB-specific PreDesktop scripts
If BootRun$HookPreDesk Then BootPreRun <STBHookPreDesk$Dir>
