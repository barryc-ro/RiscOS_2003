| >!STBBoot.Utilities.Desktop
| © Pace Micro Technology plc, 1999

| Tidy-up the screen after the mode change into the Desktop
Pointer 0
If OS$Version = 220 AND "<TV$Type>" = "PAL"  Then WimpMode X768 Y576 C32k
If OS$Version = 220 AND "<TV$Type>" = "NTSC" Then WimpMode X640 Y480 C32k
SplashText ""

| Boot applications in Resources:$.Apps
|If BootBoot$ResFSApps AND (OS$Version = 300) Then RMReInit ShrinkWrap
|If BootBoot$ResFSApps AND (OS$Version = 300) Then ShrinkWrapAddZone Resources:$.Apps
|If BootBoot$ResFSApps Then Repeat Filer_Boot <STBResFSApps$Dir> -applications -tasks -verbose
Set Alias$Filer_Boot IfThere %*0.!Boot Then Run %*0.!Boot

| Boot anything in the !STBBoot.Resources directory
If Boot$Verbose Then Error "««Desktop_GblRes»»"
If BootBoot$Resources Then Repeat Filer_Boot <STBResources$Dir> -applications -tasks

| Boot anything in the STB-specific Resources directory
If Boot$Verbose  Then Error "««Desktop_HookRes»»"
If BootBoot$Apps Then Repeat Filer_Boot <STBHookRes$Dir> -applications -tasks

| Boot anything in the non-Pace applications/resources directory
If Boot$Verbose  Then Error "««Desktop_BootApps»»"
If BootBoot$Apps Then Repeat Filer_Boot <STBApps$Dir> -applications -tasks

| Run global Desktop scripts
If Boot$Verbose    Then Error "««Desktop_GblDesk»»"
If BootRun$Desktop Then Repeat Obey <STBDesktop$Dir> -files -applications -tasks
|If BootRun$Desktop Then Repeat Filer_Run <STBDesktop$Dir> -files -applications -tasks

| Run STB-specific Desktop scripts
If Boot$Verbose     Then Error "««Desktop_HookDesk»»"
If BootRun$HookDesk Then Repeat Obey <STBHookDesk$Dir> -files -applications -tasks
|If BootRun$HookDesk Then Repeat Filer_Run <STBHookDesk$Dir> -files -applications -tasks

| Run everything in the non-Pace applications/resources directory
If Boot$Verbose Then Error "««Desktop_RunApps»»"
If BootRun$Apps Then Repeat Run <STBApps$Dir> -files -applications -tasks
|If BootRun$Apps Then Repeat Filer_Run <STBApps$Dir> -files -applications -tasks

| Tidy-up screen, keyboard, memory, etc...
Modify -with Run$Path -add "" -replacing "STBUtilities:,"
SplashReset
STBState_Reboot 0
Hoff
Run STBUtilities:LiveErrors
Run STBLibrary:ResetPtr
Run STBRoot:Useful
Fx 15 0
Fx 247 1
Fx 229 0
