SplashText "««NCFresco_Splash»»"

| Set the defaults for the browser
Set Browser$Default "!NCFresco"
If "<Inet$LocalDomain>"    = ""    Then Set Inet$LocalDomain    eng.cam.pace.co.uk
If "<NCFresco$Help>"       = ""    Then Set NCFresco$Help       file:/STBContent:HTML/Help/index.html
If "<NCFresco$EventURL00>" = ""    Then Set NCFresco$EventURL00 file:/STBContent:HTML/NCFresco/Options
If "<NCFresco$EventURL01>" = ""    Then Set NCFresco$EventURL01 <NCFresco$Help>
If "<TV$Type>"             = "PAL" Then Set NCFresco$ConfigDisplayMarginLeft   8 Else Set NCFresco$ConfigDisplayMarginLeft   5
If "<TV$Type>"             = "PAL" Then Set NCFresco$ConfigDisplayMarginBottom 6 Else Set NCFresco$ConfigDisplayMarginBottom 6
If "<TV$Type>"             = "PAL" Then Set NCFresco$ConfigDisplayMarginRight  8 Else Set NCFresco$ConfigDisplayMarginRight  5
If "<TV$Type>"             = "PAL" Then Set NCFresco$ConfigDisplayMarginTop    6 Else Set NCFresco$ConfigDisplayMarginTop    6

| Default to the supplied home pages if none specified
If OS$Version = 300 AND "<NCFresco$Welcome>" = "" Then Set NCFresco$Welcome STBContent:HTML.300.index/html
If OS$Version = 300 AND "<NCFresco$Home>"    = "" Then Set NCFresco$Home    STBContent:HTML.300.index/html
If OS$Version = 400 AND "<NCFresco$Welcome>" = "" Then Set NCFresco$Welcome STBContent:HTML.400.index/html
If OS$Version = 400 AND "<NCFresco$Home>"    = "" Then Set NCFresco$Home    STBContent:HTML.400.index/html

| Ensure that the !Unicode application in our !STBBoot.Resources directory has been seen
IfThere STBResources:!Unicode Then Run STBResources:!Unicode

| Run the configuration script for NCFresco
Obey STBChoices:NCFresco

| Set the icon highlight colour to light red/pink
IconHigh_SetHighlightColour 0x6B6BFD00

| Ensure that the Resolver module is configured given the Inet$ system variables
ResolverConfig

| Set the options toolbar button to go to the main options page and the help button goes to the main help page
Set OptScr$Path STBContent:HTML.Options.
If "<NCFresco$EventURL00>" = "" Then Set NCFresco$EventURL00 NCOptions_OpenPage:?file_template=OptScr:Options&quit_page=ncint:current
If "<NCFresco$EventURL01>" = "" Then Set NCFresco$EventURL01 <NCFresco$Help>

| Check for- and load various modules which NCFresco requires
If "<NCFresco$SSL>" = "Export" Then IfThere System:Modules.Network.HTTPsxMod Then RMLoad System:Modules.Network.HTTPsxMod
If "<NCFresco$SSL>" = "Strong" Then IfThere System:Modules.Network.HTTPsMod  Then RMLoad System:Modules.Network.HTTPsMod
RMEnsure Window    1.61 RMLoad System:Modules.Toolbox.Window
RMEnsure Window    1.61 Error "««NCFresco_Window»»"
RMEnsure HTTP      1.09 RMLoad System:Modules.Network.HTTPMod
RMEnsure HTTP      1.09 Error "««NCFresco_HTTP»»"
RMEnsure WebGopher 0.11 RMLoad System:Modules.Network.WebGopher
RMEnsure WebGopher 0.11 Error "««NCFresco_Gopher»»"
RMEnsure WebFTP    0.25 RMLoad System:Modules.Network.WebFTP
RMEnsure WebFTP    0.25 Error "««NCFresco_FTP»»"

| Start the application
Run Resources:$.Apps.!Watchdog
