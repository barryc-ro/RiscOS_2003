SplashText "««NCFresco_Splash»»"

| Set the defaults for the browser
Set Browser$Default "!NCFresco"
If "<Inet$LocalDomain>"    = ""    Then Set Inet$LocalDomain eng.cam.pace.co.uk
If "<NCFresco$Welcome>"    = ""    Then Set NCFresco$Welcome STBContent:HTML.index/html
If "<NCFresco$Home>"       = ""    Then Set NCFresco$Home STBContent:HTML.index/html
If "<NCFresco$Help>"       = ""    Then Set NCFresco$Help file:/STBContent:HTML/Help/home.html
If "<NCFresco$EventURL00>" = ""    Then Set NCFresco$EventURL00 file:/STBContent:HTML/NCFresco/Options
If "<NCFresco$EventURL01>" = ""    Then Set NCFresco$EventURL01 <NCFresco$Help>
If "<TV$Type>"             = "PAL" Then Set NCFresco$ConfigDisplayMarginLeft   8 Else Set NCFresco$ConfigDisplayMarginLeft   5
If "<TV$Type>"             = "PAL" Then Set NCFresco$ConfigDisplayMarginBottom 6 Else Set NCFresco$ConfigDisplayMarginBottom 6
If "<TV$Type>"             = "PAL" Then Set NCFresco$ConfigDisplayMarginRight  8 Else Set NCFresco$ConfigDisplayMarginRight  5
If "<TV$Type>"             = "PAL" Then Set NCFresco$ConfigDisplayMarginTop    6 Else Set NCFresco$ConfigDisplayMarginTop    6

| -- OBSOLETE --
|SetMacro Alias$URLOpen_MPEGA      /MPEGPlay:PlayMPEG    %%0 -novideo %%*1
|SetMacro Alias$URLOpen_MPEGV      /MPEGPlay:PlayMPEG    %%*0
|SetMacro Alias$URLOpen_FSCRV      /MPEGPlay:PlayMPEG    %%*0
|SetMacro Alias$URLOpen_LANTV      /MPEGPlay:PlayMPEG    %%*0
|SetMacro Alias$URLOpen_MPEGF      /MPEGUtils:PlayMPEGF  %%*0
|SetMacro Alias$URLOpen_MPEGResume /MPEGUtils:MPEGResume %%*0
|SetMacro Alias$URLOpen_MPEGPlugin /<Wimp$ScrapDir>.MPEGPlugin %%*0
|Set      Alias$URLOpen_SoundPlayStop SoundPlayStop %%*0
| -- END OBSOLETE --

| Run the configuration script for NCFresco
Obey STBChoices:NCFresco

| Set the icon highlight colour to light red/pink
IconHigh_SetHighlightColour 0x6B6BFD00

| Ensure that the Resolver module is configured given the Inet$ system variables
ResolverConfig

| Set the options toolbar button to go to the main options page
Set OptScr$Path STBContent:HTML.Options.
Set NCFresco$EventURL00 NCOptions_OpenPage:?file_template=OptScr:Options&quit_page=ncint:current

| Check for- and load various modules which NCFresco requires
If "<NCFresco$SSL>" = "Export" Then IfThere System:Modules.Network.HTTPsxMod Then RMLoad System:Modules.Network.HTTPsxMod
If "<NCFresco$SSL>" = "Strong" Then IfThere System:Modules.Network.HTTPsMod  Then RMLoad System:Modules.Network.HTTPsMod
RMEnsure Window    1.61 RMLoad System:Modules.Toolbox.Window
RMEnsure Window    1.61 Error "««NCFresco_Window»»"
RMEnsure HTTP      1.10 RMLoad System:Modules.Network.HTTPMod
RMEnsure HTTP      1.10 Error "««NCFresco_HTTP»»"
RMEnsure WebGopher 0.11 RMLoad System:Modules.Network.WebGopher
RMEnsure WebGopher 0.11 Error "««NCFresco_Gopher»»"
RMEnsure WebFTP    0.25 RMLoad System:Modules.Network.WebFTP
RMEnsure WebFTP    0.25 Error "««NCFresco_FTP»»"

| Start the application
Run Resources:$.Apps.!Watchdog
