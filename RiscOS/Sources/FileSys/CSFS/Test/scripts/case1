|==============================================================================
| Title    : Case1
| Author   : Rich
| Date     : 14 May 1997
| Utilises : CSFS, WebFTP, [ProgressUI]
|
| Description :
|   1) Get environment details
|   2) Create two mounts, one using CSFS and the other using NFS, looking at
|      the same file system. CSFS mount is write cached.
|   3) Create a direcory on CSFS and populate with files.
|   4) Update to the server and check
|   5) Remove files from CSFS and schronise with server
|   6) Update to server and check
|   7) Remove mounts
|==============================================================================


|==============================================================================
echo 1) Get version of test program and version of modules
|
version
modules
|==============================================================================

|==============================================================================
echo 2) Perform mounts
|
mount -service webftp -writecache -name mnt -path test -host bungle -user ftp -passwd nc
|
echo Mount test NFS area
*NFS:Logon -host bungle spinner TwistAgain
*NFS:Mount -host bungle mnt /export/ftp/test
|==============================================================================

|==============================================================================
echo 3) Create test directory and populate with 5 x 50k files
|
*cdir csfs:$.mnt.csfs.test
create csfs:$.mnt.csfs.test.foo1 51201
create csfs:$.mnt.csfs.test.foo2 51201
create csfs:$.mnt.csfs.test.foo3 51201
create csfs:$.mnt.csfs.test.foo4 51201
create csfs:$.mnt.csfs.test.foo5 51201
|==============================================================================

|==============================================================================
echo 4) Synchronise local files with server and check file presence
|
|
update -upload csfs:$.mnt.csfs
ifthere nfs::mnt.$.csfs.test.foo1 success failed
ifthere nfs::mnt.$.csfs.test.foo2 success failed
ifthere nfs::mnt.$.csfs.test.foo3 success failed
ifthere nfs::mnt.$.csfs.test.foo4 success failed
ifthere nfs::mnt.$.csfs.test.foo5 success failed
|==============================================================================

|==============================================================================
echo 5) Remove files from CSFS
|
*remove nfs::mnt.$.csfs.test.foo1
*remove nfs::mnt.$.csfs.test.foo2
*remove nfs::mnt.$.csfs.test.foo3
*remove nfs::mnt.$.csfs.test.foo4
*remove nfs::mnt.$.csfs.test.foo5
*remove nfs::mnt.$.csfs.test
|==============================================================================

|==============================================================================
echo 6) Synchronise local files with server and check file removal
|
update csfs:$.mnt.csfs
ifthere csfs:$.mnt.csfs.test.foo1 failed success
ifthere csfs:$.mnt.csfs.test.foo2 failed success
ifthere csfs:$.mnt.csfs.test.foo3 failed success
ifthere csfs:$.mnt.csfs.test.foo4 failed success
ifthere csfs:$.mnt.csfs.test.foo5 failed success
|==============================================================================

|==============================================================================
echo 7) Remove mounts
|
dismount mnt
*NFS:dismount mnt
echo End of test
|==============================================================================
