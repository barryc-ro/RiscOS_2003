|==============================================================================
| Title    : Case3
| Author   : Rich
| Date     : 19 May 1997
| Utilises : CSFS, WebFTP, HTTP, [ProgressUI]
|
| Description :
|
| Case 3 : (mount, update)
|
| Check that a file that exists on both server and client is downloaded
| to the client if the server timestamp is more recent than that on the
| client.
|
| Check that a file that exists on both server and client is downloaded
| to the client even if the client timestamp is more recent than that on
| the server. This behaviour is due to the lack of -upload.
|
|==============================================================================


|==============================================================================
echo 1) Get version of test program and version of modules
|
version
modules
|==============================================================================

|==============================================================================
echo 2) Perform mounts
|
mount -service webftp -name mnt -path test/csfs -host bungle -user ftp -passwd nc
|
echo Mount test NFS area
*NFS:Logon -host bungle spinner TwistAgain
*NFS:Mount -host bungle mnt /export/ftp/test/csfs
|==============================================================================

|==============================================================================
echo 3) Create 5 x 50k files on server
|
create NFS::mnt.$.foo1 51201
create NFS::mnt.$.foo2 51201
create NFS::mnt.$.foo3 51201
create NFS::mnt.$.foo4 51201
create NFS::mnt.$.foo5 51201
|==============================================================================

|==============================================================================
echo 4) Synchronise client with server and check file presence
|
update csfs:$.mnt
ifthere csfs:$.mnt.foo1 success failed
ifthere csfs:$.mnt.foo2 success failed
ifthere csfs:$.mnt.foo3 success failed
ifthere csfs:$.mnt.foo4 success failed
ifthere csfs:$.mnt.foo5 success failed
wait 60
|==============================================================================

|==============================================================================
echo 5) Stamp files on server
|
*stamp NFS::mnt.$.foo1
*stamp NFS::mnt.$.foo2
*stamp NFS::mnt.$.foo3
*stamp NFS::mnt.$.foo4
*stamp NFS::mnt.$.foo5
ex NFS::mnt.$
|==============================================================================

|==============================================================================
echo 6) Synchronise client with server and check file update
|
update csfs:$.mnt
ex csfs:$.mnt
|==============================================================================

|==============================================================================
echo 7) Stamp files on client
|
wait 60
*stamp csfs:$.mnt.foo1
*stamp csfs:$.mnt.foo2
*stamp csfs:$.mnt.foo3
*stamp csfs:$.mnt.foo4
*stamp csfs:$.mnt.foo5
ex csfs:$.mnt
|==============================================================================

|==============================================================================
echo 8) Synchronise client with server and check file update
|
update csfs:$.mnt
ex csfs:$.mnt
|==============================================================================

|==============================================================================
echo 9) Remove files from server
|
*remove nfs::mnt.$.foo1
*remove nfs::mnt.$.foo2
*remove nfs::mnt.$.foo3
*remove nfs::mnt.$.foo4
*remove nfs::mnt.$.foo5
|==============================================================================

|==============================================================================
echo 10) Remove mounts
|
dismount mnt
*NFS:dismount mnt
echo End of test
|==============================================================================
