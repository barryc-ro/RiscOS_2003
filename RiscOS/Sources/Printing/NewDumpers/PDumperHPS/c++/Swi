
/*****************************************************************************************/
/***                                                                                   ***/
/***  Routines.c                                                                       ***/
/***                                                                                   ***/
/***  Application:   HP Printer Dumper module (using HP SDK)                           ***/
/***                                                                                   ***/
/***                                                                                   ***/
/***  Purpose:       Contains various routines used to implement the printer dumper.   ***/
/***                                                                                   ***/
/*****************************************************************************************/


#include <stdio.h>
#include <stdlib.h>
#include "swis.h"

#include "@.HP_SDK_LIB.HPPrintAPI.h"
#include "PDumper.h"

#include "Defs.h"
#include "Debug.h"
#include "Variables.h"
#include "Swi.h"




/*****************************************************************************************/
/***                                                                                   ***/
/***  PDumper_CallHandler()                                                            ***/
/***                                                                                   ***/
/***  PDumper calls all pass through this module. The reason code is in r11.           ***/
/***                                                                                   ***/
/***                                                                                   ***/
/***  Return:                                                                          ***/
/***    REASON_CODE_NOT_KNOWN                                                          ***/
/***                                                                                   ***/
/*****************************************************************************************/

_kernel_oserror *PDumper_CallHandler(_kernel_swi_regs *regs, void *pw)
    {
    switch(regs->r[11])
        {
        case PDUMPER_REASON__SET_DRIVER:
            pPD ->PDump_SetDriver(regs);
            break;

        case PDUMPER_REASON__OUTPUT_DUMP:
            pPD ->PDump_Output(regs);
            break;

        case PDUMPER_REASON__COLOUR_SET:
            pPD ->PDump_SetColour(regs);
            break;

        case PDUMPER_REASON__START_PAGE:
              pPD ->PDump_StartPage(regs);
            break;

        case PDUMPER_REASON__END_PAGE:
              pPD ->PDump_EndPage(regs);
            break;

        case PDUMPER_REASON__START_JOB:
              pPD ->PDump_StartJob(regs);
            break;

        case PDUMPER_REASON__ABORT_JOB:
              pPD ->PDump_AbortJob(regs);
            break;

        case PDUMPER_REASON__MISC_OP:
            break;


        default:
            DEBUG( DebugMessageInt("Invalid reason code (&%2X)\n", regs->r[11]) );
            break;
        }


    PrinterHandle = -1;                                       // clear the handle!
    return(NULL);
    }



