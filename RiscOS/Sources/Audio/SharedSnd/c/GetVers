REM >GetVers
REM © Pace Micro Technology plc
REM Extracts the module help string from a srccommit-style VersionNum file
REM CSD should be the root of the current component
ERROR 0,"This is a BASIC library, you should not run it directly"

DEF FNget_srccommit_version
LOCAL f%,line$
f%=OPENIN("VersionNum")
IF f%=0 THEN ERROR 0,"Could not open VersionNum file"
REPEAT
line$=GET$#f%
UNTIL MID$(line$,9,18)="Module_HelpVersion" OR EOF#f%
CLOSE#f%
IF MID$(line$,9,18)<>"Module_HelpVersion" THEN ERROR 0,"Could not find Module_HelpVersion entry in VersionNum file"
=LEFT$(RIGHT$(line$,19))
