/***************************************************/
/* File   : Authorise.h                            */
/*                                                 */
/* Purpose: Browser remote authorisation services. */
/*          (aka. authentication).                 */
/*                                                 */
/* Author : A.D.Hodgkinson                         */
/*                                                 */
/* History: 24-Apr-97: Created.                    */
/*          25-Aug-97: Definitions imported from   */
/*                     TBEvents.h.                 */
/***************************************************/

/* Dialogue definitions */

#define AuthPrompt         0x5101
#define AuthUserWrit       0x5102
#define AuthPassWrit       0x5103
#define AuthCancel         0x5104
#define AuthAuthorise      0x5105
#define AuthUserLabel      0x5106
#define AuthPassLabel      0x5107

#define EAuthCancel        0x5104
#define EAuthAuthorise     0x5105

/* Globals */

extern char * authorise;

/* Function prototypes */

_kernel_oserror * authorise_create_dialogue    (void * handle, ObjectId * id);
ObjectId          authorise_return_dialogue_id (void);
int               authorise_authorise          (int eventcode, ToolboxEvent * event, IdBlock * idb, void * handle);
int               authorise_cancel             (int eventcode, ToolboxEvent * event, IdBlock * idb, void * handle);

char            * authorise_read_realm         (char * header_entry);

int               authorise_find_offset        (char * host, char * realm);
int               authorise_find_user_name     (char * host, char * realm);
int               authorise_find_password      (char * host, char * realm);

_kernel_oserror * authorise_remember           (char * host, char * realm, char * username, char * password);
void              authorise_forget             (char * host, char * realm);
