<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML Experimental 19960712//EN">
<html>
  <!-- ======================================================================= -->
  <!--         Template for software functional specifications.                -->
  <!-- ======================================================================= -->
  <head>
    <title>
      Browser Software Functional Specification
    </title>
  </head>

  <body BGCOLOR="#ffffff">


    <h1 align=center>
      Browser Software Functional Specification 
    </h1>

    <p>
    <hr>
    <p align=center><strong>CONFIDENTIAL</strong></p>
    <hr>

    <CENTER>
      <TABLE BORDER=0 WIDTH="40%">
	  <TR><TD>Document ref:	<TD>2107,510/FS
	  <TR><TD>Project:	<TD>RCA NC100 1.16
	  <TR><TD>Revision:	<TD>$Revision$
	  <TR><TD>Date:		<TD>$Date$
	  <TR><TD>Author(s):	<TD><A HREF="mailto:smiddleton@acorn.com">Simon Middleton</a>
	  <TR><TD>Change:		<TD>AMR 4789
	  <TR><TD>Classification:	<TD>Acorn Confidential
      </TABLE>
    </CENTER>

    <!-- ======================================================================= -->

    <hr>
    <h2> Contents </h2>
    <TABLE BORDER=0 WIDTH="100%">
	<TR><TD WIDTH="8%">1.0		<TD><A HREF="#overview">	Overview </A>
	<TR><TD>2.0		<TD><A HREF="#outstanding">	Outstanding issues </A>
	<TR><TD>3.0		<TD><A HREF="#technical">	Technical background </A>
	<TR><TD>4.0		<TD><A HREF="#user">		User interface </A>
	<TR><TD>5.0		<TD><A HREF="#programmer">	Programmer interface </A>
	<TR><TD>6.0		<TD><A HREF="#interchange">     Data interchange </A>
	<TR><TD>7.0             <TD><A HREF="#formats">         Data formats </A>
	<TR><TD>8.0             <TD><A HREF="#external">        External dependencies </A>
	<TR><TD>9.0		<TD><A HREF="#acceptance">	Acceptance test </A>
	<TR><TD>10.0            <TD><A HREF="#noncompliances">  Non compliances </A>
	<TR><TD>11.0		<TD><A HREF="#test">		Development test strategy </A>
	<TR><TD>12.0		<TD><A HREF="#organisation">	Product organisation </A>
	<TR><TD>13.0		<TD><A HREF="#enhancements">	Future enhancements </A>
	<TR><TD>14.0	<TD><A HREF="#glossary">	Glossary </A>
	<TR><TD>15.0	<TD><A HREF="#references">	References </A>
	<TR><TD>16.0	<TD><A HREF="#history">		History </A>
    </TABLE>

    <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="overview"> 1.0 Overview </a> </h2>

    <P> This document contains the software functional specification for
      the Web browser included in the system ROM of the 
      RCA NC100 Network Computer version 1.16 <A HREF="#cis">[1]</A>.

    <P>This document only describes changes from the version of the
    browser included in NC OS 1.15 <A HREF="#rca115">[2]</A>. The
    previous specification to that may be useful for reference <A
    HREF="#model1">[3]</A>

    <P>Italicised text is used where issues are still to be decided
      or where contents are liable to change.

    <P>

      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="outstanding"> 2.0 Outstanding issues </a> </h2>

    <P> None.
    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="technical"> 3.0 Technical background </a> </h2>

    <P>The browser for 1.16 is identical to that included in
    NC&nbsp;OS 1.15 except for some bug fixes and support for some UI
    changes as listed below.

    <P>The main standards reference for the HTML implementation is
    HTML 3.2 <A HREF="#html">[4]</A>.

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="user"> 4.0 User interface </a> </h2>

    <P>The changes to the user interface, or in support of user
    interface features are listed here.



    <H3>4.1 Keyboard changes</H3>

    <H4>4.1.1 STOP button</H4>

    <P>The STOP button is now dual purpose. If a page or file is
    downloading then pressing the STOP button aborts the
    fetch. Otherwise if a codec is playing then it is stopped.



    <H3>4.2 Rendering changes</H3>


    <H4>4.2.3 Alternate text for embedded objects</H4>

    <P>The browser has always displayed ALT text whilst downloading
    image files and in NC&nbsp;OS&nbsp;1.15 it attempted to also
    display display a helpful message in place of an unsupported
    embedded object.

    <P>The method now is to display the first one of the following
    pieces of text found.
    <UL>
      <LI>ALT or STANDBY text found in the HTML element.

      <LI>For a INPUT TYPE=IMAGE button, the contents of the VALUE
      attribute.

      <LI>For an embedded object, the text 'Unsupported plugin' plus
      the file type or mime type, if known and leaf name.

      <LI>For an image the leaf name from the URL.
    </UL>


    <H3>4.3 New HTML</H3>

    <P>Some new HTML constructs have become necessary to support
    changes in the Interactive setup.

    <H4>4.3.1 PBX definitions</H4>

    <P>The Interactive setup requires the user to be able to enter
    extra codes to control their telephone exchange, namely the comma,
      hash and star characters <TT><B># , *</B></TT>.

    <P>The previously introduced NUMBERS attribute to the INPUT
    element is extended to allow this. Rather than being a
    <CODE>void</CODE> attribute it now takes an argument of
    <CODE>NUMBERS</CODE> or <CODE>PBX</CODE>. For backwards
    compatibility, if no argument is given then <CODE>NUMBERS</CODE>
    is assumed. As before this attribute is only meaningful when used
    with the <CODE>TEXT</CODE> or <CODE>PASSWORD</CODE> forms iof the
    INPUT element.

    <DL>
      <DT><CODE>INPUT TYPE=TEXT NUMBERS=NUMBERS</CODE><BR>
	<CODE>INPUT TYPE=PASSWORD NUMBERS=NUMBERS</CODE>
      <DD>This differs from a normal text or password element in the
	following ways.
	<UL>
	  <LI>Each character cell is surrounded by its own box.
	  <LI>Only the numbers 0-9 can be entered.
	  <LI>Overwrite mode is enabled.
	  <LI>After entering the last character the input focus will
	    move to the next element.
	  <LI>The on screen keyboard is not used to enter characters,
	    instead the caret is shown immediately on moving the input
	    focus to this element.
	</UL>

      <DT><CODE>INPUT TYPE=TEXT NUMBERS=PBX</CODE><BR>
	<CODE>INPUT TYPE=PASSWORD NUMBERS=PBX</CODE>
      <DD>This extension has all the features listed above except
	<UL>
	  <LI>The characters hash, star amd comma can be entered
	  <LI>The on screen keyboard must be used to enter text.
	</UL>

      <DD>
	
    </DL>


    <H4>4.3.2 META tag extensions</H4>

    <P>Some new META tag extensions have been introduced.

    <DL>
      <DT><CODE>&lt;META NAME=&quot;ncbrowsermode&quot; CONTENT=&quot;ENSURETOOLBAR=<var>toolbar</var>&quot;</CODE>

      <DD>This forces the numbered toolbar to be opened and ensures
	that the correct toolbar appears below each popup window.

      <DT><CODE>&lt;META NAME=&quot;ncbrowsermode&quot;
	  CONTENT=&quot;SELECTBUTTON=<var>component id</var>&quot;</CODE>

      <DD>This gives the component id in the resource file of the
	button to be made active (given secondary highlight) whilst
	this window is open.

      <DT><CODE>&lt;META NAME=&quot;ncbrowsermode&quot;
	  CONTENT=&quot;SUBMITONUNLOAD=<var>form id</var>&quot;</CODE>

      <DD>When the page is removed then the form with the given id
      (which must be on the same page) will be submitted. The form
      action must be an internal URL that generates no output
      otherwise the results are undefined.

      <DT><CODE>&lt;META NAME=&quot;ncbrowsermode&quot;
	  CONTENT=&quot;SPECIALSELECT=<var>id</var>&quot;</CODE>

      <DD>This specifies the id of a form, form item, or link on the
      page that should be submitted when the <i>special</i> event is
      received. For this release the <i>special</i> event is set to
      occur when the BACK key is pressed on an OFFLINE page.

    </DL>

    <H4>4.3.3 ncfrescointernal extensions</H4>

    <P>Some new internal commands have been added.

    <DL>
      <DT><CODE>ncfrescointernal:current</CODE>
      <DD>This will reload the page at the current point on the
	history list. This is for use when returning from the options
	pages and other pages that do not enter themselves into the
	history list.
	
      <DT><CODE>ncfrescointernal:openpanel?name=memdump</CODE>
	
      <DD>This will display a short summary of memory use by the
	browser and other areas of the system.

      <DT><CODE>ncfrescointernal:submit?id=<var>form id</var></CODE>

      <DD>This submits the form with the given id. If the form is not
	in the same frame as this link then the frame name can be
	given with the <var>source</var> option (see 1.15 specification).

    </DL>

    <H3>4.4 Printing changes</h3>

    <H4>4.4.1 Print setup window</H4>

    <P>The print setup window is now attached to the toolbar as
      described in the CIS version 1.6.

    <P>In addition when it is opened it issues a PDriver_Command SWI
      to position the print head for removal.

    <P>

    <H3>4.5 Toolbar related changes</h3>

    <H4>4.5.1 Codec toolbar and screen blanker</H4>

    <P>Whilst the codec toolbar is open then the screenblanker is
    disabled (and the screen automatically unblanked). When the codec
    toolbar is closed then the screenblanker is reset to its original
    timeout value.


    <h4>4.5.2 Time on INFO page</H4>

    <P>The display for a page's Last Modified and Expires time is now
      shown according to the users local timezone rather than GMT.


    <H4>4.5.3 Popup window handling</H4>

    <P>The opening and closing of popup window is modified as follows

    <UL>

      <LI>For the Favorites, Go To and History window, then pressing
      Go Back at any time, or OK when on the button that opened the
      window, closes the window. If the highlight was on the toolbar
      at the time then it stays on whatever button it was on. If the
      highlight was in the page then it moves to the button that
      originally opened the window just closed.

      <LI>If the GoTo window and on screen keyboard are open at the
      same time then explicitly closing either of them will close the
      other. ie selecting the GOTO or KEYBOARD toolbar buttons, or
      pressing the GO BACK or GOTO handset buttons.
    </UL>


    <H3>4.6 Existing bugs</H3>

    <P>Important outstanding bugs are fixed in this release, including:-

    <UL>
      <LI>WBR element didn't work outside the NOBR element.  

      <LI>After the on screen keyboard had been opened and closed the
      browser calculated the margins wrongly so the end of the page
      could not be scrolled down to and some text was 'trapped' behind
      the toolbar.

<!--
      <LI>JPEG format images were printed at the wrong scale in
	1.15.

      <LI>Percentage scaled table cells could behave unpredictably.

      <LI>Width sharing over multiple table cells with unspecified
      cells sometimes didn't work.

      <LI>The INFO window could not be toggled off immediately after it
	was opened.

      <LI>Occasional misrendering of P as BR.

      <LI>Recognising that a handset key has been pressed immediately
	rather than after the second had been pressed.
 -->
    </UL>


    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="programmer"> 5.0 Programmer interface </a> </h2>

    <P>There are no changes to the programmer interface.

      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="interchange"> 6.0 Data interchange </a> </h2>
    
    <P>There are no new data interchange protocols defined in this spec.

    <P>
      <!-- ======================================================================= --> 

    <hr  noshade>
    <h2> <a name="formats"> 7.0 Data formats </a> </h2>

    <P>There are no new data formats defined by this specification.

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="external"> 8.0 External dependencies </a> </h2>

    <P>There are no external dependencies.

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="acceptance"> 9.0 Acceptance test </a> </h2>

    <P>The browser will support the required UI changes described in
      the CIS and will behave as described above.

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="noncompliances"> 10.0 Non compliances </a> </h2>

      <P>The following elements of the HTML 3.2 specification are not implemented.
	<DL>
	  <DT>LINK
	  <DD>This element is very rarely used.
	  <DT>INPUT TYPE=FILE
	  <DD>This element is for file upload over HTTP and is not
	    relevant to the NC as there is no local storage.
	</DL>

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="test"> 11.0 Development test strategy </a> </h2>

    <UL>
      <LI>Test pages will be created to test the new HTML introduced.

      <LI>HTML featuring the different categories of alternate text that can be
	displayed whilst downloading will be created.

      <LI>Other changes (eg 4.1, 4.4, 4.5) can be tested by just trying the
	feature.

      <LI>The progress indicators will be tested against different
	sized files with particular attention to behaviour when the
	download or playback fails.

      <LI>All features derived from submitted fault reports will be
	regressed against the original fault report.

<!--
      <LI>HTML featuring the different varieties of link patterns will
	be created to test the new highlight display code. eg single,
	multi-line, split multi-line, lines with changing font heights
	and positioning, different sized images, floating images,
	excess whitespace, broken links.

      <LI>HTML featuring the known table problem areas will be created
	and added to the automated test archive.

      <LI>HTML featuring the broken examples in 4.7 will be created.

 -->
    </UL>

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="organisation"> 12.0 Product organisation </a> </h2>

    <P>The browser is built via a Solaris hosted cross-compiling
      version of ARM cc (Acorn port) v5.06. For ROM release a
      partially linked <TT>AOF</TT> file is created which is imported into
      the RISC&nbsp;OS build tree. The browser runs from ROM.

    <P>There are several support modules.
    <UL>
      <LI>HTTP transport
      <LI>FTP transport
      <LI>Gopher transport
      <LI>Resolver
    </UL>

    <P>These are all written in C and integrated into the build
      tree.

    <P>The SSLeay library that provides SSL support for the HTTP
      module is cross-compiled on Solaris and creates two ALF format
      files that are linked with the HTTP module in the main ROM build.

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="enhancements"> 13.0 Future enhancements </a> </h2>

    <P>The following new items were specified but removed due to lack of time.

    <H4>13.1 Imagemap navigation</H4>

    <p>When navigating around an imagemap using the cross-hairs cursor
    then the navigation does not return to discrete mode immediately
    on reaching the edge of the image. Instead the relevant cursor
    keys must be released and pressed again after a short interval
    (0.40 seconds) to leave. This stops the user leaving map
    navigation mode by accident.
      
    <h4>13.2 Framed history and favorites pages</h4>

    <P>The four history and favorites pages are now constructed such
    that the title, with the current user and page name, is in a
    separate frame and stays in view when the rest of the page
    scrolls. 


    <H4>13.3 File download indicator</H4>

    <P>A file download indicator is added to the toolbar. This appears
    as an extension to the toolbar and features a line that increases
    from left to right to show the proportion of the file loaded. See
    the CIS for exact details of how it looks.

    <P>This only shows the download of the original file fetched. ie
    for an HTML page the bar will finish (and disappear) when all the
    HTML has been fetched. It will not be displayed whilst fetching
    the images or other embedded objects in the page.


    <H4>13.4 Codec progress indicator</H4>

    <P>A Codec progress indicator is added to the codec toolbar. This
    appears as an extension to the toolbar and features a line that
    increases from left to right to show the proportion of the file
    loaded. See the CIS for exact details of how it looks.

    <P>This shows how far through the file playback has reached. It is
    not interactive and cannot be clicked and dragged.

    <P>Note that this information is not available for some media
    types, eg any streaming type such as RealAudio, and MIDI files.

    <H3>13.5 Broken HTML handling</H3>

    <P>The following examples of badly written HTML are handled
      better.

    <UL>
      <LI>DD/DT elements outside a DL are now preceded by a line break.

      <LI>FRAME elements outside their correct FRAMESET are placed
      into the frame structure somewhere so that their content is
      visible.
    </UL>

    <H4>13.6 Floating images</H4>

    <P>In the NC OS 1.06 browser (and also in Netscape Navigator), the
    code that handles the placement of objects next to a floating
    object always assumed that at least one object could be placed
    there. The result of this was that text or images next to a
    floating object within a table cell could overlap the cell. This
      happens in Netscape Navigator occasionally, but more frequently
      on the NC due to the smaller screen size and larger fonts.

    <P>The new formatting code in 1.15 fixes this bug and prevents
    overlaps however this has the side-effect that where there is not
    enough space for an object (eg a table) next to a floating object
    it is wrapped round to underneath the floating object rather than
    staying there and being scaled to fit.

    <P>To fix this new problem the formatting code is adjusted to
    allow this feature to work but without reintroducing the overlap
    bug or causing other elements to format outside their designated
    areas.
      

    <H4>13.7 Highlight display</H4>

    <P>The highlight drawn around text and image elements is now drawn
    as one path, rather than the succession of boxes drawn
    previously. This path follows the outer extent of all the objects
    in the link. The path 'clings' to the extent in a similar manner
    to WebTV's highlight. Where the parts of a link do not overlap
    horizontally then the path is discontinuous, however the link is
    still treated as one and the two, or more, sections are
    highlighted together (as in 1.15).


    <H4>13.8 Popup window handling</H4>

    <P>For any popup from the Custom toolbar or from the Print
      setup window then as soon as the highlight leaves that window,
      it closes and the highlight ends on the button that originally
      opened it.

    <P>

    <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="glossary"> 14.0 Glossary </a> </h2>

    <TABLE WIDTH="100%" BORDER=0>
	<TR><TD>API	<TD>Application Programmer Interface.
	<TR><TD>Cache		<TD>Area of disk or memory used to
	    store recently accessed files.
	<TR><TD>Caret		<TD>Text cursor.
	<TR><TD>CIS		<TD>Customer Interface Specification.
	<TR><TD>Codec		<TD>COder-DECoder.
	<TR><TD>GIF		<TD>Graphics Interchange Format. A compressed image format.
	<TR><TD>FORM		<TD>An HTML element that allows the
	    user to make selections and enter text that is then sent
	    to a server.
	<TR><TD>Floating	<TD>In HTML, an attribute of an image
	    or table that causes following text or images to wrap
	    around the edge of the image rather than being displayed
	    after the floating object.
	<TR><TD>Frame		<TD>An independently scrollable
	    portion of an HTML page.
	<TR><TD>FTP		<TD>File Transfer Protocol.
	<TR><TD>History		<TD>A list of pages visited by the
	    user recently.
	<TR><TD>HTML		<TD>Hyper Text Markup Language.
	<TR><TD>HTML 3.2	<TD>The current base-line HTML standard.
	<TR><TD>HTTP		<TD>Hyper Text Transport Protocol.
	<TR><TD>Imagemap	<TD>An image where clicking on
	    different areas will launch different URLs.
	<TR><TD>IP		<TD>Internet Protocol.
	<TR><TD>JFIF		<TD>JPEG File Interchange
	    Format. Standard file format for most (bti not all) JPEG files.
	<TR><TD>JPEG		<TD>Joint Photographic Experts Group. A compressed image format.
	<TR><TD>MIDI		<TD>Musical Instrument DigitalInterface. Standard file format for score based music.
	<TR><TD>MIME		<TD>Multipurpose Internet Mail Extensions.
	<TR><TD>NC		<TD>Network Computer.
	<TR><TD>NTSC		<TD>TV standard used in the USA.
	<TR><TD>NVRAM		<TD>Non-volatile RAM. Maintains its
	    contents when power is off.
	<TR><TD>OS		<TD>Operating System.
	<TR><TD>PAL		<TD>TV standard used in Europe.
	<TR><TD>PDD		<TD>Product Definition Document.
	<TR><TD>Plugins		<TD>A program that
	    extends the browser by handling a particulat type of file
	    embedded in an HTML page.
	<TR><TD>PNG		<TD>Portable Network Graphic. A
	    compressed image format.
	<TR><TD>proxy		<TD>Computer that handles requests for
	    files on behalf of the NC, allowing the NC to have
	    communication with only one other machine.
	<TR><TD>RAM		<TD>Random Access Memory.
	<TR><TD>ROM		<TD>Read Only Memory.
	<TR><TD>Sprite		<TD>An Acorn proprietary bitmap
	    graphics file format.
	<TR><TD>SSL		<TD>Secure Sockets Layer.
	<TR><TD>SWI		<TD>Software Interrupt.
	<TR><TD>TCP		<TD>Terminal Connection Protocol.
	<TR><TD>UI		<TD>User Interface.
	<TR><TD>URL		<TD>Uniform Resource Locator.
	<TR><TD>WIMP		<TD>Window Manager.
	<TR><TD>W3C		<TD>World Wide Web Consortium. Closest thing 
	    to a useful standards body for web software.
    </TABLE>

    <P>

      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="references"> 15.0 References </a> </h2>

    <P>The following external standards are referenced in this spec.

    <DL>

      <DT>[1] <A NAME="cis">CIS</A>
      <DD>RCA NC100 Customer Interface Specification.

      <DT>[2] <A NAME="rca115" HREF="../../../rca_nc100/software_docs/apps/browserrca.html">
	  Browser Software Functional Specification [NC100 1.15]</A>
      <DD>Document ref: 2107,702

      <DT>[3] <A NAME="model1" HREF="../../../rca_nc100/referenced_soft/apps/browser.html">
	  Browser Software Functional Specification [Model 1]</A>
      <DD>Document ref: 2103,702

      <DT>[4] <A NAME="html" HREF="http://www.w3.org/pub/WWW/TR/">HTML 3.2
	  Reference Specification</a>
      <DD>The base document for the NCBrowser HTML implementation.
      <DT>
    </DL>

    <P>

      <!-- ======================================================================= -->

    <hr>
    <h2> <a name="history"> 16.0 History </a> </h2>

    <PRE>
$Log$
Revision 2.1  1997/08/28 12:52:10  srose
SECTION: header
CHANGE:  AMR 4789 allocated
REASON:  Sign off

Revision 1.6  1997/08/27 15:52:57  srose
SECTIONS: 4.6, 11.0, 13.7.
CHANGES:  Typos.
REASONS:  Spelling mistakes.
IMPACTS:  None.

Revision 1.5  1997/08/20 12:39:17  srose
SECTION: 15.0 References
CHANGE:  URL correction (link to 2103,702)
REASON:  was broken
IMPACTS: none

Revision 1.4  1997/08/19 10:46:22  smiddle
SECTION: 1.0/3.0/15.0
CHANGE:  Tidied up references
REASON:  out of date
IMPACT:  none

Revision 1.3  1997/08/19 10:41:22  smiddle
SECTION: 4.3.2
CHANGE:  removed URL attribute and added SPECIALSELECT attribute
REASON:  previous method of providing BACK service was not sufficient
IMPACT:  interactive setup screens need changing

Revision 1.2  1997/08/15 11:32:04  smiddle
Moved many items to future enhancements and added details of the
new internal commands and flags to bring into line with what is being
implemented.

Revision 1.1  1997/08/11 15:22:07  smiddle
Created first version.

    </PRE>

    <hr>
    <P>

    <TABLE BORDER=1 WIDTH="100%">
	<TR>
	  <TD WIDTH="50%" VALIGN=TOP>
	    <SMALL>
	      This document is issued under license and must not be copied, reproduced
	      or disclosed in part or whole outside the terms of the license.
	    </SMALL>
	  <TD WIDTH="50%" VALIGN=TOP>
	    <SMALL>
	      &#169; Acorn Computers Ltd 1997
	    </SMALL>
    </TABLE>

    <HR>
    <!-- Created: Fri Nov  8 14:19:55 GMT 1996 -->
    <!-- hhmts start -->
Last modified: Tue Aug 19 11:46:10 BST 1997
<!-- hhmts end -->
  </body>
</html>
