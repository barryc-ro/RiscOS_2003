<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML Experimental 19960712//EN">
<html>
  <!-- ======================================================================= -->
  <!--         Template for software functional specifications.                -->
  <!-- ======================================================================= -->
  <head>
    <title>
      Browser Software Functional Specification
    </title>
  </head>

  <body BGCOLOR="#ffffff">


    <h1 align=center>
      Browser Software Functional Specification 
    </h1>

    <p>
    <hr>
    <p align=center><strong>CONFIDENTIAL</strong></p>
    <hr>

    <CENTER>
      <TABLE BORDER=0 WIDTH="40%">
	  <TR><TD>Document ref:	<TD>2107,611/FS
	  <TR><TD>Project:	<TD>Acorn Generic 2.0
	  <TR><TD>Revision:	<TD>$Revision$
	  <TR><TD>Date:		<TD>$Date$
	  <TR><TD>Author(s):	<TD><A HREF="mailto:smiddleton@acorn.com">Simon Middleton</a>
	  <TR><TD>Change:		<TD>AMR 4820
	  <TR><TD>Classification:	<TD>Acorn Restricted
      </TABLE>
    </CENTER>

    <!-- ======================================================================= -->

    <hr>
    <h2> Contents </h2>
    <TABLE BORDER=0 WIDTH="100%">
	<TR><TD WIDTH="8%">1.0		<TD><A HREF="#overview">	Overview </A>
	<TR><TD>2.0		<TD><A HREF="#outstanding">	Outstanding issues </A>
	<TR><TD>3.0		<TD><A HREF="#technical">	Technical background </A>
	<TR><TD>4.0		<TD><A HREF="#user">		User interface </A>
	<TR><TD>5.0		<TD><A HREF="#programmer">	Programmer interface </A>
	<TR><TD>6.0		<TD><A HREF="#interchange">     Data interchange </A>
	<TR><TD>7.0             <TD><A HREF="#formats">         Data formats </A>
	<TR><TD>8.0             <TD><A HREF="#external">        External dependencies </A>
	<TR><TD>9.0		<TD><A HREF="#acceptance">	Acceptance test </A>
	<TR><TD>10.0            <TD><A HREF="#noncompliances">  Non compliances </A>
	<TR><TD>11.0		<TD><A HREF="#test">		Development test strategy </A>
	<TR><TD>12.0		<TD><A HREF="#organisation">	Product organisation </A>
	<TR><TD>13.0		<TD><A HREF="#enhancements">	Future enhancements </A>
	<TR><TD>14.0	<TD><A HREF="#glossary">	Glossary </A>
	<TR><TD>15.0	<TD><A HREF="#references">	References </A>
	<TR><TD>16.0	<TD><A HREF="#history">		History </A>
    </TABLE>

    <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="overview"> 1.0 Overview </a> </h2>

    <P> This document contains the software functional specification for
      the Web browser included in the system ROM of the 
      Acorn Generic Network Computer version 2.0 <A HREF="#cis">[1]</A>.

    <P>This document only describes changes from the version of the
    browser included in NC OS 1.16 <A
    HREF="#rca116">[2]</A>. Specifications for the previous versions
    of the browser may be of interest <A HREF="#rca115">[3]</A> <A HREF="#model1">[4]</A>

      <P>The baseline specification for the HTML implementation is
      HTML 3.2 <A HREF="#html32">[5]</A> although some elements from
      its successor, HTML 4 <A HREF="#html40">[6]</A>, have been implemented.

    <P>Italicised text is used where issues are still to be decided
      or where contents are liable to change.

    <P>

      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="outstanding"> 2.0 Outstanding issues </a> </h2>

    <P> None.
    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="technical"> 3.0 Technical background </a> </h2>

    <P>The browser for Acorn Generic 2.0 is identical to that included in
    NC&nbsp;OS 1.16 except for some bug fixes and support for some UI
    changes as listed below.

    <h3>3.1 Favourites saving</h3>

    <P>To enable the saving of favourites over a power down without
    requiring a service provider that can support CSFS the capability
      to save the favorites to NVRAM is added.

    <P>This facility is used if the favorites file name (read from the
    config file entry <VAR>files.hots</VAR> and by default set to the
    value of the system variable <VAR>NCFresco$Hotlist</VAR>)
    evaluates to nothing.

    <P>NVRAM has limited space so not all items will be able to be
    stored. Those dropped will be the items least recently accessed,
    as with trimming the list when it exceeds the limits in the Config
    file. The items dropped will still be available for use during the
    current session.

    <P>The favourites are written to the NVRAM via the NVRAM module
    using the tag <VAR>BrowserFavorites</VAR>. If this tag is not
    present then no saving is performed.

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="user"> 4.0 User interface </a> </h2>

    <P>The changes to the user interface, or in support of user
    interface features are listed here.

    <h3>4.1 Open URL window</h3>

    <P>The open URL window code is extended to allow a <B>Current</B>
      button that will insert the URL of the current document into the
      writeable field.

    <h3>4.2 Favorites and history screens</h3>

    <P>See the CIS for details of the new look.      

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="programmer"> 5.0 Programmer interface </a> </h2>

    <H3>5.1 Message_NCFresco</H3>

    <P>The Wimp message Message_NCFresco, reason code 0 (LoadConfig)
    is extended to allow the browser to be notified that NVRAM
    locations it uses have been changed and so it should update its
    internal copies.

    <P>The new complete specification for this message is as follows.

      <H4>MESSAGE_NCFRESCO (&amp;4AF84)</H4>
      <PRE>
    R1+16   Message_NCFresco
    R1+20   Reason code
		0: LoadUserFiles
		1: Die
		2: reserved
		3: LoadConfig
    R1+24   flags (reason code dependent)
    R1+28.. data (reason code dependent)
      </PRE>


	<h5>LoadUserFiles (0)</h5>
	
      <PRE>
    R1+24 flags
		  bit 0: 0 = load all user files 
			     (bits 1-7 ignored)
			 1 = load only specified user files
		  bit 1: 0 = don't load user config
			 1 = load user config
		  bit 2: 0 = don't load cookies
			 1 = load cookies
		  bit 3: 0 = don't load passwords
			 1 = load passwords
		  bit 4: 0 = don't load hotlist
			 1 = load hotlist
		  bit 5: 0 = don't load plugin list
			 1 = load plugin list
		  bit 6: 0 = don't load allow and deny files
			 1 = load allow and deny files
		  bit 7: 0 = don't flush user data
			 1 = flush user data
		  bit 8: 0 = don't read NVRAM
			 1 = read NVRAM and update soft copies
		  bits 9-31: reserved (must be zero)
      </PRE>

	<P>When this message is received the browser will attempt to
	load the user specific files, ie the Cookies, Passwords,
	Plugin config and User config. Each of the files can be
	disabled by setting the appropriate flag. If disabled the
	existing values continue to be used.

      <P>If bit 0 is clear or bit 7 is set then all transient user data
      is flushed from memory. eg history lists, cookies etc. and also the
      browser cache is flushed.

	<P>Note that the locations of each file can be changed by
	values in the config file. The order defined is that the
	user config file is loaded first and if this changes the
	locations of any of the other user files then they are loaded
	from the new locations.	

    <P>The NVRAM locations read are:-

    <UL>
      <LI>BrowserFontSize
      <LI>BrowserMusicStatus
      <LI>BrowserBeepStatus
      <LI>BrowserScaling
      <LI>PrinterColour
      <LI>PrinterOrientation
    </UL>

	<h5>Die (1)</h5>

      <PRE>
    R1+24 flags
		  bits 0-31: reserved (must be zero)
      </PRE>

	<P>When this message is received the browser will perform a
	  clean exit.

	<h5>LoadConfig (3)</h5>

      <PRE>
    R1+24 flags
		  bits 0-31: reserved (must be zero)
    R1+28 null-terminated filename
      </PRE>

      <P>Load the config file given by the filename at offset 28.

    <h3>5.2 ncfrescointernal commands</h3>

    <P>Some new internal URLs are defined.

    <DL>
      <DT><CODE>ncfrescointernal:openpanel?name=favswitch[&mode={delete|show}]</CODE>

      <DD>This opens the new style favourites page that includes a
      button to switch between show favourites and delete favourites.

	<BR>It takes an optional argument which determines which style
	  of page to open.
	<P>

      <DT><CODE>ncfrescointernal:openpanel?name=historyswitch[&mode={alpha|recent}]</CODE>
      <DD>This opens the new style history page that includes a
      button to switch between showing the recent and alphabetical
	history lists.

	<BR>It takes an optional argument which determines which style
	  of page to open.
    </DL>

      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="interchange"> 6.0 Data interchange </a> </h2>
    
    <P>There are no new data interchange protocols defined in this spec.

    <P>
      <!-- ======================================================================= --> 

    <hr  noshade>
    <h2> <a name="formats"> 7.0 Data formats </a> </h2>

    <P>The following extensions to the Config file format are made.

    <h3>7.1 Keyboard mapping</H3>

    <P>To allow the key to event mapping to be changed without
    recompiling the mapping is now specified in the Config file. A
      single line with the <CODE>key</CODE> tag specifies a single key
      to event mapping for a single mode.

    <P>The format of this line is as follows

    <TABLE BGCOLOR=grey80 CELLPADDING=4>
	<TR>
	  <TD><CODE>key:</CODE>
	  <TD><i>map number</i>
	  <TD><i>key number</i>
	  <TD><i>event number</i>
	  <TD><i>flags (optional)</i>
    </TABLE>

    <P>All values can entered in decimal or in hex, prefixed by <TT>0x</TT>.

    <P>The maps are as follows, they are shown in the order in which
    they are scanned. If a map has a condition then it isn't checked
    unless that condition is true. If a map is marked as exclusive
    then if it is checked, no further maps are checked, whether is
    returned a key or not. If a key isn't handled then it is passed
    on to the next application using Wimp_ProcessKey as normal.

    <TABLE BGCOLOR=grey80 CELLPADDING=4>
      <TR><TH>Num<TH>Description		<TH>Exclusive	<TH>Condition
      <TR><TD>6<TD>Toolbar			<TD>		<TD>Highlight/input focus is on toolbar
      <TR><TD>5<TD>Frame resizing		<TD>Y		<TD>Frame resizing is taking place
      <TR><TD>4<TD>Menu				<TD>Y		<TD>Menu from SELECT item is open
      <TR><TD>3<TD>Map				<TD>Y		<TD>Cross-hairs cursor is in use over map
      <TR><TD>8<TD>On screen keyboard		<TD>		<TD>OSK is up
      <TR><TD>11<TD>Writeables			<TD>		<TD>Caret visible
      <TR><TD>10<TD>External popup		<TD>Y		<TD>Another app has opened a __dbox frame
      <TR><TD>9<TD>Frame link			<TD>		<TD>Frame link highlighted
      <TR><TD>0<TD>Movement			<TD>		<TD>
      <TR><TD>1<TD>Desktop/Offline		<TD>		<TD>MODE=OFFLINE
      <TR><TD>7<TD>Web				<TD>		<TD>MODE=ONLINE
      <TR><TD>2<TD>Codecs			<TD>		<TD>
      <TR><TD>12<TD>RISC OS specific		<TD>		<TD>mode.platform = 1
    </TABLE>

    <P>The keys are the standard key codes returned by the Wimp as
    detailed in the PRM.

    <P>The flags are as follows

    <TABLE BGCOLOR=grey80 CELLPADDING=4>
      <TR><TD>0x01<TD>Allow auto-repeat
      <TR><TD>0x02<TD>Make click (obselete)
    </TABLE>

    <P>The writeable events are as follows

    <TABLE BGCOLOR=grey80 CELLPADDING=4>
      <TR><TD>0<TD>No action
      <TR><TD>1<TD>Newline, submit if only TEXT or PASSWD
      <TR><TD>2<TD>Newline if TEXTAREA, submit if TEXT or PASSWD
      <TR><TD>3<TD>Newline if TEXTAREA, submit if last TEXT or PASSWD
      <TR><TD>4<TD>Delete left
      <TR><TD>5<TD>Delete right
      <TR><TD>6<TD>Delete line
      <TR><TD>7<TD>Delete all text
      <TR><TD>8<TD>Delete to end of line
      <TR><TD>9<TD>Delete to start of line
      <TR><TD>10<TD>Left
      <TR><TD>11<TD>Right
      <TR><TD>12<TD>Up
      <TR><TD>13<TD>Down
      <TR><TD>14<TD>Start of line
      <TR><TD>15<TD>End of line
      <TR><TD>16<TD>Start of area
      <TR><TD>17<TD>End of area
      <TR><TD>18<TD>Left, or off if on edge column
      <TR><TD>18<TD>right, or off if on edge column
    </TABLE>

    <P>The standard event list is as follows

    <TABLE BGCOLOR=grey80 CELLPADDING=1>
	<TR><TD>GLOBAL_FONT_SET		    <TD>0x1100<BR>0x110D<TD>Set font size
	<TR><TD>GLOBAL_FONT_INC		    <TD>0x110e<TD>Use one font size larger
	<TR><TD>GLOBAL_FONT_DEC		    <TD>0x110f<TD>Use one font size smaller

	<TR><TD>TOGGLE_FRAMES                <TD>0x2000<TD>unused
	<TR><TD>TOGGLE_STATUS                <TD>0x2001<TD>Toggle status/button/tool bar on and off
	<TR><TD>TOGGLE_ANTI_ALIAS            <TD>0x2002<TD>unused
	<TR><TD>TOGGLE_COLOURS               <TD>0x2003<TD>Toggle background and foreground colours on and off
	<TR><TD>TOGGLE_IMAGES                <TD>0x2004<TD>Toggle image deferring on and off
	<TR><TD>STATUS_OFF	            <TD>0x2005<TD>Close toolbar
	    
	    <TR><TD>HISTORY_SHOW                 <TD>0x2010<TD>Show combined alphabetical and recent list (1.06 style)
	    <TR><TD>HISTORY_BACK                 <TD>0x2011<TD>Move back in history
	    <TR><TD>HISTORY_BACK_ALL             <TD>0x2012<TD>Move to first history item
	    <TR><TD>HISTORY_FORWARD              <TD>0x2013<TD>Move forward in history
	    <TR><TD>HISTORY_FORWARD_ALL          <TD>0x2014<TD>Move to last history item
	    <TR><TD>HISTORY_SHOW_ALPHA           <TD>0x2015<TD>Show history list, ordered alphabetically
	    <TR><TD>HISTORY_SHOW_RECENT          <TD>0x2016<TD>Show history list, ordered chronologically
	    <TR><TD>HISTORY_SHOW_SWITCHABLE      <TD>0x2017<TD>Show history list with button to switch styles
	    <TR><TD>HISTORY_SHOW_ALPHA_FRAMES    <TD>0x2018<TD>Show history list in frames, ordered alphabetically
	    <TR><TD>HISTORY_SHOW_RECENT_FRAMES   <TD>0x2019<TD>Show history list in frames, ordered chronologically
	    <TR><TD>HISTORY_SHOW_SWITCHABLE_FRAMES <TD>0x201A<TD>Show history list in frames with button to switch styles

	    <TR><TD>HOTLIST_SHOW                 <TD>0x2020<TD>Show the hotlist
	    <TR><TD>HOTLIST_ADD                  <TD>0x2021<TD>Add page URL of given page to the hotlist
	    <TR><TD>HOTLIST_REMOVE               <TD>0x2022<TD>Remove page URL of given page from the hotlist
	    <TR><TD>HOTLIST_WIPE                 <TD>0x2023<TD>Wipe the hotlist clean
	    <TR><TD>HOTLIST_SHOW_WITH_URL        <TD>0x2024<TD>Show the hotlist with an open URL line
	    <TR><TD>HOTLIST_SHOW_DELETE	    <TD>0x2025<TD>Show the hotlist with deleteable items
	    <TR><TD>HOTLIST_FLUSH_DELETE	    <TD>0x2026<TD>Delete marked entries
	    <TR><TD>HOTLIST_SHOW_SWITCHABLE	    <TD>0x2027<TD>Show the hotlist with button to switch to deletable list
	    <TR><TD>HOTLIST_SHOW_FRAMES	    <TD>0x2028<TD>Show the hotlist in frames
	    <TR><TD>HOTLIST_SHOW_DELETE_FRAMES   <TD>0x2029<TD>Show the hotlist with deleteable items in frames
	    <TR><TD>HOTLIST_SHOW_SWITCHABLE_FRAMES <TD>0x202A<TD>Show the hotlist with button to switch to deletable list in frames

	    <TR><TD>RELOAD                       <TD>0x2030<TD>Reload the page
	    <TR><TD>STOP_LOADING                 <TD>0x2031<TD>Stop the page from loading
	    <TR><TD>HOME                         <TD>0x2032<TD>Load Home page
	    <TR><TD>PRINT                        <TD>0x2033<TD>Print the page at default size
	    <TR><TD>CLOSE                        <TD>0x2034<TD>Close the window
	    <TR><TD>MENU                         <TD>0x2035<TD>Open the menu
	    <TR><TD>FIND_AGAIN                   <TD>0x2036<TD>Repeat the last find command
	    <TR><TD>MENU_DEBUG                   <TD>0x2037<TD>Open the debug menu
	    <TR><TD>DBOX_CANCEL                  <TD>0x2038<TD>Cancel a dbox
	    <TR><TD>OPEN_URL                     <TD>0x2039<TD>Open the open URL window

	    <TR><TD>SEARCH_PAGE		    <TD>0x203C<TD>Load the home page
	    <TR><TD>OFFLINE_PAGE		    <TD>0x203D<TD>Load the offline page
	    <TR><TD>INFO_PAGE		    <TD>0x203E<TD>Open the info page
	    <TR><TD>SEND_URL			    <TD>0x203F<TD>Open a mailto URL with the current page URL as parameter

	    <TR><TD>COPY_IMAGE                   <TD>0x2040<TD>Copy current image to the clipboard
	    <TR><TD>COPY_TEXT                    <TD>0x2041<TD>Copy text of current page to the clipboard
	    <TR><TD>PASTE                        <TD>0x2042<TD>Paste clipboard contents at cursor
	    <TR><TD>PASTE_URL                    <TD>0x2043<TD>Paste current URl at cursor
	    <TR><TD>DELETE_TEXT                  <TD>0x2044<TD>unused

	    <TR><TD>SCROLL_LEFT                  <TD>0x2050<TD>Scroll left one character
	    <TR><TD>SCROLL_RIGHT                 <TD>0x2051<TD>Scroll right one character
	    <TR><TD>SCROLL_UP                    <TD>0x2052<TD>Scroll up one line
	    <TR><TD>SCROLL_DOWN                  <TD>0x2053<TD>Scroll down one line
	    <TR><TD>SCROLL_PAGE_UP               <TD>0x2054<TD>Scroll up one page
	    <TR><TD>SCROLL_PAGE_DOWN             <TD>0x2055<TD>Scroll down one page
	    <TR><TD>SCROLL_TOP                   <TD>0x2056<TD>Scroll to top of page
	    <TR><TD>SCROLL_BOTTOM                <TD>0x2057<TD>Scroll to bottom of page
	    <TR><TD>SCROLL_OR_CURSOR_UP          <TD>0x2058<TD>Move cursor up or scroll
	    <TR><TD>SCROLL_OR_CURSOR_DOWN        <TD>0x2059<TD>Move cursor down or scroll
	    <TR><TD>SCROLL_FAR_LEFT              <TD>0x205A<TD>Scroll left to limit
	    <TR><TD>SCROLL_FAR_RIGHT             <TD>0x205B<TD>Scroll right to limit
	    <TR><TD>SCROLL_PAGE_LEFT             <TD>0x205C<TD>Scroll left one page
	    <TR><TD>SCROLL_PAGE_RIGHT            <TD>0x205D<TD>Scroll right one page

	    <TR><TD>HIGHLIGHT_BACK               <TD>0x2060<TD>Move highlight left
	    <TR><TD>HIGHLIGHT_FORWARD            <TD>0x2061<TD>Move highlight right
	    <TR><TD>HIGHLIGHT_UP                 <TD>0x2062<TD>move highlight iup
	    <TR><TD>HIGHLIGHT_DOWN               <TD>0x2063<TD>Move highlight down
	    <TR><TD>HIGHLIGHT_REMOVE             <TD>0x2064<TD>unused
	    <TR><TD>HIGHLIGHT_ACTIVATE           <TD>0x2065<TD>Activate highlighted link
	    <TR><TD>HIGHLIGHT_PREV_FRAME         <TD>0x2066<TD>Move highlight to previous frame
	    <TR><TD>HIGHLIGHT_NEXT_FRAME         <TD>0x2067<TD>Move highlight to next frame
	    <TR><TD>HIGHLIGHT_FRAME_UP	    <TD>0x2068<TD>Move highlight to frame to left
	    <TR><TD>HIGHLIGHT_FRAME_DOWN         <TD>0x2069<TD>Move highlight to next frame downwards
	    <TR><TD>HIGHLIGHT_FRAME_LEFT	    <TD>0x206A<TD>Move highlight to frame to right
	    <TR><TD>HIGHLIGHT_FRAME_RIGHT        <TD>0x206B<TD>Move highlight to next frame upwards

	    <TR><TD>GIVE_FOCUS                   <TD>0x2070<TD>unused
	    <TR><TD>REMOVE_FOCUS                 <TD>0x2071<TD>unused

	    <TR><TD>OPEN_PRINT_OPTIONS           <TD>0x2080<TD>Open print setup page
	    <TR><TD>OPEN_FIND                    <TD>0x2081<TD>Open find page
	    <TR><TD>OPEN_DISPLAY_OPTIONS         <TD>0x2082<TD>Open display options page
	    <TR><TD>OPEN_KEYBOARD		    <TD>0x2083<TD>Open on screen keyboard
	    <TR><TD>OPEN_RELATED_STUFF	    <TD>0x2084<TD>Open related stuff page
	    <TR><TD>OPEN_FONT_SIZE		    <TD>0x2085<TD>Open font size set page
	    <TR><TD>OPEN_SOUND		    <TD>0x2086<TD>Open background sound control page
	    <TR><TD>OPEN_BEEPS		    <TD>0x2087<TD>Open sound effects control page
	    <TR><TD>OPEN_SCALING		    <TD>0x2088<TD>Open hostrizontal scaling control page

	    <TR><TD>STATUS_INFO_LEVEL            <TD>0x2090<TD>unused

	    <TR><TD>TOOLBAR_BASE		    <TD>0x20A0<BR>0x20AE<TD>Open toolbar <VAR>n</VAR>
	    <TR><TD>TOOLBAR_EXIT		    <TD>0x20AF<TD>Unstack window or toolbar or move back in history

	    <TR><TD>PRINT_LETTER		    <TD>0x20B0<TD>Print page at letter size
	    <TR><TD>PRINT_LEGAL		    <TD>0x20B1<TD>Print page at legal size
	    <TR><TD>OPEN_WRITEABLE		    <TD>0x20B2<TD>unused
	    <TR><TD>STOP_OR_RELOAD		    <TD>0x20B3<TD>Stop page if loading, reload if stopped
	    <TR><TD>SOUND_TOGGLE		    <TD>0x20B4<TD>Toggle background sound
	    <TR><TD>SOUND_ON			    <TD>0x20B5<TD>Enable background sound
	    <TR><TD>SOUND_OFF		    <TD>0x20B6<TD>Disable background sound
	    <TR><TD>BEEPS_TOGGLE		    <TD>0x20B7<TD>Toggle sound effects
	    <TR><TD>BEEPS_ON			    <TD>0x20B8<TD>Enable sound effects
	    <TR><TD>BEEPS_OFF		    <TD>0x20B9<TD>Disable sound effects
	    <TR><TD>SCALING_TOGGLE		    <TD>0x20BA<TD>Toggle horizontal scaling
	    <TR><TD>SCALING_ON		    <TD>0x20BB<TD>Enable horizontal scaling
	    <TR><TD>SCALING_OFF		    <TD>0x20BC<TD>Disable horizontal scaling

	    <TR><TD>CODEC_STOP		    <TD>0x20C0<TD>Send stop to codec control
	    <TR><TD>CODEC_PLAY		    <TD>0x20C1<TD>Send play to codec control
	    <TR><TD>CODEC_PAUSE		    <TD>0x20C2<TD>Send pause to codec control
	    <TR><TD>CODEC_REWIND		    <TD>0x20C3<TD>Send rewind to codec control
	    <TR><TD>CODEC_FAST_FORWARD	    <TD>0x20C4<TD>Send fast forward to codec control
	    <TR><TD>CODEC_RECORD		    <TD>0x20C5<TD>Send record to codec control
	    <TR><TD>CODEC_MUTE		    <TD>0x20C6<TD>Send mute to codec control
	    <TR><TD>CODEC_CLOSING		    <TD>0x20C7<TD>Codec toolbar is closing
	    <TR><TD>CODEC_STOP_PAGE		    <TD>0x20C8<TD>If page loading then stop it, else stop codec playing
	    <TR><TD>CODEC_OPENING		    <TD>0x20C9<TD>Codec toolbar is opening

	    <TR><TD>TOOLBAR_MOVE_LEFT	    <TD>0x20D0<TD>Move highlight left on toolbar
	    <TR><TD>TOOLBAR_MOVE_RIGHT	    <TD>0x20D1<TD>Move highlight right on toolbar
	    <TR><TD>TOOLBAR_MOVE_UP		    <TD>0x20D2<TD>Move highlight up on toolbar
	    <TR><TD>TOOLBAR_MOVE_DOWN	    <TD>0x20D3<TD>Move highlight left down toolbar
	    <TR><TD>TOOLBAR_ACTIVATE		    <TD>0x20D4<TD>Activate highlighted toolbar button
	    <TR><TD>TOOLBAR_PAGE_UP		    <TD>0x20D5<TD>Page up on toolbar
	    <TR><TD>TOOLBAR_PAGE_DOWN	    <TD>0x20D6<TD>Page down on tooolbar

	    <TR><TD>FRAME_LINK_LEFT		    <TD>0x20E0<TD>Move highlight left on frame link
	    <TR><TD>FRAME_LINK_RIGHT		    <TD>0x20E1<TD>Move highlight right on frame link
	    <TR><TD>FRAME_LINK_UP		    <TD>0x20E2<TD>Move highlight up on frame link
	    <TR><TD>FRAME_LINK_DOWN		    <TD>0x20E3<TD>Move highlight down on frame link
	    <TR><TD>FRAME_LINK_ACTIVATE	    <TD>0x20E4<TD>Activate frame link

	    <TR><TD>URLS_MASK	            <TD>0x2100<BR>0x21FF<TD>Load the URL <CODE>NCFresco$EventURLnn</CODE>

	    <TR><TD>ENCODING_MASK	            <TD>0x2200<BR>0x22FF<TD>Set encoding nn

	    <TR><TD>PLUGIN_TOGGLE		    <TD>0x6000<TD>Toggle plugin

	    <TR><TD>MENU_UP                       <TD>0x8001<TD>Move highlight on menu up
	    <TR><TD>MENU_DOWN                     <TD>0x8002<TD>Move highlight on menu down
	    <TR><TD>MENU_PAGE_UP                  <TD>0x8003<TD>Move highlight on menu one page up
	    <TR><TD>MENU_PAGE_DOWN                <TD>0x8004<TD>Move highlight on menu one page down
	    <TR><TD>MENU_TOP                      <TD>0x8005<TD>Move highlight on menu to top
	    <TR><TD>MENU_BOTTOM                   <TD>0x8006<TD>Move highlight on menu to bottom
	    <TR><TD>MENU_SELECT                   <TD>0x8007<TD>Activate highlight on menu
	    <TR><TD>MENU_CANCEL                   <TD>0x8008<TD>Cancel menu
	    <TR><TD>MENU_TOGGLE                   <TD>0x8009<TD>Togle highlight on current item

	    <TR><TD>MAP_MOVE                      <TD>0x9000<BR>0x900F<TD>Move cursor in given direction
	    <TR><TD>MAP_MOVE_LEFT                <TD>0x1<TD>
	    <TR><TD>MAP_MOVE_RIGHT               <TD>0x2<TD>
	    <TR><TD>MAP_MOVE_UP                  <TD>0x4<TD>
	    <TR><TD>MAP_MOVE_DOWN                <TD>0x8<TD>
	    <TR><TD>MAP_SELECT                    <TD>0x9010<TD>Select current point on map
	    <TR><TD>MAP_STOP                      <TD>0x9011<TD>Stop cursor moving
	    <TR><TD>MAP_CANCEL                    <TD>0x9012<TD>Cancel map mode
    </TABLE>

    <P>The following modifiers are available to the event codes. Add
    these value to the event code above.

    <TABLE BGCOLOR=grey80 CELLPADDING=4>
	<TR><TD><TD>0x1000<TD>Ensure event only affects whole
	window. Some events will affect just the frame without this.

	<TR><TD><TD>0x800<TD>Cause the top popup window to be closed
	before performing this function. Not available on all
	functions.
    </TABLE>

    <P>

    <h3>7.2 Toolbar mapping</H3>

    <P>The relationships and properties of the toolbars can now be
      specified by two new element in the Config file.

    <P>The format of these lines are as follows

    <TABLE BGCOLOR=grey80 CELLPADDING=4>
	<TR>
	  <TD><CODE>toolbar:</CODE>
	  <TD><i>id</i>
	  <TD><i>type</i>
	  <TD><i>entry event</i>
	  <TD><i>exit event</i>
	  <TD><i>initial component</i>
	  <TD><i>open component</i>
	  <TD><i>parent id</i>
	  <TD><i>parent component</i>
	<TR>
	  <TD><CODE>toolbar.name:</CODE>
	  <TD COLSPAN=8><i>name</i>
    </TABLE>

    <P>The <i>id</i> should be a number incrementing from 0. The toolbar
    Window object in the resource file is <CODE>T&lt;id&gt;</CODE>.

    <P>The toolbar <i>type</i> is as follows

    <TABLE BGCOLOR=grey80 CELLPADDING=4>
	<TR>
	  <TD>0
	  <TD>Standard
	  <TD>No special properties
	<TR>
	  <TD>1
	  <TD>Main
	  <TD>Only one can be main
	<TR>
	  <TD>2
	  <TD>Codecs	
	  <TD>This toolbar is opened when a codec starts playing.
    </TABLE>

    <P>The <i>entry event</i> and <i>exit event</i> specify the browser
    event codes of events to be triggered just before the toolbar is
    opened or closed.

    <P>The <i>initial component</i> is the component id of the component
    highlighted when the highlight is moved onto the toolbar from a
    web page.

    <P>The <i>open component</i> is the component id of the component
    highlighted when the highlight is moved onto the toolbar from a
    web page.

    <P>The <i>parent id</i> and <i>parent component</i> specify which
    toolbar and button should be opened and highlighted when this
    toolbar is closed. The special value <i>-1</i> for the <i>parent
    id</i> means that this toolbar stacks and when removed should
    display the previously displayed toolbar. To give no parent then
      make the <i>parent id</i> the same as the <i>toolbar id</i>.

    <P>The toolbar <i>name</i> is how the toolbar can be referred to
    when using the internal command to open a toolbar
    <code>ncfrescointernal:opentoolbar?name=<i>name</i></code>.
      The name Config line refers to the toolbar just defined.

    <h3>7.3 Colour configuration</H3>

    <P>The colours used for the various plinths and borders can now be
      configured. The config entry is given as a comma separated list of
      RGB colour values. The colour is given in RISC OS format as a
      single word, ie <TT>0xBBGGRR00</TT>.

    <P>The colours are used as follows
    <UL>
      <LI>There are 'n' colours specified, 'n' must be a divisible by
      2.

      <LI>The first 'n/2' colours are used for the top and left
	edges of the border, the second 'n/2' colours are used for the
	bottom and right edges.

      <LI>Each colour is used for one row of pixels starting from the
      outside.
    </UL>

    <P>So if a plinth was specified as A,B,C,D,E,F then it would have
      a 3 pixel wide border, the colours as follows.

    <TABLE WIDTH=200 CELLSPACING=0 ALIGN=CENTER>
	<TR><TD COLSPAN=7 ALIGN=CENTER BGCOLOR=grey90>A
	<TR><TD ROWSPAN=5 ALIGN=CENTER BGCOLOR=grey90>A<TD COLSPAN=5 ALIGN=CENTER BGCOLOR=grey85>B<TD ROWSPAN=5 ALIGN=CENTER BGCOLOR=grey75>D
	<TR><TD ROWSPAN=3 ALIGN=CENTER BGCOLOR=grey85>B<TD COLSPAN=3 ALIGN=CENTER BGCOLOR=grey80>C<TD ROWSPAN=3 ALIGN=CENTER BGCOLOR=grey65>E
	<TR><TD ALIGN=CENTER BGCOLOR=grey80>C<TD>&nbsp;<TD ALIGN=CENTER BGCOLOR=grey60>F
	<TR><TD COLSPAN=3 ALIGN=CENTER BGCOLOR=grey60>F
	<TR><TD COLSPAN=5 ALIGN=CENTER BGCOLOR=grey65>E
	<TR><TD COLSPAN=7 ALIGN=CENTER BGCOLOR=grey75>D
    </TABLE>

    <P>The border colours that can be configured are

    <TABLE BGCOLOR=grey80>
	<TR>
	  <TD><TT>colour.border.write</TT>
	  <TD>TEXTAREA, INPUT TYPE=TEXT, INPUT TYPE=PASSWD objects
	<TR>
	  <TD><TT>colour.border.write.highlight</TT>
	  <TD>TEXTAREA, INPUT TYPE=TEXT, INPUT TYPE=PASSWD objects when the
	    caret is present
	<TR>
	  <TD><TT>colour.border.select</TT>
	  <TD>SELECT objects 
	<TR>
	  <TD><TT>colour.border.select.highlight</TT>
	  <TD>SELECT objects when highlighted
	<TR>
	  <TD><TT>colour.border.button</TT>
	  <TD>INPUT TYPE=SUBMIT, INPUT TYPE=RESET, INPUT TYPE=BUTTON objects
	<TR>
	  <TD><TT>colour.border.button.highlight</TT>
	  <TD>INPUT TYPE=SUBMIT, INPUT TYPE=RESET, INPUT TYPE=BUTTON
	    objects when highlighted
	<TR>
	  <TD><TT>colour.border.bevel</TT>
	  <TD>3D bevel that divides frames
	<TR>
	  <TD><TT>colour.border.highlight</TT>
	  <TD>The highlight that is drawn around text and graphic links
	<TR>
	  <TD><TT>colour.border.activated</TT>
	  <TD>The highlight that is drawn around text and graphic
	    links when it is being clicked on
	<TR>
	  <TD><TT>colour.border.window</TT>
	  <TD>The border to non-scrollable popup window
    </TABLE>

    <H3>7.4 Launching URLs</H3>

    <P>A generic method of launching URLs from buttons is
      introduced. The event code range from 0x3100 to 0x31FF will
      launch a URL looked up from a system variable.

    <P>If the event code is <TT>0x31nn</TT> then the variable used is 
      <TT>NCFresco$EventURLnn</TT>.

    <P>e.g. To launch the Acorn home page from a button then set the
      button event code to 0x3100 and set a system variable as follows.
    <PRE>
Set NCFresco$EventURL00 http://www.acorn.com/
    </PRE>

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="external"> 8.0 External dependencies </a> </h2>

    <P>There are no external dependencies.

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="acceptance"> 9.0 Acceptance test </a> </h2>

    <P>The browser will support the required UI changes described in
      the CIS and will behave as described above.

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="noncompliances"> 10.0 Non compliances </a> </h2>

      <P>The following elements of the HTML 3.2 specification are not implemented.
	<DL>
	  <DT>LINK
	  <DD>This element is very rarely used.
	  <DT>INPUT TYPE=FILE
	  <DD>This element is for file upload over HTTP and is not
	    relevant to the NC as there is no local storage.
	</DL>

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="test"> 11.0 Development test strategy </a> </h2>

    <UL>
      <LI>Test pages will be created to test the new HTML introduced.
    </UL>

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="organisation"> 12.0 Product organisation </a> </h2>

    <P>The browser is built via a Solaris hosted cross-compiling
      version of ARM cc (Acorn port) v5.06. For ROM release a
      partially linked <TT>AOF</TT> file is created which is imported into
      the RISC&nbsp;OS build tree. The browser runs from ROM.

    <P>There are several support modules.
    <UL>
      <LI>HTTP transport
      <LI>FTP transport
      <LI>Gopher transport
      <LI>Resolver
    </UL>

    <P>These are all written in C and integrated into the build
      tree.

    <P>The SSLeay library that provides SSL support for the HTTP
      module is cross-compiled on Solaris and creates two ALF format
      files that are linked with the HTTP module in the main ROM build.

    <P>
      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="enhancements"> 13.0 Future enhancements </a> </h2>

    <P>Useful items would be 
    <UL>
      <LI>Continue configurability work by processing HTML files
      rather than building from snippets in the Message file.

      <LI>Rewrite highlight handling to not use the mouse position as
      a guide. This would clear a lot of existing problems.
    </UL>

    <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="glossary"> 14.0 Glossary </a> </h2>

    <TABLE WIDTH="100%" BORDER=0>
	<TR><TD>API	<TD>Application Programmer Interface.
	<TR><TD>Cache		<TD>Area of disk or memory used to
	    store recently accessed files.
	<TR><TD>Caret		<TD>Text cursor.
	<TR><TD>CIS		<TD>Customer Interface Specification.
	<TR><TD>Codec		<TD>COder-DECoder.
	<TR><TD>GIF		<TD>Graphics Interchange Format. A compressed image format.
	<TR><TD>FORM		<TD>An HTML element that allows the
	    user to make selections and enter text that is then sent
	    to a server.
	<TR><TD>Floating	<TD>In HTML, an attribute of an image
	    or table that causes following text or images to wrap
	    around the edge of the image rather than being displayed
	    after the floating object.
	<TR><TD>Frame		<TD>An independently scrollable
	    portion of an HTML page.
	<TR><TD>FTP		<TD>File Transfer Protocol.
	<TR><TD>History		<TD>A list of pages visited by the
	    user recently.
	<TR><TD>HTML		<TD>Hyper Text Markup Language.
	<TR><TD>HTML 3.2	<TD>The current base-line HTML standard.
	<TR><TD>HTTP		<TD>Hyper Text Transport Protocol.
	<TR><TD>Imagemap	<TD>An image where clicking on
	    different areas will launch different URLs.
	<TR><TD>IP		<TD>Internet Protocol.
	<TR><TD>JFIF		<TD>JPEG File Interchange
	    Format. Standard file format for most (bti not all) JPEG files.
	<TR><TD>JPEG		<TD>Joint Photographic Experts Group. A compressed image format.
	<TR><TD>MIDI		<TD>Musical Instrument DigitalInterface. Standard file format for score based music.
	<TR><TD>MIME		<TD>Multipurpose Internet Mail Extensions.
	<TR><TD>NC		<TD>Network Computer.
	<TR><TD>NTSC		<TD>TV standard used in the USA.
	<TR><TD>NVRAM		<TD>Non-volatile RAM. Maintains its
	    contents when power is off.
	<TR><TD>OS		<TD>Operating System.
	<TR><TD>PAL		<TD>TV standard used in Europe.
	<TR><TD>PDD		<TD>Product Definition Document.
	<TR><TD>Plugins		<TD>A program that
	    extends the browser by handling a particulat type of file
	    embedded in an HTML page.
	<TR><TD>PNG		<TD>Portable Network Graphic. A
	    compressed image format.
	<TR><TD>proxy		<TD>Computer that handles requests for
	    files on behalf of the NC, allowing the NC to have
	    communication with only one other machine.
	<TR><TD>RAM		<TD>Random Access Memory.
	<TR><TD>ROM		<TD>Read Only Memory.
	<TR><TD>Sprite		<TD>An Acorn proprietary bitmap
	    graphics file format.
	<TR><TD>SSL		<TD>Secure Sockets Layer.
	<TR><TD>SWI		<TD>Software Interrupt.
	<TR><TD>TCP		<TD>Terminal Connection Protocol.
	<TR><TD>UI		<TD>User Interface.
	<TR><TD>URL		<TD>Uniform Resource Locator.
	<TR><TD>WIMP		<TD>Window Manager.
	<TR><TD>W3C		<TD>World Wide Web Consortium. Closest thing 
	    to a useful standards body for web software.
    </TABLE>

    <P>

      <!-- ======================================================================= -->

    <hr  noshade>
    <h2> <a name="references"> 15.0 References </a> </h2>

    <P>The following external standards are referenced in this spec.

    <DL>

      <DT>[1] <A NAME="cis">CIS</A>
      <DD>Acorn Generic 2.00 Customer Interface Specification.

      <DT>[2] <A NAME="rca116" HREF="../../../1-16/specifications/apps/browser.html">
	  Browser Software Functional Specification [NC100 1.16]</A>
      <DD>Document ref: 2107,510/FS

      <DT>[3] <A NAME="rca115" HREF="../../../rca_nc100/software_docs/apps/browserrca.html">
	  Browser Software Functional Specification [NC100 1.15]</A>
      <DD>Document ref: 2107,702

      <DT>[4] <A NAME="model1" HREF="../../../rca_nc100/referenced_soft/apps/browser.html">
	  Browser Software Functional Specification [Model 1]</A>
      <DD>Document ref: 2103,702

      <DT>[5] <A NAME="html32" HREF="http://www.w3.org/TR/">HTML 3.2
	  Reference Specification</a>
      <DD>The base document for the NCBrowser HTML implementation.

      <DT>[6] <A NAME="html40" HREF="http://www.w3.org/TR/">HTML 4.0
	  Draft Specification</a>
      <DD>Specification of some advanced features.

      <DT>
    </DL>

    <P>

      <!-- ======================================================================= -->

    <hr>
    <h2> <a name="history"> 16.0 History </a> </h2>

    <PRE>
$Log$
Revision 2.1  1997/09/19 10:36:42  srose
SECTION: header
CHANGE:  amr 4820 allocated
REASON:  sign off

Revision 1.4  1997/09/12 16:25:53  smiddle
SECTION: 3.0
CHANGE:  Added favourites saving
REASON:  new feature
IMPACTS: none

Revision 1.3  1997/08/27 13:57:35  srose
SECTION: references
CHANGE:  model 1 browser url correction
REASON:  broken url link
IMPACTS: none

Revision 1.2  1997/08/22 10:44:55  smiddle
Expanded the technical information a little.

Revision 1.1  1997/08/21 14:47:58  smiddle
Spec created.


    </PRE>

    <hr>
    <P>

    <TABLE BORDER=1 WIDTH="100%">
	<TR>
	  <TD WIDTH="50%" VALIGN=TOP>
	    <SMALL>
	      This document is issued under license and must not be copied, reproduced
	      or disclosed in part or whole outside the terms of the license.
	    </SMALL>
	  <TD WIDTH="50%" VALIGN=TOP>
	    <SMALL>
	      &#169; Acorn Computers Ltd 1997
	    </SMALL>
    </TABLE>

    <HR>
    <!-- Created: Mon Aug 11 16:18:39 BST 1997 -->
    <!-- hhmts start -->
Last modified: Fri Sep 12 17:25:36 BST 1997
<!-- hhmts end -->
  </body>
</html>
