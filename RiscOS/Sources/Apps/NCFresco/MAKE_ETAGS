#!/bin/sh
trap "rm -f /tmp/$$" 0 1 2 3 15
rm -f ./TAGS
echo "Building TAGS file"
find `pwd`/ -type f -name '*.[chyl]' -print | \
  xargs etags --append --output=TAGS.tmp

# Due to my bad decision to mount /home on /usr/local/home
# and emacs cleverness about ~ and current directory.
echo "Filtering TAGS file"
sed -e s+/usr/local/homewibble+/home+ < ./TAGS.tmp > ./TAGS
rm ./TAGS.tmp

echo "Making TAGS symlinks"
find . -type d -print | \
while read DIR; do
  [ "$DIR" != "." ] && ln -f -s `pwd`/TAGS $DIR
done


