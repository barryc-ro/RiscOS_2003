//addresser - TFax address book
//The TFax address book is simply a list of telephone numbers known to
//Have NetFax devices attatched to them.  This allows TFax to dial up in
//data mode thus saving call time.    
//Nick Evans 12/11/97

#include <stdio.h>
#include <string.h>
#include <swis.h>

//array size defines the number of records stored
//500 numbers uses 14K of RAM

#define array_size 500

char array[array_size][30]; //this hold the list of numbers

void TFax_addr_init(void)
{
 int l; 
 //we must initialise the array
 //X means unused
 for (l=0;l<array_size;l++)  
   strcpy(array[l],"X");
}

//TFax_address_add
//adds a new adress to the list of numbers
//new numbers are always added to the top of the list
//if the number is already in the list it is moved to the top of the list
//this way the most commonly used numbers will stay in the list while
//unused  numbers will eventually drop off the end
       
void TFax_address_add(char* new_number)
{ 
 
 char temp[30];
 int l;
 
   //is number already in array?
   l=0;
   while((l<array_size) && (strcmp(array[l],new_number) !=0)) 
     l++;
   
   //number is not in array
   if (l == array_size)  
     {
       l--;
       while(l>=0)
         {
	   strcpy(array[l+1],array[l]);
	   l--;
	 }
       strcpy(array[0],new_number);	        
     } 
   //number is in array      
   else   
    {
      strcpy(temp,array[l]);
      l--;
      while(l>=0)
         {
	   strcpy(array[l+1],array[l]);
	   l--;
	 }
      strcpy(array[0],temp); 
    }
//     _swi(OS_Write0, _IN(0),4);  
//     printf("%s added to list\n",new_number);
//     for(l=0;l<array_size;l++) 
//     	printf("%s\n",array[l]);       
}

int TFax_addr_lookup(char* number)
{
   int l;
   l=0;
//   _swi(OS_Write0, _IN(0),4);  
   while((l<array_size) && (strcmp(array[l],number) !=0))
   { 
//     printf("%s\n",array[l]);
     l++;
   }   
   if(l==array_size)
     {
//       printf("Number not found-%s\n",number);
       return(0);
     }  
   else   //found the number !
     {
//      printf("found number - %s\n",number); 
      return(1);
     } 
}      
       
