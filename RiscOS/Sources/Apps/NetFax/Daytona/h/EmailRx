/* File:    emailrx.h
 * Purpose: Daytona email receive
 * Author:  Ben Laughton
 * History:
 *
 * 1997-10-22: BAL
 * Created.
 */

#ifndef daytona_emailrx_h
#define daytona_emailrx_h

#ifdef __cplusplus
extern "C" {
#endif

/* =============================================================================
 * Include header files
 */

/* Daytona */
#include "list.h"
#include "NFELib.h"




/* =============================================================================
 * Define constants
 */

#define MessageFlags_PartialDownload        (0x0000001)

enum
{
    EmailSupport_None,
    EmailSupport_Partial,
    EmailSupport_Full
};




/* =============================================================================
 * Define types
 */

typedef void *  document_handle;

typedef struct
{
    list_item_handle  item_handle;

    unsigned int      size;
    char *            unique_id;
    NFE_message_id    nf_message_id;


    unsigned int      flags;
    unsigned int      lines;    /* number of lines of message to download */
} message_t;




/* =============================================================================
 * Declare function prototypes
 */

extern int emailrx_initialise (void);

extern void emailrx_finalise (void);

extern int emailrx_new_message (const unsigned int        size,
                                const NFE_header *const   header,
                                const char *const         unique_id,
                                int *const                delete_message);

extern list_handle emailrx_build_dl_list (unsigned int free_space);

extern int emailrx_missing_page_report (
               const document_handle    document_info,
               char *const              local_report,
               char *const              remote_report,
               size_t                   local_report_size,
               size_t                   remote_report_size,
               const NFE_header *const  header);

extern int emailrx_cover_sheet (const document_handle    document_info,
                                char *const              report,
                                size_t                   report_size,
                                const NFE_header *const  header);

extern void emailrx_display_doc (document_handle document_info);

extern list_handle emailrx_get_doc_list (void);

extern list_handle emailrx_get_doc_msg_list (
                       const document_handle document_info);

extern int emailrx_check_supported (const NFE_msg_class     message_class,
                                    const NFE_NF_msg_class  nf_message_class);

extern char *emailrx_construct_full_address (const NFE_address *  address,
                                             const int            gs_trans);

#ifdef __cplusplus
}
#endif

#endif
