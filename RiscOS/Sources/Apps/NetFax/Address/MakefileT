CC =		cc
LD = 		Link
ASM =	 	ObjAsm
CMHG =	 	CMHG
WIPE =		-wipe
RM =		remove

CFLAGS =	-c -depend !Depend -Itbox:,C: -ffah -throwback
CFLAGS_D =      -c -depend !Depend -Itbox:,C: -DDEBUGLIB -fah -strict -throwback
CPPFLAGS = 	-c -depend !Depend -IC: -throwback
LDFLAGS	= 	-aif -c++
ASMFLAGS =	-throwback -NoCache -depend !Depend
CMHGFLAGS = 	-depend !Depend -throwback -IC:
WIPEFLAGS =	~C~V

DEBUGLIB =	<Lib$Dir>.Debuglib.o.Debuglib
MSGLIB =	<Lib$Dir>.MsgLib.o.MsgLib
FLASHLIB_T =	<Lib$Dir>.Netfax.FlashLib.o.flashlib_t
FLASHLIB =	<Lib$Dir>.Netfax.FlashLib.o.flashlib

TARGET =        Targets.Test
TARGET_D = 	Targets.TestT

OBJECTS =       o.test o.misc o.strings o.flash o.miscwimp o.numconvert

OBJECTS_D = 	od.test od.misc od.strings od.flash od.miscwimp od.numconvert

LIBS =          C:o.stubs tbox:o.eventlib tbox:o.toolboxlib \
tbox:o.wimplib $(MSGLIB) $(FLASHLIB)

LIBS_D =  	C:o.stubs tbox:o.eventlib tbox:o.toolboxlib \
tbox:o.wimplib $(DEBUGLIB) $(MSGLIB) TCPIPLibs:o.socklib5 \
TCPIPLibs:o.unixlib TCPIPLibs:o.inetlib $(FLASHLIB_T)

.SUFFIXES:	.o .c .od

o.test: test.c
	$(CC) $(CFLAGS) -o test.o test.c
od.test: test.c
	$(CC) $(CFLAGS_D) -o od.test test.c

all: $(TARGET_D) $(TARGET)

normal: $(TARGET)

debug: $(TARGET_D)

clean:
	$(RM)	$(TARGET_D)
	$(RM)   $(TARGET)
	$(WIPE)	o.test $(WIPEFLAGS)
	$(WIPE)	od.test $(WIPEFLAGS)

$(TARGET): $(OBJECTS) $(LIBS)
	$(LD) $(LDFLAGS) -o $@ $(OBJECTS) $(LIBS)

$(TARGET_D): $(OBJECTS_D) $(LIBS_D)
	$(LD) $(LDFLAGS) -o $@ $(OBJECTS_D) $(LIBS_D)


# Dynamic dependencies:
o.test:	c.test
o.test:	h.include
o.test:	C:h.swis
o.test:	C:h.kernel
o.test:	h.tbox
o.test:	tbox:h.event
o.test:	tbox:h.wimp
o.test:	tbox:h.toolbox
o.test:	tbox:h.toolbox
o.test:	tbox:h.window
o.test:	tbox:h.gadgets
o.test:	tbox:h.gadgets
o.test:	tbox:h.menu
o.test:	tbox:h.proginfo
o.test:	tbox:h.iconbar
o.test:	tbox:h.quit
o.test:	tbox:h.saveas
o.test:	tbox:h.wimplib
o.test:	C:msglib.h.MsgLib
o.test:	C:debuglib.h.DebugLib
o.test:	C:netfax.uilib.h.UILib
o.test:	h.state
o.test:	h.misc
o.test:	C:netfax.flashlib.h.flashlib
o.test:	h.strings
o.test:	h.flash
o.test:	h.globals
od.test:	c.test
od.test:	h.include
od.test:	C:h.swis
od.test:	C:h.kernel
od.test:	h.tbox
od.test:	tbox:h.event
od.test:	tbox:h.wimp
od.test:	tbox:h.toolbox
od.test:	tbox:h.toolbox
od.test:	tbox:h.window
od.test:	tbox:h.gadgets
od.test:	tbox:h.gadgets
od.test:	tbox:h.menu
od.test:	tbox:h.proginfo
od.test:	tbox:h.iconbar
od.test:	tbox:h.quit
od.test:	tbox:h.saveas
od.test:	tbox:h.wimplib
od.test:	C:msglib.h.MsgLib
od.test:	C:debuglib.h.DebugLib
od.test:	C:netfax.uilib.h.UILib
od.test:	h.state
od.test:	h.misc
od.test:	C:netfax.flashlib.h.flashlib
od.test:	h.strings
od.test:	h.flash
od.test:	h.globals
