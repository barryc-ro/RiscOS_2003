	GET	hdr.SWINames

	AREA	|C$$Code|, READONLY, CODE

buffer_len * 20

output_number
	EXPORT	output_number

	stmfd	sp!, {v1-r9, lr}

	mov	ip, sp
	mov	r8, a1

	mov	r0, #&CF
	adr	r1, filename
	mov	r2, #0
	swi	XOS_Find
	movvs	r0, #&8F
	swivs	XOS_Find
	ldmvsfd	sp!, {v1-r9, pc}^
	mov	r9, r0

	sub	sp, sp, #buffer_len
	mov	r1, sp
	mov	r0, r8
	mov	r2, #buffer_len - 5
	swi	XOS_BinaryToDecimal
	addvs	sp, sp, #buffer_len
	ldmvsfd	sp!, {v1-r9, pc}^
	mov	r0, #10
	add	r7, r2, #1
	strb	r0, [r1, r2]

	mov	r1, r9
	mov	r0, #2
	swi	XOS_Args

	mov	r4, r2
	mov	r0, #1
	mov	r1, r9
	mov	r2, sp
	mov	r3, r7
	swi	XOS_GBPB

	mov	r1, r9
	mov	r0, #0
	swi	XOS_Find

	add	sp, sp, #buffer_len
	mov	r0, #0
	ldmfd	sp!, {v1-r9, pc}^

; extern _kernel_oserror *output_string(const char *txt, unsigned int len)
output_string
	EXPORT	output_string

	stmfd	sp!, {v1-r9, lr}

	mov	r7, r1
	mov	r8, r0

	mov	r0, #&CF
	adr	r1, filename
	mov	r2, #0
	swi	XOS_Find
	movvs	r0, #&8F
	swivs	XOS_Find
	ldmvsfd	sp!, {v1-r9, pc}^
        mov	r9, r0

	mov	r1, r9
	mov	r0, #2
	swi	XOS_Args

	mov	r4, r2
	mov	r0, #1
	mov	r1, r9
	mov	r2, r8
	mov	r3, r7
	swi	XOS_GBPB

	mov	r1, r9

	mov	r0, #10
	swi	XOS_BPut

	mov	r0, #0
	swi	XOS_Find

	mov	r0, #0
	ldmfd	sp!, {v1-r9, pc}^

filename
	DCB	"adfs::4.$.erk", 0

	END
