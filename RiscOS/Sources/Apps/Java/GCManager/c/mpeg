#include <stdlib.h>

#include "kernel.h"
#include "swis.h"
#include "wimp.h"

#include "GCManager.h"
#include "task.h"

/* MPEG colour selection is in s.utils */
unsigned int mpeg_colour = 0xf000;
unsigned int mpeg_rgb = 0xe0000000;

/* takes a 24bpp colour */
_kernel_oserror *set_mpeg_colour(unsigned int rgb)
{
    _kernel_oserror *e;

    mpeg_rgb = rgb;

    if (rgb == 0xffffffff)
    {
        return NULL;
    }

    if (screen_depth_log2bpp == 2) /* 4bpp - macrovision mode */
    {
        mpeg_colour = 8;
        return NULL;
    }

    e = _swix(ColourTrans_ReturnColourNumberForMode, _INR(0,2)|_OUT(0),
    		rgb, -1, -1, &mpeg_colour);

    if (e == NULL)
        mpeg_colour |= 0x8000;

    return e;
}
