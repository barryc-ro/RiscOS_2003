
typedef struct _task Task;

#include "op.h"

#include "memheap.h"

#define malloc(x) MemHeap_malloc(x)
#define calloc(x, y) MemHeap_calloc(x, y)
#define free(x) MemHeap_free(x)

#define MAX_QUEUED_OPS     100

extern const int *current_task;
extern unsigned int screen_depth_log2bpp;

struct _task
{
    int          handle;
    GC           *gc_list;
    int          no_ops;
    Op           op_list[MAX_QUEUED_OPS];
    struct _task *next;
};

_kernel_oserror *add_task(int task_handle, Task **task_p);
int              get_current_task(void);
void             delete_all_tasks(void);
void             delete_task(int task_handle);
Task            *find_task(int task_handle);
void             flush_queue(Task *task);
_kernel_oserror *flush(void);
