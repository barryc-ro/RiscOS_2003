/*
 *  CTS (ctsbrowser.c)
 *
 * Copyright (C) Element 14 Ltd. 1999
 *
 */

#include <stdio.h>
#include "plugclient.h"
#include "ctstypes.h"
#include "ctsbrowser.h"


/* The URL prefix string for the URLs recognised by this plugin */
const char url_prefix[] = "cts:";


/* These strings are the command parts of the cts: URLs that we are
 * going to embed in the HTML we send to the browser for display
 */

const char urlcmd_start[] = "start";
const char urlcmd_ok[] = "action.ok";
const char urlcmd_cancel[] = "action.cancel";


/* The tag name strings that we recognise - used for parsing and debugging */
const char *ctstag_strings[tag__MAX] = {
        "",
        "Service",
        "Seq",
        "Cmd" ,
        "URL",
        "Sts",
        "Port",
        "APDUn",
        "Msg",
        "KeyID",
        "PassMIN",
        "PassMAX",
        "PassKind",
        "User",
        "Password",
        "Other"
};

/* These values were taken from the CTS specification */
const cts_tag_characteristics tag_characteristics[tag__MAX] = {
        /* Tag */   /* Min /  Max Data */
        { tag__ZERO 			},
        { tag_SERVICE,	0,	16 	},
        { tag_SEQ,	4,	4	},
        { tag_CMD,	1,	8	},
        { tag_URL,	1,	256	},
        { tag_STS,	2,	2	},
        { tag_PORT,	1,	1	},
        { tag_APDU,	0,	4096	},
        { tag_MSG,	0,	8	},
        { tag_KEYID,	2,	2	},
        { tag_PASSMIN,	2,	2	},
        { tag_PASSMAX,	2,	2	},
        { tag_PASSKIND,	1,	1	},
        { tag_USER,	0,	256	}, /* Limits missing in spec */
        { tag_PASSWORD,	0,	256	}, /* Limits missing in spec */
        { tag_OTHER,	0,	128	},
};

/* These are the known values for the Cmd tags - for parsing and debugging */
const char *ctscmd_strings[cmd__MAX] = {
        "*Unknown*",
        "Start",
        "Open",
        "Verify",
        "Change",
        "APDU",
        "Text",
        "ADPUT",
        "Close",
        "Err",
        "Basic"
};

/* Dialogue box window target name for plugin protocol usage */
const char dbox_target[] = "_dbox_ctsplugin";

/* Dialogue box filename template */
const char dbox_resource_files[] = "<CTSPlugin$Dir>.WebPages";
