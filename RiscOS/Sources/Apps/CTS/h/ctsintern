/*
 *  CTS (ctsintern.h)
 *
 * Copyright (C) Element 14 Ltd. 1999
 *
 */
#ifndef ctsintern_h_included
#define ctsintern_h_included

#ifdef __cplusplus
extern "C" {
#endif

/* This header declares the APIs between the different subsystems of the
 * plugin.  It declares the calls through which messages are passed from
 * one place to another.  It also declares any passed callback function
 * types.
 */

typedef enum {
        bdr_FREE,
        bdr_KEEP
} browser_dispatch_result;

extern browser_dispatch_result cts_statetable_dispatch_browser_message(
	cts_browser_message *);

extern browser_dispatch_result cts_statetable_dispatch_server_message(
	cts_server_message *);

/* A validation routine to verify that the APDU tags are all present and correct.
 * Returns the number of APDU tags found, or -1 if blocks were missing.
 */
extern int cts_server_message_validate_apdus(const cts_server_message *);

/* Locates the specified APDUn tag parameter */
extern const cts_command_parameter *cts_server_message_find_apdu(
	const cts_server_message *,
	int);


extern _kernel_oserror *cts_statetable_init (void);

/* Finding parameters */
extern cts_browser_parameter *cts_browser_parameter_lookup(
	cts_browser_message *,
	const char *);

extern cts_command_parameter *cts_command_parameter_lookup(
	cts_server_message *,
	const char *);

extern cts_command_parameter *cts_command_parameter_lookup_by_tag(
	cts_server_message *,
	cts_tags);

extern cts_commands cts_command_decode_command(cts_server_message *);


#ifdef __cplusplus
}
#endif

#endif
