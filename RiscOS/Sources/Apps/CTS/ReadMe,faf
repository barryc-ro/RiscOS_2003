<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>Notes on Chip To Server Speed</title>
</head>
<body lang=EN-GB TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000ff">
<h1>Notes on Chip To Server Speed</h1>

<i>Paul Skirrow, Fri 3rd March 2000</i><br>

<h2>Introduction</h2>
Funai are very concerned about the time taken by authentication as their
competitors are significantly faster. Authentication typically involves 6
transactions between the server and the SmartCard, and optionally a user
entering a password.<P>

On the Funai 4 modem NC this tranasaction time was originally around 16.5s
for a typical authentication. This was reduced to to around 13s
by just showing one status message instead of switching between
"Communicating with server" and "Accessing Smart card".<P>

The authentication is quite complex. The CTS application uses the Internet
stack to talk to the server and the Smart Card stack to access the smart
card, both of which are highly complex.<P>

However, the authentication still takes a surprising amount of time, and
examining the debug log below shows that there is at least a 1s delay on
each transaction and sometimes as much as 1.5 or 2s.<P>

<h2>Faster Authentication</h2>
The Funai 5 Ethernet NC is typically 6s faster than the modem NC at
authentication (ie 1s per transaction faster).<P>

A simple ping to the modem NC takes at least 250ms, and a CTS server
transaction opens a new stream which will require several ICMP messages
between the NC and the server.<P>

There may be several ways to speed this up:

<ol>
<li>Use the Transaction socket option when opening the server stream as this
reduces the number of messages needed to open the stream. This is
supported in Internet 5 but hasn't been used before. It would need to be
added into Fresco as it is responsible for opening the streams.
Unfortunately this socket option is not supported by all operating
systems, so although it will work with all servers only some will give a
performance gain.
<li>Improve the modem latency. Kevin Bracey suggests that we kick the main
poll routine more often to wake it up from an interrupt routine.
</ol>

There are several tests to try to to see what kind of performance gain we can expect:

<ol>
<li>Try a ping test on a Lazarus box (which uses a standard modem)
<li>Try running an authentication test in a Twin slot NC with a hardware modem (if we have one)
<li>Try a ping on a standard modem connected to a Risc PC.
</ol>

I would expect to save around 4 or 5s off the authentication time.<P>


<h2>Timing Test Results</h2>
This test was done by soft-loading the CTS application from a Zip disc
using the Funai 4 Alpha 11 release. The Export.Lib.DebugLib.h.DebugLib 
file was modified to make every debug message include the time:<P>
<code>
  #define dprintf(a)  {_dprintf ("Time ", "%d:", (int) clock()); _dprintf a;}
</code>
<P>

The debug output was directed to a TCPIP stream on a remote server and
this will add some delays to the execution.

Most of the time is spent waiting for the browser to respond to a URL
request. This will obviously take some time. We send a Wimp message to the
browser, it sends a HTTP GET to the server via the Internet stack and when
it receives a reply it sends a Wimp message to us with the data.

What is perhaps a little surprising is the time taken by the browser to respond:

<table>
<tr><td>Test 1:</td><td>220</td><td>106</td><td>211</td><td>106</td><td>151</td><td>107</td><td></td>
<tr><td>Test 2:</td><td>206</td><td>206</td><td>105</td><td>112</td><td>108</td><td>157</td><td></td>
<tr><td>Test 3:</td><td>150</td><td>106</td><td>109</td><td>109</td><td>109</td><td>153</td><td></td>
<tr><td>Test 4:</td><td>142</td><td>131</td><td>129</td><td>109</td><td>108</td><td>151</td><td><- Big debug window used</td>
<tr><td>Test 5:</td><td>141</td><td>128</td><td>128</td><td>107</td><td>125</td><td>145</td><td><- Big debug window used</td>
<tr><td>Test 6:</td><td>200</td><td>105</td><td>118</td><td>106</td><td>154</td><td>107</td><td></td>
<tr><td>Test 7:</td><td>139</td><td>105</td><td>125</td><td>106</td><td>154</td><td>107</td><td></td>
<tr><td>Test 8:</td><td>162</td><td>127</td><td>107</td><td>107</td><td>155</td><td>127</td><td></td>
</table>
    
All timings are in cs. Each test shows the time the browser took to
respond to each of the 6 CTS request messages, when performing a basic
authentication test on slot 2. The first value in each test is less
relevant as it is for a different operation.<P>

There will inevitably be some random variation caused by network delays etc,
and the two marked lines should perhaps be discounted as a large debug
window was open during these tests.<P>

What is surprising about the timings is that most of them are an exact
multiple of 50cs plus a small amount (usually 5-12cs). Each column
represents the time taken to perform the same operation within each test,
but instead of a random spread there is often a quantum step of 50cs.<P>

Note the last column is generally 107 or 151-157, while the second and
third column times are generally 105-125, except when they jumps to 206
or 211.<P>

This suggests that something is only polling for messages every 50cs or
only performing a certain action when a timer expires. I suspect this is
the controllerless modem software or, possibly, the PPP module.<P>

Note that the above timings show that roughly 8s of an authentication
process is spent waiting for Fresco. If we could reduce each request by
50cs, we would save 3s on the total authentication time.<P>

<h2>Test 1 Debug Log</h2>
<pre>CTSPlugin:
CTSPlugin: ***** Debug Session Started **************************************
CTSPlugin: DebugLib is (c) Pace Micro Technology plc. 1997-1999
CTSPlugin: System: DebugLib 0.47
CTSPlugin:         remotedb 0.07
CTSPlugin:         PDebug 0.03
CTSPlugin: Task:   CTSPlugin
CTSPlugin: Time:   Fri Jan  2 09:02:00 1970
CTSPlugin: Levels:
CTSPlugin: ******************************************************************
CTSPlugin: 61:*** New CTSPlugin 0.64 (14 Dec 1999)  started
CTSPlugin: 63:arg(1)='-timeout'
CTSPlugin: 63:process_args result: file="<null>", timeout=1
CTSPlugin: 84:SM> Base - Initialising (moving to Idle state)
CTSPlugin: 86:About to open a channel onto slot1
CTSPlugin: 86:Channel opened. Card handle=2. Now reading the ATR
CTSPlugin: 86:RetrieveATR returned 0. Now we lock the channel for the duration.
CTSPlugin: 87:Channel locked. Returned 0
CTSPlugin: 87:Entering poll loop
CTSPlugin: 87:pollword handler entered with 1 events in queue
CTSPlugin: 88:Event 0 card 2 (need 0) (reason 4, handle 0)
CTSPlugin: 89:read_response_available now = 1
CTSPlugin: 89:Poll: 13
CTSPlugin: 89:Poll: 17
CTSPlugin: 90:(Message 000400c3)
CTSPlugin: 92:plugin_open_handler entered
CTSPlugin: 92:parse_parameter_file(): instance 0000ae98 '<Wimp$ScrapDir>.01d0860
0' length 248
CTSPlugin: 95:param: type 4
CTSPlugin: 95:param: string size 60
CTSPlugin: 95:param: 'BASEHREF' 'http://136.170.33.128/Authenticate.htm' '<null>
'
CTSPlugin: 96:param: skip to 68
CTSPlugin: 96:param: type 4
CTSPlugin: 96:param: string size 32
CTSPlugin: 97:param: 'USERAGENT' 'NCFresco' '<null>'
CTSPlugin: 98:param: skip to 108
CTSPlugin: 98:param: type 4
CTSPlugin: 98:param: string size 28
CTSPlugin: 99:param: 'UAVERSION' '2.04' '<null>'
CTSPlugin: 99:param: skip to 144
CTSPlugin: 99:param: type 4
CTSPlugin: 100:param: string size 28
CTSPlugin: 101:param: 'APIVERSION' '1.10' '<null>'
CTSPlugin: 101:param: skip to 180
CTSPlugin: 101:param: type 5
CTSPlugin: 102:param: string size 24
CTSPlugin: 102:param: 'HEIGHT' '0' '<null>'
CTSPlugin: 102:param: skip to 212
CTSPlugin: 103:param: type 5
CTSPlugin: 104:param: string size 24
CTSPlugin: 104:param: 'WIDTH' '0' '<null>'
CTSPlugin: 104:param: skip to 244
CTSPlugin: 105:param: type 0
CTSPlugin: 105:Calling client_open()
CTSPlugin: 106:client_cts_open()
CTSPlugin: 106:pluginclient_param_lookup(): instance 0000ae98 name RemoteLog mas
k ffffffff case 0
CTSPlugin: 107:Name=`WIDTH' value=`0'
CTSPlugin: 107:Name=`HEIGHT' value=`0'
CTSPlugin: 107:Name=`APIVERSION' value=`1.10'
CTSPlugin: 108:Name=`UAVERSION' value=`2.04'
CTSPlugin: 108:Name=`USERAGENT' value=`NCFresco'
CTSPlugin: 108:Name=`BASEHREF' value=`http://136.170.33.128/Authenticate.htm'
CTSPlugin: 109:pluginclient_param_lookup(): returns ''
CTSPlugin: 110:process_tag_params(): REMOTELOG: <<NULL>>
CTSPlugin: 110:client_cts_open returns
CTSPlugin: 110:open_child_window(): plugin 0000ae98 subwindow 1
CTSPlugin: 111:add_window_handlers: id 08003018
CTSPlugin: 111:Poll: 18
CTSPlugin: 112:(Message 0004d541)
CTSPlugin: 116:plugin_reshape_handler(): plugin 0000ae98
CTSPlugin: 116:open_child_window(): plugin 0000ae98 subwindow 1
CTSPlugin: 117:Poll: 18
CTSPlugin: 117:(Message 0004d544)

Plug in is starting

CTSPlugin: 241:Message &4AF80 arrives for URL cts:start?Service=Authenticate&Seq
=1&Cmd=Start&URL=http://acn.eng.cam.pace.co.uk/cgi-bin/Auth.cgi
CTSPlugin: 241:client_cts_submit: browser button activated
CTSPlugin: 242:Browser parameter `Service'; value `Authenticate':
CTSPlugin: 0000: 41 75 74 68 65 6e 74 69 63 61 74 65             : Authenticate

CTSPlugin: 242:Browser parameter `Seq'; value `1':
CTSPlugin: 0000: 31                                              : 1

CTSPlugin: 243:Browser parameter `Cmd'; value `Start':
CTSPlugin: 0000: 53 74 61 72 74                                  : Start

CTSPlugin: 243:Browser parameter `URL'; value `http://acn.eng.cam.pace.co.uk/cgi
-bin/Auth.cgi':
CTSPlugin: 0000: 68 74 74 70 3a 2f 2f 61 63 6e 2e 65 6e 67 2e 63 : http://acn.en
g.c
CTSPlugin: 0010: 61 6d 2e 70 61 63 65 2e 63 6f 2e 75 6b 2f 63 67 : am.pace.co.uk
/cg
CTSPlugin: 0020: 69 2d 62 69 6e 2f 41 75 74 68 2e 63 67 69       : i-bin/Auth.cg
i
CTSPlugin: 245:
CTSPlugin: cts_statetable_dispatch_browser_message:
CTSPlugin: 245:  command is start
CTSPlugin: 245:    Parameter: `URL' = `http://acn.eng.cam.pace.co.uk/cgi-bin/Aut
h.cgi'
CTSPlugin: 246:    Parameter: `Cmd' = `Start'
CTSPlugin: 246:    Parameter: `Seq' = `1'
CTSPlugin: 246:    Parameter: `Service' = `Authenticate'
CTSPlugin: 247:end of message
CTSPlugin:
CTSPlugin: 247:SM> Base - Moving to "Started" state
CTSPlugin: 248:SM> Started - Initialising (moving to Idle state)
CTSPlugin: 248:cts_ui_open_dbox: request to open dbox `01-1' (01-1: Talking to s
erver (01-1))
CTSPlugin: 263:Substitution for `ENGLISHTEXT'
CTSPlugin: 264:Sending message to open dialogue box
CTSPlugin: 264:(1) pluginclient_browser_access_url: `file:/Cache:$/ScrapDir/x01d
08a00' on `__dbox_ctsplugin'
CTSPlugin: 265:(2) pluginclient_browser_access_url: `file:/Cache:$/ScrapDir/x01d
08a00' on `__dbox_ctsplugin'
CTSPlugin: 266:send_message(000089f4, 0000ae98) [0000ae98] (local variable at 00
0089d0)
CTSPlugin: 266:Sending message to browser
CTSPlugin: 266:(3) send message has returned
CTSPlugin: 267:SM> ******** Send "start" result, "http://acn.eng.cam.pace.co.uk/
cgi-bin/Auth.cgi?Service=Authenticate&Seq=1&Cmd=Start"
CTSPlugin: 267:(1) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co.
uk/cgi-bin/Auth.cgi?Service=Authenticate&Seq=1&Cmd=Start' on `<null>'
CTSPlugin: 268:Temporary filename is `Cache:$.ScrapDir.x01d08a01'
CTSPlugin: 272:(2) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co.
uk/cgi-bin/Auth.cgi' on `<null>'
CTSPlugin: 273:send_message(00008ab0, 0000ae98) [0000ae98] (local variable at 00
008a8c)
CTSPlugin: 273:Sending message to browser
CTSPlugin: 274:(3) send message has returned
CTSPlugin: 274:SM> Base - Changed state from 0 to 1
CTSPlugin: 274:Poll: 18
CTSPlugin: 275:(Message 0004af80)

*** Plug in has requested a URL. Browser takes 220cs to respond:

CTSPlugin: 495:plugin_stream_new(): flags 00000000
CTSPlugin: 495:client_cts_stream_new(): instance 0000ace8
CTSPlugin: 495:Poll: 18
CTSPlugin: 496:(Message 0004d548)
CTSPlugin: 498:Parsing a received server message
CTSPlugin: 498:
CTSPlugin: cts_statetable_dispatch_server_message:
CTSPlugin: 499:    Parameter: `Service' = `Authenticate'
CTSPlugin: 499:    Parameter: `Seq' = `2'
CTSPlugin: 499:    Parameter: `Cmd' = `Open'
CTSPlugin: 500:    Parameter: `URL' = `http://acn.eng.cam.pace.co.uk/cgi-bin/Aut
h.cgi'
CTSPlugin: 500:    Parameter: `Port' = `2'
CTSPlugin: 500:end of message
CTSPlugin:
CTSPlugin: 501:The command is `Open'
CTSPlugin: 501:log_send_msg
CTSPlugin: 501:SM> Started - Received server message, command = "2"
CTSPlugin: 502:SM> Started - Received "Open" command.
CTSPlugin: 502:port = "2"
CTSPlugin: 502:SM> Started - Changed state from 0 to 1
CTSPlugin: 503:Poll: 18
CTSPlugin: 503:(Message 0004d54c)
CTSPlugin: 504:Received message from browser to destroy stream
CTSPlugin: 504:client_cts_stream_destroy(): instance 0000ace8; reason 0
CTSPlugin: 504:Poll: 18
CTSPlugin: 505:(Message 0004d549)
CTSPlugin: 505:Opening new card (slot id 2)
CTSPlugin: 506:Slot 2
CTSPlugin: 506:There are 2 slots
CTSPlugin: 506:res_status = 3
CTSPlugin: 506:card type = 1
CTSPlugin: 507:SM> Started - Smart card open operation complete
CTSPlugin: 508:SM> Started - It's an STD_X card, need to send an S block
CTSPlugin: 508:Send s-block to smartcard
CTSPlugin: 0000: fe                                              : þ

CTSPlugin: 509:SWI 4d403 (SCTransport_IssueCommand)
CTSPlugin: 509: In:
CTSPlugin: 510:  R0 =       -2 (fffffffe)
CTSPlugin: 510:  R1 =        0 (00000000)
CTSPlugin: 510:  R2 =        1 (00000001)
CTSPlugin: 510:  R3 =    35864 (00008c18)
CTSPlugin: 512:  R4 =        0 (00000000)
CTSPlugin: 512: Out:
CTSPlugin: 512:Kernel error -> 00000000
CTSPlugin: 513:SC error -> 00000000
CTSPlugin: 513:SM> Started - Changed state from 1 to 2
CTSPlugin: 528:pollword handler entered with 1 events in queue
CTSPlugin: 528:Event 0 card 65535 (need -2) (reason 10, handle 35454959)
CTSPlugin: 529:Event reason code = 10
CTSPlugin: 529:read_response_available now = 1
CTSPlugin: 530:Poll: 13
CTSPlugin: 530:SWI 4d404 (SCTransport_ReadResponse)
CTSPlugin: 530: In:
CTSPlugin: 531:  R0 =       -2 (fffffffe)
CTSPlugin: 531:  R1 = 36226660 (0228c664)
CTSPlugin: 531:  R2 =     4096 (00001000)
CTSPlugin: 532:  R3 =    35864 (00008c18)
CTSPlugin: 532:  R4 = 36223996 (0228bbfc)
CTSPlugin: 533: Out:
CTSPlugin: 533:Kernel error -> 00000000
CTSPlugin: 533:SC error -> 00000000
CTSPlugin: 533:ReadResponse returned size=-2
CTSPlugin: 534:[read size call] data_size = -2; res=0; err=0
CTSPlugin: 534:[SW1:SW2] == [1d:02]; data_size = 0; res=0; err=0
CTSPlugin: 534:Adding [1d:02] at offset 0 in buffer
CTSPlugin: 535:Encoded response is 1D02
CTSPlugin: 535:SM> Started - Got response from S block send, continue...
CTSPlugin: 536:SM> ******** Send "open" result, "http://acn.eng.cam.pace.co.uk/c
gi-bin/Auth.cgi?Service=Authenticate&Seq=2&Cmd=Open&Sts=00"
CTSPlugin: 536:(1) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co.
uk/cgi-bin/Auth.cgi?Service=Authenticate&Seq=2&Cmd=Open&Sts=00' on `<null>'
CTSPlugin: 537:Temporary filename is `Cache:$.ScrapDir.x01d08c02'
CTSPlugin: 543:(2) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co.
uk/cgi-bin/Auth.cgi' on `<null>'
CTSPlugin: 543:send_message(00008ab8, 0000ae98) [0000ae98] (local variable at 00
008a94)
CTSPlugin: 543:Sending message to browser
CTSPlugin: 544:(3) send message has returned
CTSPlugin: 545:SM> Open - Initialising (moving to Idle state)
CTSPlugin: 545:SM> Started - Changed state from 2 to 4

*** Plug in has requested a URL. Browser takes 106cs to respond:

CTSPlugin: 651:plugin_stream_new(): flags 00000000
CTSPlugin: 651:client_cts_stream_new(): instance 0000ace8
CTSPlugin: 651:Poll: 18
CTSPlugin: 652:(Message 0004d548)
CTSPlugin: 654:Parsing a received server message
CTSPlugin: 654:
CTSPlugin: cts_statetable_dispatch_server_message:
CTSPlugin: 655:    Parameter: `Service' = `Authenticate'
CTSPlugin: 655:    Parameter: `Seq' = `3'
CTSPlugin: 656:    Parameter: `Cmd' = `APDU'
CTSPlugin: 656:    Parameter: `URL' = `http://acn.eng.cam.pace.co.uk/cgi-bin/Aut
h.cgi'
CTSPlugin: 656:    Parameter: `Script' = `GetCardIdChallenge.sct'
CTSPlugin: 657:    Parameter: `ScriptSeq' = `1'
CTSPlugin: 657:    Parameter: `APDU1' = `00A4040C0753657276696365'
CTSPlugin: 657:    Parameter: `APDU2' = `00B089000C'
CTSPlugin: 657:end of message
CTSPlugin:
CTSPlugin: 658:The command is `APDU'
CTSPlugin: 659:log_send_msg
CTSPlugin: 659:APDU count = 2
CTSPlugin: 659:SM> APDU - Initialising (moving to ReceiveResponse state)
CTSPlugin: 660:Sending APDU ... (length = 12)
CTSPlugin: 0000: 00 a4 04 0c 07 53 65 72 76 69 63 65             : . ...Service

CTSPlugin: 660:APDU contains Hdr Lc(0x7) Data
CTSPlugin: 660:APDU Header:
CTSPlugin: 0000: 00 a4 04 0c                                     : . ..

CTSPlugin: 661:Lc = 0x7
CTSPlugin: APDU Data:
CTSPlugin: 0000: 53 65 72 76 69 63 65                            : Service

CTSPlugin: 662:Le = 0x0
CTSPlugin: 663:SWI 4d403 (SCTransport_IssueCommand)
CTSPlugin: 663: In:
CTSPlugin: 663:  R0 =       -2 (fffffffe)
CTSPlugin: 665:  R1 =    38487 (00009657)
CTSPlugin: 665:  R2 =        7 (00000007)
CTSPlugin: 665:  R3 =    38492 (0000965c)
CTSPlugin: 666:  R4 =        0 (00000000)
CTSPlugin: 666: Out:
CTSPlugin: 667:Kernel error -> 00000000
CTSPlugin: 668:SC error -> 00000000
CTSPlugin: 668:SM> Open - Changed state from 0 to 2
CTSPlugin: 668:Poll: 18
CTSPlugin: 669:(Message 0004d54c)
CTSPlugin: 669:Received message from browser to destroy stream
CTSPlugin: 671:client_cts_stream_destroy(): instance 0000ace8; reason 0
CTSPlugin: 671:Poll: 18
CTSPlugin: 671:(Message 0004d549)
CTSPlugin: 685:pollword handler entered with 1 events in queue
CTSPlugin: 685:Event 0 card 65535 (need -2) (reason 10, handle 35450268)
CTSPlugin: 686:Event reason code = 10
CTSPlugin: 686:read_response_available now = 1
CTSPlugin: 686:Poll: 13
CTSPlugin: 687:SWI 4d404 (SCTransport_ReadResponse)
CTSPlugin: 687: In:
CTSPlugin: 687:  R0 =       -2 (fffffffe)
CTSPlugin: 688:  R1 = 36226660 (0228c664)
CTSPlugin: 688:  R2 =     4096 (00001000)
CTSPlugin: 689:  R3 =    35780 (00008bc4)
CTSPlugin: 689:  R4 = 36223996 (0228bbfc)
CTSPlugin: 689: Out:
CTSPlugin: 690:Kernel error -> 00000000
CTSPlugin: 690:SC error -> 00000000
CTSPlugin: 690:ReadResponse returned size=0
CTSPlugin: 691:[read size call] data_size = 0; res=0; err=0
CTSPlugin: 691:[SW1:SW2] == [90:00]; data_size = 0; res=0; err=0
CTSPlugin: 691:Adding [90:00] at offset 0 in buffer
CTSPlugin: 692:Encoded response is 9000
CTSPlugin: 692:Sending APDU ... (length = 5)
CTSPlugin: 0000: 00 b0 89 00 0c                                  : .°..

CTSPlugin: 693:APDU contains Hdr Le(0x8000000c)
CTSPlugin: 693:APDU Header:
CTSPlugin: 0000: 00 b0 89 00                                     : .°.

CTSPlugin: 694:Lc = 0x0
CTSPlugin: APDU Data:
CTSPlugin: 695:Le = 0x8000000c
CTSPlugin: 695:SWI 4d403 (SCTransport_IssueCommand)
CTSPlugin: 696: In:
CTSPlugin: 696:  R0 =       -2 (fffffffe)
CTSPlugin: 697:  R1 =    38518 (00009676)
CTSPlugin: 698:  R2 =        0 (00000000)
CTSPlugin: 698:  R3 =    38522 (0000967a)
CTSPlugin: 698:  R4 = -2147483636 (8000000c)
CTSPlugin: 699: Out:
CTSPlugin: 699:Kernel error -> 00000000
CTSPlugin: 700:SC error -> 00000000
CTSPlugin: 719:pollword handler entered with 1 events in queue
CTSPlugin: 720:Event 0 card 65535 (need -2) (reason 10, handle 35450268)
CTSPlugin: 720:Event reason code = 10
CTSPlugin: 720:read_response_available now = 1
CTSPlugin: 721:Poll: 13
CTSPlugin: 722:SWI 4d404 (SCTransport_ReadResponse)
CTSPlugin: 722: In:
CTSPlugin: 722:  R0 =       -2 (fffffffe)
CTSPlugin: 723:  R1 = 36226660 (0228c664)
CTSPlugin: 723:  R2 =     4096 (00001000)
CTSPlugin: 723:  R3 =    35780 (00008bc4)
CTSPlugin: 724:  R4 = 36223996 (0228bbfc)
CTSPlugin: 724: Out:
CTSPlugin: 724:Kernel error -> 00000000
CTSPlugin: 725:SC error -> 00000000
CTSPlugin: 725:ReadResponse returned size=12
CTSPlugin: 726:[read size call] data_size = 12; res=0; err=0
CTSPlugin: 726:[SW1:SW2] == [90:00]; data_size = 12; res=0; err=0
CTSPlugin: 726:Adding [90:00] at offset 12 in buffer
CTSPlugin: 728:Encoded response is 3930303030303030303230309000
CTSPlugin: 728:SM> ******** Send "apdu(t)" result, "http://acn.eng.cam.pace.co.u
k/cgi-bin/Auth.cgi?Service=Authenticate&Seq=3&Cmd=APDU&Script=GetCardIdChallenge
%2Esct&ScriptSeq=1&APDU1=9000&APDU2=3930303030303030303230309000"
CTSPlugin: 728:(1) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co.
uk/cgi-bin/Auth.cgi?Service=Authenticate&Seq=3&Cmd=APDU&Script=GetCardIdChalleng
e%2Esct&ScriptSeq=1&APDU1=9000&APDU2=3930303030303030303230309000' on `<null>'
CTSPlugin: 731:Temporary filename is `Cache:$.ScrapDir.x01d08e03'
CTSPlugin: 735:(2) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co.
uk/cgi-bin/Auth.cgi' on `<null>'
CTSPlugin: 735:send_message(00008a50, 0000ae98) [0000ae98] (local variable at 00
008a2c)
CTSPlugin: 737:Sending message to browser
CTSPlugin: 737:(3) send message has returned
CTSPlugin: 737:SM> APDU - Changed state from 1 to 0
CTSPlugin: 738:SM> Open - Changed state from 2 to 0

*** Plug in has requested a URL. Browser takes 211cs to respond:

CTSPlugin: 847:plugin_stream_new(): flags 00000000
CTSPlugin: 847:client_cts_stream_new(): instance 0000ace8
CTSPlugin: 847:Poll: 18
CTSPlugin: 848:(Message 0004d548)
CTSPlugin: 850:Parsing a received server message
CTSPlugin: 850:
CTSPlugin: cts_statetable_dispatch_server_message:
CTSPlugin: 850:    Parameter: `Service' = `Authenticate'
CTSPlugin: 851:    Parameter: `Seq' = `3'
CTSPlugin: 851:    Parameter: `Cmd' = `APDU'
CTSPlugin: 851:    Parameter: `URL' = `http://acn.eng.cam.pace.co.uk/cgi-bin/Aut
h.cgi'
CTSPlugin: 852:    Parameter: `CardId' = `900000000200'
CTSPlugin: 852:    Parameter: `Script' = `GetCardIdChallenge.sct'
CTSPlugin: 852:    Parameter: `ScriptSeq' = `2'
CTSPlugin: 853:    Parameter: `APDU1' = `0084000008'
CTSPlugin: 853:end of message
CTSPlugin:
CTSPlugin: 854:The command is `APDU'
CTSPlugin: 854:log_send_msg
CTSPlugin: 854:APDU count = 1
CTSPlugin: 855:SM> APDU - Initialising (moving to ReceiveResponse state)
CTSPlugin: 855:Sending APDU ... (length = 5)
CTSPlugin: 0000: 00 84 00 00 08                                  : .
                                                                    ...

CTSPlugin: 856:APDU contains Hdr Le(0x80000008)
CTSPlugin: 856:APDU Header:
CTSPlugin: 0000: 00 84 00 00                                     : .
                                                                    ..

CTSPlugin: 857:Lc = 0x0
CTSPlugin: APDU Data:
CTSPlugin: 857:Le = 0x80000008
CTSPlugin: 858:SWI 4d403 (SCTransport_IssueCommand)
CTSPlugin: 858: In:
CTSPlugin: 858:  R0 =       -2 (fffffffe)
CTSPlugin: 859:  R1 =    38507 (0000966b)
CTSPlugin: 859:  R2 =        0 (00000000)
CTSPlugin: 860:  R3 =    38511 (0000966f)
CTSPlugin: 861:  R4 = -2147483640 (80000008)
CTSPlugin: 861: Out:
CTSPlugin: 862:Kernel error -> 00000000
CTSPlugin: 862:SC error -> 00000000
CTSPlugin: 862:SM> Open - Changed state from 0 to 2
CTSPlugin: 863:Poll: 18
CTSPlugin: 864:(Message 0004d54c)
CTSPlugin: 864:Received message from browser to destroy stream
CTSPlugin: 865:client_cts_stream_destroy(): instance 0000ace8; reason 0
CTSPlugin: 865:Poll: 18
CTSPlugin: 865:(Message 0004d549)
CTSPlugin: 883:pollword handler entered with 1 events in queue
CTSPlugin: 883:Event 0 card 65535 (need -2) (reason 10, handle 35450268)
CTSPlugin: 884:Event reason code = 10
CTSPlugin: 884:read_response_available now = 1
CTSPlugin: 885:Poll: 13
CTSPlugin: 885:SWI 4d404 (SCTransport_ReadResponse)
CTSPlugin: 885: In:
CTSPlugin: 886:  R0 =       -2 (fffffffe)
CTSPlugin: 886:  R1 = 36226660 (0228c664)
CTSPlugin: 886:  R2 =     4096 (00001000)
CTSPlugin: 886:  R3 =    35780 (00008bc4)
CTSPlugin: 887:  R4 = 36223996 (0228bbfc)
CTSPlugin: 888: Out:
CTSPlugin: 888:Kernel error -> 00000000
CTSPlugin: 889:SC error -> 00000000
CTSPlugin: 889:ReadResponse returned size=8
CTSPlugin: 889:[read size call] data_size = 8; res=0; err=0
CTSPlugin: 890:[SW1:SW2] == [90:00]; data_size = 8; res=0; err=0
CTSPlugin: 890:Adding [90:00] at offset 8 in buffer
CTSPlugin: 890:Encoded response is 83EC4088192933A89000
CTSPlugin: 891:SM> ******** Send "apdu(t)" result, "http://acn.eng.cam.pace.co.u
k/cgi-bin/Auth.cgi?Service=Authenticate&Seq=3&Cmd=APDU&CardId=900000000200&Scrip
t=GetCardIdChallenge%2Esct&ScriptSeq=2&APDU1=83EC4088192933A89000"
CTSPlugin: 891:(1) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co.
uk/cgi-bin/Auth.cgi?Service=Authenticate&Seq=3&Cmd=APDU&CardId=900000000200&Scri
pt=GetCardIdChallenge%2Esct&ScriptSeq=2&APDU1=83EC4088192933A89000' on `<null>'
CTSPlugin: 893:Temporary filename is `Cache:$.ScrapDir.x01d09004'
CTSPlugin: 898:(2) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co.
uk/cgi-bin/Auth.cgi' on `<null>'
CTSPlugin: 898:send_message(00008a50, 0000ae98) [0000ae98] (local variable at 00
008a2c)
CTSPlugin: 899:Sending message to browser
CTSPlugin: 900:(3) send message has returned
CTSPlugin: 900:SM> APDU - Changed state from 1 to 0
CTSPlugin: 900:SM> Open - Changed state from 2 to 0

*** Plug in has requested a URL. Browser takes 106cs to respond:

CTSPlugin: 1006:plugin_stream_new(): flags 00000000
CTSPlugin: 1007:client_cts_stream_new(): instance 0000ace8
CTSPlugin: 1007:Poll: 18
CTSPlugin: 1007:(Message 0004d548)
CTSPlugin: 1009:Parsing a received server message
CTSPlugin: 1010:
CTSPlugin: cts_statetable_dispatch_server_message:
CTSPlugin: 1010:    Parameter: `Service' = `Authenticate'
CTSPlugin: 1011:    Parameter: `Seq' = `4'
CTSPlugin: 1011:    Parameter: `Cmd' = `Verify'
CTSPlugin: 1011:    Parameter: `URL' = `http://acn.eng.cam.pace.co.uk/cgi-bin/Au
th.cgi'
CTSPlugin: 1012:    Parameter: `CardId' = `900000000200'
CTSPlugin: 1012:    Parameter: `KeyID' = `05'
CTSPlugin: 1012:end of message
CTSPlugin:
CTSPlugin: 1013:The command is `Verify'
CTSPlugin: 1013:log_send_msg
CTSPlugin: 1014:SM> Verify - Initialising (moving to WaitingOKCancel state)
CTSPlugin: 1014:cts_ui_open_dbox: request to open dbox `21' (21:   Enter passwor
d)
CTSPlugin: 1026:Substitution for `DATAHEADERS'
CTSPlugin: 1027:Sending message to open dialogue box
CTSPlugin: 1028:(1) pluginclient_browser_access_url: `file:/Cache:$/ScrapDir/x01
d09105' on `__dbox_ctsplugin'
CTSPlugin: 1028:(2) pluginclient_browser_access_url: `file:/Cache:$/ScrapDir/x01
d09105' on `__dbox_ctsplugin'
CTSPlugin: 1028:send_message(00008988, 0000ae98) [0000ae98] (local variable at 0
0008964)
CTSPlugin: 1029:Sending message to browser
CTSPlugin: 1029:(3) send message has returned
CTSPlugin: 1029:SM> Open - Changed state from 0 to 3
CTSPlugin: 1030:Poll: 18
CTSPlugin: 1030:(Message 0004d54c)
CTSPlugin: 1031:Received message from browser to destroy stream
CTSPlugin: 1032:client_cts_stream_destroy(): instance 0000ace8; reason 0
CTSPlugin: 1032:Poll: 18
CTSPlugin: 1032:(Message 0004d549)
CTSPlugin: 1756:Message &4AF80 arrives for URL cts:dbox?remove=__dbox_cts&field.
password=0123&action.ok=OK
CTSPlugin: 1757:client_cts_submit: browser button activated
CTSPlugin: 1757:Browser parameter `remove'; value `__dbox_cts':
CTSPlugin: 000: 5f 5f 64 62 6f 78 5f 63 74 73                   : __dbox_cts

CTSPlugin: 1758:Browser parameter `field.password'; value `0123':
CTSPlugin: 0000: 30 31 32 33                                     : 0123

CTSPlugin: 1759:Browser parameter `action.ok'; value `OK':
CTSPlugin: 0000: 4f 4b                                           : OK

CTSPlugin: 1759:
CTSPlugin: cts_statetable_dispatch_browser_message:
CTSPlugin: 1760:  command is dbox
CTSPlugin: 1760:    Parameter: `action.ok' = `OK'
CTSPlugin: 1761:    Parameter: `field.password' = `0123'
CTSPlugin: 1761:    Parameter: `remove' = `__dbox_cts'
CTSPlugin: 1761:end of message
CTSPlugin:
CTSPlugin: 1762:SM> Verify - password = "0123"
CTSPlugin: 1762:SM> Verify - keyid = "05" (0x5)
CTSPlugin: 1762:constructing pin op
CTSPlugin: 1763:total length is 4 + 1 + 4 = 9
CTSPlugin: 1763:Sending APDU ... (length = 9)
CTSPlugin: 0000: 00 20 00 85 04 30 31 32 33                      : . .
.0123
CTSPlugin: 1764:APDU contains Hdr Lc(0x4) Data
CTSPlugin: 1764:APDU Header:
CTSPlugin: 0000: 00 20 00 85                                     : . .

CTSPlugin: 1765:Lc = 0x4
CTSPlugin: APDU Data:
CTSPlugin: 0000: 30 31 32 33                                     : 0123

CTSPlugin: 1765:Le = 0x0
CTSPlugin: 1766:SWI 4d403 (SCTransport_IssueCommand)
CTSPlugin: 1766: In:
CTSPlugin: 1766:  R0 =       -2 (fffffffe)
CTSPlugin: 1767:  R1 =    63924 (0000f9b4)
CTSPlugin: 1767:  R2 =        4 (00000004)
CTSPlugin: 1767:  R3 =    63929 (0000f9b9)
CTSPlugin: 1768:  R4 =        0 (00000000)
CTSPlugin: 1768: Out:
CTSPlugin: 1769:Kernel error -> 00000000
CTSPlugin: 1769:SC error -> 00000000
CTSPlugin: 1769:SM> Verify - Changed state from 1 to 2
CTSPlugin: 1770:Poll: 18
CTSPlugin: 1770:(Message 0004af80)
CTSPlugin: 1786:pollword handler entered with 1 events in queue
CTSPlugin: 1787:Event 0 card 65535 (need -2) (reason 10, handle 35450268)
CTSPlugin: 1788:Event reason code = 10
CTSPlugin: 1788:read_response_available now = 1
CTSPlugin: 1788:Poll: 13
CTSPlugin: 1789:SWI 4d404 (SCTransport_ReadResponse)
CTSPlugin: 1789: In:
CTSPlugin: 1789:  R0 =       -2 (fffffffe)
CTSPlugin: 1790:  R1 = 36226660 (0228c664)
CTSPlugin: 1791:  R2 =     4096 (00001000)
CTSPlugin: 1791:  R3 =    35764 (00008bb4)
CTSPlugin: 1792:  R4 = 36223996 (0228bbfc)
CTSPlugin: 1792: Out:
CTSPlugin: 1792:Kernel error -> 00000000
CTSPlugin: 1794:SC error -> 00000000
CTSPlugin: 1794:ReadResponse returned size=0
CTSPlugin: 1794:[read size call] data_size = 0; res=0; err=0
CTSPlugin: 1795:[SW1:SW2] == [90:00]; data_size = 0; res=0; err=0
CTSPlugin: 1795:Adding [90:00] at offset 0 in buffer
CTSPlugin: 1795:Encoded response is 9000
CTSPlugin: 1795:cts_ui_open_dbox: request to open dbox `01-1' (01-1: Talking to
server (01-1))
CTSPlugin: 1809:Substitution for `ENGLISHTEXT'
CTSPlugin: 1810:Sending message to open dialogue box
CTSPlugin: 1811:(1) pluginclient_browser_access_url: `file:/Cache:$/ScrapDir/x01
d09906' on `__dbox_ctsplugin'
CTSPlugin: 1811:(2) pluginclient_browser_access_url: `file:/Cache:$/ScrapDir/x01
d09906' on `__dbox_ctsplugin'
CTSPlugin: 1812:send_message(000089a0, 0000ae98) [0000ae98] (local variable at 0
000897c)
CTSPlugin: 1812:Sending message to browser
CTSPlugin: 1812:(3) send message has returned
CTSPlugin: 1813:SM> ******** Send "verify" result, "http://acn.eng.cam.pace.co.u
k/cgi-bin/Auth.cgi?Service=Authenticate&Seq=4&Cmd=Verify&CardId=900000000200&Sts
=00"
CTSPlugin: 1813:(1) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co
.uk/cgi-bin/Auth.cgi?Service=Authenticate&Seq=4&Cmd=Verify&CardId=900000000200&S
ts=00' on `<null>'
CTSPlugin: 1814:Temporary filename is `Cache:$.ScrapDir.x01d09907'
CTSPlugin: 1819:(2) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co
.uk/cgi-bin/Auth.cgi' on `<null>'
CTSPlugin: 1819:send_message(00008a58, 0000ae98) [0000ae98] (local variable at 0
0008a34)
CTSPlugin: 1819:Sending message to browser
CTSPlugin: 1820:(3) send message has returned
CTSPlugin: 1820:SM> Verify - Changed state from 2 to 0
CTSPlugin: 1820:SM> Open - Changed state from 3 to 0

*** Plug in has requested a URL. Browser takes 151cs to respond:

CTSPlugin: 1971:plugin_stream_new(): flags 00000000
CTSPlugin: 1972:client_cts_stream_new(): instance 0000ace8
CTSPlugin: 1972:Poll: 18
CTSPlugin: 1972:(Message 0004d548)
CTSPlugin: 1975:Parsing a received server message
CTSPlugin: 1975:
CTSPlugin: cts_statetable_dispatch_server_message:
CTSPlugin: 1976:    Parameter: `Service' = `Authenticate'
CTSPlugin: 1976:    Parameter: `Seq' = `5'
CTSPlugin: 1976:    Parameter: `Cmd' = `APDU'
CTSPlugin: 1977:    Parameter: `URL' = `http://acn.eng.cam.pace.co.uk/cgi-bin/Au
th.cgi'
CTSPlugin: 1977:    Parameter: `CardId' = `900000000200'
CTSPlugin: 1977:    Parameter: `Script' = `Authenticate.sct'
CTSPlugin: 1978:    Parameter: `ScriptSeq' = `1'
CTSPlugin: 1978:    Parameter: `APDU1' = `0082008308796454BCACC7954D'
CTSPlugin: 1978:    Parameter: `APDU2' = `008800820879C5B4DA15D5EC5208'
CTSPlugin: 1979:    Parameter: `APDU3' = `08C2000000000B8609017F20862EE4B41B9200
00'
CTSPlugin: 1979:end of message
CTSPlugin:
CTSPlugin: 1980:The command is `APDU'
CTSPlugin: 1980:log_send_msg
CTSPlugin: 1980:APDU count = 3
CTSPlugin: 1981:SM> APDU - Initialising (moving to ReceiveResponse state)
CTSPlugin: 1981:Sending APDU ... (length = 13)
CTSPlugin: 0000: 00 82 00 83 08 79 64 54 bc ac c7 95 4d          : ...ydT¼ ÇM
CTSPlugin: 1982:APDU contains Hdr Lc(0x8) Data
CTSPlugin: 1982:APDU Header:
CTSPlugin: 0000: 00 82 00 83                                     : ..

CTSPlugin: 1983:Lc = 0x8
CTSPlugin: APDU Data:
CTSPlugin: 0000: 79 64 54 bc ac c7 95 4d                         : ydT¼ ÇM

CTSPlugin: 1984:Le = 0x0
CTSPlugin: 1984:SWI 4d403 (SCTransport_IssueCommand)
CTSPlugin: 1984: In:
CTSPlugin: 1986:  R0 =       -2 (fffffffe)
CTSPlugin: 1986:  R1 =    38501 (00009665)
CTSPlugin: 1986:  R2 =        8 (00000008)
CTSPlugin: 1987:  R3 =    38506 (0000966a)
CTSPlugin: 1987:  R4 =        0 (00000000)
CTSPlugin: 1989: Out:
CTSPlugin: 1989:Kernel error -> 00000000
CTSPlugin: 1989:SC error -> 00000000
CTSPlugin: 1990:SM> Open - Changed state from 0 to 2
CTSPlugin: 1990:Poll: 18
CTSPlugin: 1990:(Message 0004d54c)
CTSPlugin: 1992:Received message from browser to destroy stream
CTSPlugin: 1992:client_cts_stream_destroy(): instance 0000ace8; reason 0
CTSPlugin: 1992:Poll: 18
CTSPlugin: 1993:(Message 0004d549)
CTSPlugin: 2010:pollword handler entered with 1 events in queue
CTSPlugin: 2010:Event 0 card 65535 (need -2) (reason 10, handle 35450268)
CTSPlugin: 2010:Event reason code = 10
CTSPlugin: 2011:read_response_available now = 1
CTSPlugin: 2011:Poll: 13
CTSPlugin: 2011:SWI 4d404 (SCTransport_ReadResponse)
CTSPlugin: 2012: In:
CTSPlugin: 2012:  R0 =       -2 (fffffffe)
CTSPlugin: 2012:  R1 = 36226660 (0228c664)
CTSPlugin: 2013:  R2 =     4096 (00001000)
CTSPlugin: 2013:  R3 =    35780 (00008bc4)
CTSPlugin: 2013:  R4 = 36223996 (0228bbfc)
CTSPlugin: 2014: Out:
CTSPlugin: 2014:Kernel error -> 00000000
CTSPlugin: 2014:SC error -> 00000000
CTSPlugin: 2015:ReadResponse returned size=0
CTSPlugin: 2015:[read size call] data_size = 0; res=0; err=0
CTSPlugin: 2016:[SW1:SW2] == [63:00]; data_size = 0; res=0; err=0
CTSPlugin: 2016:Adding [63:00] at offset 0 in buffer
CTSPlugin: 2016:Encoded response is 6300
CTSPlugin: 2017:Sending APDU ... (length = 14)
CTSPlugin: 0000: 00 88 00 82 08 79 c5 b4 da 15 d5 ec 52 08       : ...yÅ Ú.ÕìR.

CTSPlugin: 2017:APDU contains Hdr Lc(0x8) Data Le(0x80000008)
CTSPlugin: 2018:APDU Header:
CTSPlugin: 0000: 00 88 00 82                                     : ..

CTSPlugin: 2019:Lc = 0x8
CTSPlugin: APDU Data:
CTSPlugin: 0000: 79 c5 b4 da 15 d5 ec 52                         : yÅ Ú.ÕìR

CTSPlugin: 2020:Le = 0x80000008
CTSPlugin: 2020:SWI 4d403 (SCTransport_IssueCommand)
CTSPlugin: 2020: In:
CTSPlugin: 2022:  R0 =       -2 (fffffffe)
CTSPlugin: 2022:  R1 =    38534 (00009686)
CTSPlugin: 2022:  R2 =        8 (00000008)
CTSPlugin: 2023:  R3 =    38539 (0000968b)
CTSPlugin: 2023:  R4 = -2147483640 (80000008)
CTSPlugin: 2024: Out:
CTSPlugin: 2025:Kernel error -> 00000000
CTSPlugin: 2025:SC error -> 00000000
CTSPlugin: 2047:pollword handler entered with 1 events in queue
CTSPlugin: 2047:Event 0 card 65535 (need -2) (reason 10, handle 35450268)
CTSPlugin: 2048:Event reason code = 10
CTSPlugin: 2048:read_response_available now = 1
CTSPlugin: 2048:Poll: 13
CTSPlugin: 2050:SWI 4d404 (SCTransport_ReadResponse)
CTSPlugin: 2050: In:
CTSPlugin: 2050:  R0 =       -2 (fffffffe)
CTSPlugin: 2052:  R1 = 36226660 (0228c664)
CTSPlugin: 2052:  R2 =     4096 (00001000)
CTSPlugin: 2053:  R3 =    35780 (00008bc4)
CTSPlugin: 2053:  R4 = 36223996 (0228bbfc)
CTSPlugin: 2053: Out:
CTSPlugin: 2054:Kernel error -> 00000000
CTSPlugin: 2055:SC error -> 00000000
CTSPlugin: 2055:ReadResponse returned size=8
CTSPlugin: 2056:[read size call] data_size = 8; res=0; err=0
CTSPlugin: 2056:[SW1:SW2] == [90:00]; data_size = 8; res=0; err=0
CTSPlugin: 2056:Adding [90:00] at offset 8 in buffer
CTSPlugin: 2057:Encoded response is 7074C5669C6B08CE9000
CTSPlugin: 2058:Sending APDU ... (length = 20)
CTSPlugin: 0000: 08 c2 00 00 00 00 0b 86 09 01 7f 20 86 2e e4 b4 : .Â........ .ä

CTSPlugin: 0010: 1b 92 00 00                                     : ...

CTSPlugin: 2059:APDU Header:
CTSPlugin: 0000: 08 c2 00 00                                     : .Â..

CTSPlugin: 2059:Lc = 0x8000000b
CTSPlugin: APDU Data:
CTSPlugin: 0000: 86 09 01 7f 20 86 2e e4 b4 1b 92                : ... .ä .
CTSPlugin: 2061:Le = 0x80000000
CTSPlugin: 2061:SWI 4d403 (SCTransport_IssueCommand)
CTSPlugin: 2062: In:
CTSPlugin: 2062:  R0 =       -2 (fffffffe)
CTSPlugin: 2062:  R1 =    38569 (000096a9)
CTSPlugin: 2062:  R2 = -2147483637 (8000000b)
CTSPlugin: 2064:  R3 =    38576 (000096b0)
CTSPlugin: 2064:  R4 = -2147483648 (80000000)
CTSPlugin: 2065: Out:
CTSPlugin: 2065:Kernel error -> 00000000
CTSPlugin: 2065:SC error -> 00000000
CTSPlugin: 2085:pollword handler entered with 1 events in queue
CTSPlugin: 2086:Event 0 card 65535 (need -2) (reason 10, handle 35450268)
CTSPlugin: 2086:Event reason code = 10
CTSPlugin: 2086:read_response_available now = 1
CTSPlugin: 2087:Poll: 13
CTSPlugin: 2088:SWI 4d404 (SCTransport_ReadResponse)
CTSPlugin: 2088: In:
CTSPlugin: 2088:  R0 =       -2 (fffffffe)
CTSPlugin: 2089:  R1 = 36226660 (0228c664)
CTSPlugin: 2089:  R2 =     4096 (00001000)
CTSPlugin: 2089:  R3 =    35780 (00008bc4)
CTSPlugin: 2090:  R4 = 36223996 (0228bbfc)
CTSPlugin: 2090: Out:
CTSPlugin: 2090:Kernel error -> 00000000
CTSPlugin: 2091:SC error -> 00000000
CTSPlugin: 2091:ReadResponse returned size=0
CTSPlugin: 2092:[read size call] data_size = 0; res=0; err=0
CTSPlugin: 2092:[SW1:SW2] == [6a:88]; data_size = 0; res=0; err=0
CTSPlugin: 2092:Adding [6a:88] at offset 0 in buffer
CTSPlugin: 2093:Encoded response is 6A88
CTSPlugin: 2093:SM> ******** Send "apdu(t)" result, "http://acn.eng.cam.pace.co.
uk/cgi-bin/Auth.cgi?Service=Authenticate&Seq=5&Cmd=APDU&CardId=900000000200&Scri
pt=Authenticate%2Esct&ScriptSeq=1&APDU1=6300&APDU2=7074C5669C6B08CE9000&APDU3=6A
88"
CTSPlugin: 2094:(1) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co
.uk/cgi-bin/Auth.cgi?Service=Authenticate&Seq=5&Cmd=APDU&CardId=900000000200&Scr
ipt=Authenticate%2Esct&ScriptSeq=1&APDU1=6300&APDU2=7074C5669C6B08CE9000&APDU3=6
A88' on `<null>'
CTSPlugin: 2095:Temporary filename is `Cache:$.ScrapDir.x01d09c08'
CTSPlugin: 2101:(2) pluginclient_browser_access_url: `http://acn.eng.cam.pace.co
.uk/cgi-bin/Auth.cgi' on `<null>'
CTSPlugin: 2101:send_message(00008a50, 0000ae98) [0000ae98] (local variable at 0
0008a2c)
CTSPlugin: 2101:Sending message to browser
CTSPlugin: 2103:(3) send message has returned
CTSPlugin: 2103:SM> APDU - Changed state from 1 to 0
CTSPlugin: 2103:SM> Open - Changed state from 2 to 0

*** Plug in has requested a URL. Browser takes 107cs to respond:

CTSPlugin: 2210:plugin_stream_new(): flags 00000000
CTSPlugin: 2210:client_cts_stream_new(): instance 0000ace8
CTSPlugin: 2211:Poll: 18
CTSPlugin: 2211:(Message 0004d548)
CTSPlugin: 2213:Parsing a received server message
CTSPlugin: 2213:
CTSPlugin: cts_statetable_dispatch_server_message:
CTSPlugin: 2214:    Parameter: `Service' = `Authenticate'
CTSPlugin: 2214:    Parameter: `Seq' = `5'
CTSPlugin: 2214:    Parameter: `Cmd' = `Err'
CTSPlugin: 2215:    Parameter: `URL' = `http://acn.eng.cam.pace.co.uk/Err.asp'
CTSPlugin: 2215:    Parameter: `Msg' = `S013'
CTSPlugin: 2215:end of message
CTSPlugin:
CTSPlugin: 2216:The command is `Err'
CTSPlugin: 2216:log_send_msg
CTSPlugin: 2217:SM> ErrorClose - Initialising (moving to Closing state)
CTSPlugin: 2217:cts_sc_close entered
CTSPlugin: 2218:Closing open stream
CTSPlugin: 2218:SWI 4d402 (SCTransport_Close)
CTSPlugin: 2218: In:
CTSPlugin: 2219:  R0 =        2 (00000002)
CTSPlugin: 2219: Out:
CTSPlugin: 2220:Kernel error -> 00000000
CTSPlugin: 2220:SC error -> 00000000
CTSPlugin: 2220:SM> Open - Changed state from 0 to 4
CTSPlugin: 2221:Poll: 18
CTSPlugin: 2221:(Message 0004d54c)
CTSPlugin: 2221:Received message from browser to destroy stream
CTSPlugin: 2222:client_cts_stream_destroy(): instance 0000ace8; reason 0
CTSPlugin: 2222:Poll: 18
CTSPlugin: 2223:(Message 0004d549)
CTSPlugin: 2223:SM> ******** Send "errorclose" result, "http://acn.eng.cam.pace.
co.uk/Err.asp?Msg=S013"
CTSPlugin: 2224:pluginclient_browser_goto_with_target: `http://acn.eng.cam.pace.
co.uk/Err.asp?Msg=S013' (`<null>')
CTSPlugin: 2224:SM> ErrorClose - Changed state from 1 to 0
CTSPlugin: 2224:SM> Open - Changed state from 4 to 0
CTSPlugin: 2226:SM> Started - Changed state from 4 to 0
CTSPlugin: 2389:plugin_close_handler() plugin = 0000ae98
CTSPlugin: 2390:pluginclient_browser_goto_with_target: `ncint:loadurl?remove=__d
box_ctsplugin' (`__dbox_ctsplugin')
CTSPlugin: 2390:pluginclient_send_closed() closed message sent before = 0
CTSPlugin: 2391:send_message(00008b94, 0000ae98) [0000ae98] (local variable at 0
0008b70)
CTSPlugin: 2391:Sending message to browser
CTSPlugin: 2391:client_cts_close(): instance 0000ace8
CTSPlugin: 2392:close_child_window() : plugin 0000ae98
CTSPlugin: 2392:remove_window_handlers: id 08003018
CTSPlugin: 2392:dispose_plugin_info(): instance 0000ae98
CTSPlugin: 2393:free_params(): 0000ad3c
CTSPlugin: 2393:Poll: 18
CTSPlugin: 2394:(Message 0004d542)
CTSPlugin: 2426:Exiting due to inactivity
CTSPlugin: 2428:Temporary filename is `Cache:$.ScrapDir.x01d09f09'
CTSPlugin: 2428:dispose_plugin_all():
CTSPlugin: 2429:*** CTSPlugin exiting at Fri Jan  2 09:02:23 1970
CTSPlugin: 2429:cts_sc_close entered
CTSPlugin:
CTSPlugin: ***** Debug Session Terminated *************************************
CTSPlugin: Task: CTSPlugin
CTSPlugin: Time: Fri Jan  2 09:02:23 1970
CTSPlugin: DebugLib is (c) Pace Micro Technology plc. 1997-1999
CTSPlugin: ********************************************************************
CTSPlugin: (6) Close
# Connection closed
</pre>
</body>
</html>
