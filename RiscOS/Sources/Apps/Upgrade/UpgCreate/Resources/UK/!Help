
   UpgCreate
   ~~~~~~~~~
   Purpose:  Build upgrade images for NC style devices

   Setup:

      Icon                 Action/Meaning                         Default
      ----                 --------------                         -------
      Source data          File or directory containing files     nil
                           to be built into the image.
      Output file          Filename for output image.             "Image"
                           separated list, for OS images.
      Type                 Select the image type from the         OS image
                           available radio button options.
      Multiple downloads   If selected, a unique ID number        off
                           must be provided in hex; download
                           of a file with a UID matching one
                           already in the device stops the
                           download proceeding further.
      UID value            An 8 digit hex number.                 0000AAAA
      Randomise            EOR the given UID with rand() and      off
                           time (the UID is then psuedo
                           random; don't need to track UIDs
                           at creation time then, but there's
                           a very small risk of a UID clash).
      ROM card             OS images only - FLASH ROM card        off
                           booting if "on", else on-board
                           FLASH.
      Display              String to display during download.     nil
      Build                Build to match with for OS images.     nil
      Locale               Locale for this image, as a comma      "UK"
                           separated list (optional for all
                           items except OS images).
      Test integrity       Check output file integrity by         off
                           extracting contents (see below).
      Extract to           Location to extract to when doing      "null:$"
                           an integrity test.

   Command line:

      Name                 Value(s)
      ----                 --------
      -s (source)          Full pathname of file/directory to read.
      -o (output)          Full pathname of output image.
      -t (type)            osimage | transient | resident | permanent |
                           font | exec ("font" and "exec" are presently
                           not implemented).
      -c (card/bank)       0 for on-board FLASH ROM, 6 for card ROM (may
                           be omitted; default is "0").
      -d (display)         "display string".
      -b (build)           "build to match" (OS images only).
      -l (locale)          "one or more locales" (for all types except
                           Font and Exec).
      -e (extract)         Full pathname to extract to; leads to a test of
                           output file's integrity after creation by
                           extracting to the given location (may be
                           omitted; if absent, no test is performed; see
                           below for more information).
      -u (hex string)      Include UID in image; the value should be an 8
                           digit hex number with no special prefix (may be
                           omitted; if absent, no UID is included).
      -r (boolean)         1 | 0 (if "1", randomise UID by EORing with
                           rand() and time; ignored if -u is absent; may
                           be omitted; default is "0").

   If -s and -o must always be present; -e is always optional. Other
   parameters depend on the value of the "-t" item:

    * "osimage": -d, -b and -l must be present; -c is optional (default
       value is 0). If -e is present the image is extracted to the given
       filename, remaining in compressed form.
    * "font" or "exec": A single file will be compressed. Use of -e is as
       for "osimage".

   For other values of -t, -l is always optional:

    * "transient": If -e is present it should be the directory in which
       extraction will take place. All extracted files are decompressed.
    * "resident": -u (and therefore -r) are optional. Use of -e is as for
       "transient".
    * "permanent": -u is mandatory, -r optional. Use of -e is as for
       "transient".
