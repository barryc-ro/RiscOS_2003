#include "Password.h"

/* some extra user functions only used in the Guessing overlay */

u_char gMacToArc[128] = {
0xc4, 0xc5, 0xc7, 0xc9, 0xd1, 0xd6, 0xdc, 0xe1, 0xe0, 0xe2, 0xe4, 0xe3, 0xe5, 0xe7, 0xe9, 0xe8,
0xea, 0xeb, 0xed, 0xec, 0xee, 0xef, 0xf1, 0xf3, 0xf2, 0xf4, 0xf6, 0xf5, 0xfa, 0xf9, 0xfb, 0xfc,
0x9c, 0xb0, 0xa2, 0xa3, 0xa7, 0x8f, 0xb6, 0xdf, 0xae, 0xa9, 0x8d, 0xb4, 0xa8, 0xd7, 0xc6, 0xd8,
0xb2, 0xb1, 0xb9, 0xb3, 0xa5, 0xb5, 0xf0, 0xd0, 0xde, 0xfe, 0xbc, 0xaa, 0xba, 0xfd, 0xe6, 0xf8,
0xbf, 0xa1, 0xac, 0x80, 0xbe, 0x83, 0x84, 0xab, 0xbb, 0x8c, 0xa0, 0xc0, 0xc3, 0xd5, 0x9a, 0x9b,
0x97, 0x98, 0x94, 0x95, 0x90, 0x91, 0xf7, 0xa6, 0xdd, 0xff, 0xbd, 0xa4, 0x92, 0x93, 0x9e, 0x9f,
0x9d, 0xb7, 0x86, 0x96, 0x8e, 0xc2, 0xca, 0xc1, 0xcb, 0xc8, 0xcd, 0xce, 0xcf, 0xcc, 0xd3, 0xd4,
0x81, 0xd2, 0xda, 0xdb, 0xd9, 0x88, 0xad, 0x89, 0xaf, 0x8a, 0x8b, 0x85, 0xb8, 0x82, 0x87, 0x99 };

/* ---------------------------------------------------------------------- */
void MacToArc(arcWord, token, tokenLen)
u_char *arcWord;
void *token;
int tokenLen;
{
  u_char *scp, *ecp;
  u_char *p;

  scp = (u_char *)token;
  ecp = scp + tokenLen;

  for (p = arcWord; scp < ecp; scp++)
    *(p++) = (*scp >= 128 ? gMacToArc[*scp - 128] : *scp);
}

/* ---------------------------------------------------------------------- */
Handle DoGuess(dict, token, tokenLen)
Handle dict;
void *token;
int tokenLen;
{
  u_char macWord[100];
  u_char *endp;

  endp = ArcToMac(macWord, token, tokenLen);
/*  h = Guess(dict, token, (u_char *)token + tokenLen - 1, 1); */
  return Guess(dict, macWord, endp, 1);
}

/* ----------------------------------------------------------------------
27/04/95 no longer needed - see below
static void ArcToMacStr(macWord, what)
u_char *macWord;
u_char *what;
{
  u_char *p;

  for (p = macWord;
          (*(p++) = (*what >= 128 ? gArcToMac[*what - 128] : *what)) != 0;
                                    what++) {}
}
*/

/*-----------------------------------------------PWDUserInsert*/
short PWDArcInsert(d, what)
struct CNSDictType **d;
u_char *what;
{
  u_char macWord[100];

  ArcToMac(macWord, what, 100); /* slower but simplifies overlaying */
  /* ArcToMacStr(macWord, what); 27/04/95 */
  return CNSInsert(d, macWord);
}

