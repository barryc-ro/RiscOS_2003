/*
 * Name	    : NCKeybd.h
 * Desc	    : Onscreen software keyboard for Acorn RCA NC
 * Author   : Jonathan Larmour
 * Date	    : 13th February 1997
 *
 * History
 * -------
 *
 *  19/3/97 JIFL    Removed redundant EXIT_KEY definition
 *                  Changed Caps gadget id for new keyboard
 *                  Changed Starting gadget for extension to be starting gadget
 *                    for different layout
 *                  Removed layout env var
 *                  Added osbytes for get/set CMOS, and location of keyboard
 *                    layout
 *                  Added Iconhigh_ignoreNextChar SWI
 *  24/2/97 JIFL    Added OSKB_LAYOUT_ENV_VAR_NAME
 *  13/2/97 JIFL    Finished main coding
 *  5/2/97  JIFL    Created file
 *
 * Relevant Documents
 * ------------------
 *
 * 2107,738 	Owen Love   	RCA On-Screen Keyboard Software Functional Spec
 * 2107,217 	Julian Smith    Icon Highlighter Functional Spec
 *
 * Summary
 * -------
 * This is the header file documenting most of the constants and definitions
 * used in the whole Onscreen Keyboard application.
 *
 * © Acorn UK Ltd., 1997
 */

#ifndef OSKB_NCKEYBD_H
#define OSKB_NCKEYBD_H

/* CONSTANTS */
#define WimpVersion         310
#define OSKB_MESSAGE_CHUNK_BASE 0x4E700
#define TAB_SPACES          8           /* number of spaces to output with tab */
#define RES_KEYB_GADGET_ID  0x00        /* gadget id of keyboard backb sprite */
#define RES_EXT_GADGET_ID   0x57        /* gadget id of keyb extension backb
                                         * sprite */
#define RES_CAPS_GADGET_ID  0x6C	/* gadget id of caps lock modifier */
#define READ_SPRITE_INFO    40          /* code to Wimp_SpriteOp to get sprite
                                         * geometry */
#define OSB_INSERT_CHAR_FN  138         /* OsByte function to insert char into
                                         * keyboard buffer */
#define OSB_READ_CMOS_FN    161         /* OsByte function to read CMOS */
#define OSB_WRITE_CMOS_FN   162         /* OsByte function to write CMOS */

#define OSKB_DEFAULT_EVENT_MASK (Wimp_Poll_NullMask + \
                                 Wimp_Poll_RedrawWindowRequestMask + \
                                 Wimp_Poll_PointerLeavingWindowMask + \
                                 Wimp_Poll_PointerEnteringWindowMask + \
                                 Wimp_Poll_KeyPressedMask + \
                                 Wimp_Poll_LoseCaretMask + \
                                 Wimp_Poll_GainCaretMask + \
                                 Wimp_Poll_UserMessageRecordedMask + \
                                 Wimp_Poll_UserMessageAcknowledgeMask + \
                                 Wimp_Poll_PollWord)

#define OSKB_XEIG_FN        4           /* parameters to OS_ReadModeVariable */
#define OSKB_YEIG_FN        5           /* to read screen parameters such as */
#define OSKB_XLIMIT_FN      11          /* number of bits per pixel and      */
#define OSKB_YLIMIT_FN      12          /* screen geometry                   */
#define OSKB_SCROLL_RATE    4       /* speed of scrolling up/down screen - 1
                                     * means scroll every pixel
                                     */

/* ERROR CODES */
#define OSKB_UNKNOWN_LAYOUT (OSKB_MESSAGE_CHUNK_BASE + 0) /* unknown layout (!) */

#define OSKB_BAD_KEYMAP     (OSKB_MESSAGE_CHUNK_BASE + 1) /* couldn't parse keymap
                                                       * entry
                                                       */

#define OSKB_KEY_ERR        (OSKB_MESSAGE_CHUNK_BASE + 2) /* error when key inserted
                                                       * into keyboard buffer
                                                       */

#define OSKB_BAD_MODE_INFO  (OSKB_MESSAGE_CHUNK_BASE + 3) /* bad mode data passed
                                                       * to OS_ReadModeVariable */

/* Misc constants */
#define OSKB_DEFAULT_CAPS_STATE     0                 /* Caps lock off at start */

#define OSKB_DEFAULT_KEYB_A_HIGHLIGHT 0x2D            /* Default key to highlight
                                                       * when starting on alpha
                                                       * keyboard layout */

#define OSKB_DEFAULT_KEYB_Q_HIGHLIGHT 0x2E            /* Default key to highlight
                                                       * when starting on qwerty
                                                       * keyboard layout */

#define OSKB_CAPS_ENV_VAR_NAME      "NCKeyboard$CapsLockState" /* Name of system
                                                                * variable to read
                                                                * to get caps lock
                                                                * state
                                                                */
#define OSKB_CMOS_LAYOUT_BYTE       0x103               /* Byte in CMOS containing
                                                         * keyboard layout */
#define OSKB_CMOS_LAYOUT_BIT        (1 << 3)            /* Bit of byte in CMOS
                                                         * containing keyboard
                                                         * layout */

/* message number of message to use to publish window geometry */
#define OSKB_MESSAGE_NCKEYBOARD_WINDOWSIZE  (OSKB_MESSAGE_CHUNK_BASE + 1)

/* message number of close message from other apps */
#define OSKB_MESSAGE_NCKEYBOARD_CLOSE       (OSKB_MESSAGE_CHUNK_BASE + 2)

/* message number of close message to broadcast once we have closed */
#define OSKB_MESSAGE_NCKEYBOARD_CLOSED      (OSKB_MESSAGE_CHUNK_BASE + 3)


/* Iconhigh definitions */
#define OSKB_SWI_ICONHIGH_START         0x4E702    /* SWI to start iconhigh */
#define OSKB_SWI_ICONHIGH_STOP          0x4E703    /* SWI to stop iconhigh */
#define OSKB_SWI_ICONHIGH_IGNORE_NEXT_CHAR 0x4E707 /* SWI to warn iconhigh about
                                                    * a key being inserted into
                                                    * the keyboard buffer */
#define OSKB_ICONHIGH_START_FLAGS       0x00       /* Flags to use when starting
                                                    * iconhigh. See iconhigh
                                                    * spec */
/* KeyWatch definitions */
#define OSKB_SWI_KEYWATCH_BASE          0x4E940
#define OSKB_SWI_KEYWATCH_REGISTER      (OSKB_SWI_KEYWATCH_BASE + 0)
#define OSKB_SWI_KEYWATCH_DEREGISTER    (OSKB_SWI_KEYWATCH_BASE + 1)


/* TYPE DEFINITIONS */

typedef enum { OSKB_ALPHA=0, OSKB_QWERTY=1 } oskb_layout_t; /* keyboard layout */
typedef int object_id;

#endif
