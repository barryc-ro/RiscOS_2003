/* ncma_dial.c - handle interface to NCDialUI stuff */
#include <stdio.h>
#include "kernel.h"
#include "swis.h"

#define PROTOTYPES_INTERNAL
#include "ncma_dial.h"
#include "DBUG.h"

int ncma_dial(void)
{
  _kernel_swi_regs r;

  r.r[0] = 0;
  if(_kernel_swi(NCDialUI_Start, &r, &r)!=NULL) {
      DBUG_PRINTF(DBUG_LVL_ERROR, "ncma_dial: dial SWI failed\n");
      return(-1);
  }
  DBUG_PRINTF(DBUG_LVL_DIAG, "ncma_dial: DIAL OK\n");
  return(0);
}

int ncma_hangup(void)
{
    _kernel_swi_regs r;

    if(_kernel_swi(NCDial_Hangup, &r, &r)!=NULL) {
        DBUG_PRINTF(DBUG_LVL_ERROR, "ncma_dial: HUP SWI failed\n");
        return(-1);
    }
    line_up = 0;
    DBUG_PRINTF(DBUG_LVL_DIAG, "ncma_dial: HUP OK\n");
    return(0);
}

int set_ppp_timeout(void)
{
    _kernel_swi_regs r;

    r.r[0] = 0;
    r.r[1] = PPP_DEFAULT_UNIT;
    r.r[2] = PPP_DEFAULT_TIMEOUT;

    if(_kernel_swi(PPP_AlterSettings, &r, &r)!=NULL) {
        DBUG_PRINTF(DBUG_LVL_DIAG, "set_ppp_timeout: PPP_AlterSettings SWI failed\n");
        return(-1);
    }
    DBUG_PRINTF(DBUG_LVL_DIAG, "set_ppp_timeout: PPP unit %d default timeout %d\n", PPP_DEFAULT_UNIT,
    			       PPP_DEFAULT_TIMEOUT);
    return(0);
}
