// header file for NCMA_AUTH.H

/* Begin-Prologue */
#ifndef NCMA_AUTH_H
#define NCMA_AUTH_H
#undef DECLARE
#undef INIT
#ifdef PROTOTYPES_INTERNAL
#define DECLARE
#define INIT(x) =(x)
#else
#define DECLARE extern
#define INIT(x)
#endif
/* End-Prologue */
#define AUTH_FLAGS_KEY_DER        0x2
#define AUTH_FLAGS_KEY_PEM        0x0
#define AUTH_FLAGS_CERT_DER       0x1
#define AUTH_FLAGS_CERT_PEM       0x0
#define AUTH_FLAGS_CERT_INCORE    0x4
#define AUTH_FLAGS_CERT_FILE      0x0
#define AUTH_FLAGS_KEY_RSA	  0x8

#ifndef HTTP_VerifyMessageDigest
#define HTTP_VerifyMessageDigest  0x4af87
#define HTTP_ConvertToPEM	  0x4af89
#endif

#define AUTH_ERROR_BAD_INPUT            0x1
#define AUTH_ERROR_BAD_CERT	        0x2
#define AUTH_ERROR_FAILED	        0x3
#define AUTH_ERROR_NO_FREE_RSA          0x4
#define AUTH_ERROR_NO_FREE_EVP          0x5
#define AUTH_ERROR_BAD_RSA              0x6
#define AUTH_ERROR_NO_FREE_X509         0x7
#define AUTH_ERROR_CERT_NBERROR         0x8
#define AUTH_ERROR_CERT_NOTYET          0x9
#define AUTH_ERROR_CERT_NAERROR         0xa
#define AUTH_ERROR_CERT_EXPIRED         0xb


#ifdef MANUFACTURER_KEY_X509
DECLARE unsigned char ncma_auth_root_certificate_name[] INIT("SSL:MFRCERT");
#else
#ifdef PRODUCTION_KEYS
DECLARE unsigned char ncma_auth_root_key_name[] INIT("SSL:MFRKEYlive");
#else
DECLARE unsigned char ncma_auth_root_key_name[] INIT("SSL:MFRKEY");
#endif
#endif

#define NCMA_CERTIFICATE_DIR      "cache:$.NCMA.Certs."
#define NCMA_ROOT_CERTIFICATE_DIR "Resources:$.Resources.NCMA."
#define SSL_PATH_ENV_VAR	  "SSL$Path"

DECLARE int ncma_auth_root(unsigned char *, unsigned int, unsigned char *, unsigned int);
DECLARE int ncma_auth_cert(unsigned char *, unsigned int, unsigned char *, unsigned int, unsigned char *, unsigned int);
DECLARE int ncma_auth(unsigned char *, unsigned int, unsigned char *, unsigned int, unsigned char *, unsigned int);
DECLARE int export_ram_certificate(void);
DECLARE void init_certificate_path(void);

/* Begin-Epilogue */
#undef PROTOTYPES_INTERNAL
#undef INIT
#undef DECLARE
#endif
/* End_Epilogue */

