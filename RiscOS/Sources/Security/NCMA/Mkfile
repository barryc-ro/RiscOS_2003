#
#         Makefile for Ant's funky new NCMA module
#

# Version: 0.01
# Date   : 10-Mar-97
# Author : ant@acorn.co.uk


# ----------------------------------------------------------------- #
# Include files and Lib files
# ----------------------------------------------------------------- #

INCLUDES = c:
#LIBFILES = c:^.libs.o.inetlibzm \
#           c:^.libs.o.socklibzm \
#           c:^.libs.o.unixlibzm

LIBFILES = 



# ----------------------------------------------------------------- #
# Various Macros
# ----------------------------------------------------------------- #

# C FLAGS:
#

CC = cc


CFLAGS = -I$(INCLUDES) -c -throwback -depend !Depend -zM -DENABLE_DEBUGGING

LINK = link
LINKFLAGS = -module

CMHG = cmhg515
CMHGFLAGS = -p -depend !Depend -throwback 

WIPE = wipe
WIPEFLAGS = F~C~R~V


OBJASM = objasm

# ----------------------------------------------------------------- #
# Rules for making things - do not change.
# ----------------------------------------------------------------- #
	   
.SUFFIXES:	.o .c .s .cmhg
.cmhg.o:;	$(CMHG) $(CMHGFLAGS) -o $@ -d h.cmhg $<
.c.o:;		$(CC) $(CFLAGS) $<
.s.o:;		$(OBJASM) -from $< -to $@ -Predefine "ROM_BUILD SETL {FALSE}"


# ----------------------------------------------------------------- #
# Targets to be compiled
# ----------------------------------------------------------------- #

TARGETS = module.o header.o vectors.o DBUG.o ncma_cmds.o ncma_swis.o \
	  dynalloc.o ncma_ncma.o machine.o ncma_url.o ncma_scard.o \
	  ncma_utils.o resources.o ncma_dial.o usermode.o

RESDEP = html.badpin html.change html.damaged html.disconnect html.download \
	html.mismatch html.moved html.newpin html.notMA html.notNC html.pin \
	html.poweroff html.SCprobs html.splash html.transfer html.unblock \
	html.toplevel html.welcome

NCMA:	  	$(TARGETS)       
		$(LINK) $(LINKFLAGS) -o $@ $(TARGETS) $(LIBFILES) c:o.stubs

resources.o:	s.resources $(RESDEP)		

clean:;		@$(WIPE) o.* $(WIPEFLAGS)
	
# ----------------------------------------------------------------- #
					   
# Dynamic dependencies:

o.dynalloc:	c.dynalloc
o.dynalloc:	c:h.kernel
o.dynalloc:	c:h.swis
o.dynalloc:	h.dynalloc
o.dynalloc:	h.DBUG
o.ncma_dial:	c.ncma_dial
o.ncma_dial:	c:h.kernel
o.ncma_dial:	c:h.swis
o.ncma_dial:	h.ncma_dial
o.header:	cmhg.header
o.header:	C:h.cmhg_defs
o.DBUG:	c.DBUG
o.DBUG:	H.DBUG
o.ncma_swis:	c.ncma_swis
o.ncma_swis:	c:h.kernel
o.ncma_swis:	c:h.swis
o.ncma_swis:	h.ncma_swis
o.ncma_swis:	h.ncma_ncma
o.ncma_swis:	h.ncma_scard
o.ncma_swis:	h.dynalloc
o.ncma_swis:	h.module
o.ncma_swis:	h.DBUG
o.ncma_url:	c.ncma_url
o.ncma_url:	c:h.kernel
o.ncma_url:	c:h.swis
o.ncma_url:	h.ncma_ncma
o.ncma_url:	h.ncma_url
o.ncma_url:	h.ncma_scard
o.ncma_url:	h.DBUG
o.module:	c.module
o.module:	c:h.kernel
o.module:	c:h.swis
o.module:	h.module
o.module:	h.DBUG
o.module:	h.machine
o.module:	h.vectors
o.module:	h.ncma_cmds
o.module:	h.ncma_swis
o.module:	h.ncma_ncma
o.module:	h.ncma_scard
o.module:	h.dynalloc
o.vectors:	c.vectors
o.vectors:	c:h.kernel
o.vectors:	c:h.swis
o.vectors:	h.ncma_ncma
o.vectors:	h.machine
o.vectors:	h.vectors
o.vectors:	h.module
o.vectors:	h.DBUG
o.vectors:	h.scinter
o.ncma_ncma:	c.ncma_ncma
o.ncma_ncma:	c:h.kernel
o.ncma_ncma:	h.ncma_ncma
o.ncma_ncma:	h.ncma_url
o.ncma_ncma:	h.dynalloc
o.ncma_ncma:	h.module
o.ncma_ncma:	h.DBUG
o.ncma_ncma:	c:h.kernel
o.ncma_ncma:	c:h.swis
o.ncma_ncma:	h.machine
o.ncma_ncma:	h.vectors
o.ncma_cmds:	c.ncma_cmds
o.ncma_cmds:	c:h.kernel
o.ncma_cmds:	c:h.swis
o.ncma_cmds:	h.ncma_cmds
o.ncma_cmds:	h.ncma_ncma
o.ncma_cmds:	h.ncma_utils
o.ncma_cmds:	h.ncma_url
o.ncma_cmds:	h.ncma_scard
o.ncma_cmds:	h.machine
o.ncma_cmds:	h.vectors
o.ncma_cmds:	h.DBUG
o.machine:	c.machine
o.machine:	c:h.kernel
o.machine:	c:h.swis
o.machine:	h.machine
o.machine:	h.module
o.machine:	h.ncma_ncma
o.machine:	h.ncma_scard
o.machine:	h.ncma_url
o.machine:	h.ncma_utils
o.machine:	h.ncma_dial
o.machine:	h.vectors
o.machine:	h.DBUG
o.ncma_scard:	c.ncma_scard
o.ncma_scard:	c:h.kernel
o.ncma_scard:	c:h.swis
o.ncma_scard:	h.ncma_scard
o.ncma_scard:	h.ncma_url
o.ncma_scard:	h.ncma_utils
o.ncma_scard:	h.dynalloc
o.ncma_scard:	h.usermode
o.ncma_scard:	c:h.kernel
o.ncma_scard:	h.machine
o.ncma_scard:	h.vectors
o.ncma_scard:	h.DBUG
o.ncma_utils:	c.ncma_utils
o.ncma_utils:	c:h.kernel
o.ncma_utils:	c:h.swis
o.ncma_utils:	h.ncma_utils
o.ncma_utils:	h.ncma_scard
o.ncma_utils:	h.ncma_ncma
o.ncma_utils:	h.DBUG
