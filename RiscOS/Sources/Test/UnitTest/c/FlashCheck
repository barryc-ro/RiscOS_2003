/* >c.FlashCheck

ACORN TEST SOFTWARE (c) Acorn Computers Ltd. 1997

************************* CHANGE LIST *************************************

Vers    Date            Name    Comment
------  ---------       ---     -------------------------------------------
1.00    03 Sep 97       BAR     Initial writing - based on ROMCheck
1.01    08 Oct 97       BAR     Swap display & support includes
1.02    14 Oct 97       BAR     Changed to use AppFlash_Checksum SWI.
1.03    19 Nov 97       RLT     Changed AppFlash_Checksum SWI to correct
                                SWI no and modified the pass/fail check to
                                correctly calculate the test.


Will perform a checksum on the ROM.
*/

#include "kernel.h"
#include "swis.h"

#include "support.h"
#include "FlashCheck.h"
#include "display.h"

void Flash_Checksum(void)
{
        int status = FAILED;
        _kernel_swi_regs reg;
        int AppFlash_Checksum =0x50a01;

        display_status(FLASH,RUNNING);
        _kernel_swi(AppFlash_Checksum, &reg, &reg);
        if (reg.r[0] == 0){
                status=PASSED;
        }else{
                status=FAILED;
        }

        display_status(FLASH,status);
        log_status(FLASH,status);
}
