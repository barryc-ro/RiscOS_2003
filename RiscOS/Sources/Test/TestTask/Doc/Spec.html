<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<!-- Generated by TechWriter Professional+ 7.11 (10-Jun-00) -->
<HEAD><TITLE>&lt;ADFS::DEllis.$.!BOOT.Resources.!Scrap.ScrapDirs.ID57a26801.OLEfiles.mar214f88&gt;</TITLE></HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF">
<P>
 
<P>
Authors		:	Guy Rutter, Gary Stephenson, Nick Evans, Tony Jones

<P>
Date			:	13/09/01
<P>
Drawing Number 	:	2501,830/DS
<P>
Issue			:	1.7
<P ALIGN=CENTER>
<B><U>TestTask Commands For DSL4000</U></B>

<P>
<B><U>Document Description</U></B>
<P>
This document describes the interface protocol for communication with the PACE DSL4000 Test-Task software via the RS232 interface.
<U></U>
<U></U>
<U></U>
<U></U>
<P>
<B>Modifications since last release:</B>

<P>
1)	USB modified

<B></B>
<P>
<B><U>Outstanding</U></B>

<P>
 <U>Start-up</U>
<P>
When the STB is powered up the integrated Testtask outputs the command "AT" on the serial port. If the reply "\xFF\xAETest\xAF\xFF" is received within 100ms then the Testtask is initiated in preference to the usual boot sequence.

<P>
<U>Sequencing of Commands</U>
<P>
The Testtask accepts commands (in a packet structure - see below) and it acknowledges receipt of a correctly formatted  packet by outputting "\n." The command is then executed and a reply sent indicating success/failure or returning the requested value etc. (see body). After this the Testtask will then accept new commands. Any characters received not matching the command packet structure are ignored.

<P>
 
<P>
<U>Packet Structure</U>
<P>
SYNC, SYNC, COMMAND,LABEL, Number of Bytes , DATA

<P>
SYNC 		= 0xB1
<P>
(This SYNC character can be entered in a DOS programme by :-
<P>
Pressing and holding down ALT key, whilst ALT is held enter 177, then release ALT key)

<P>
COMMAND 	= ASCII

<P>
LABEL	= The server adds a single byte label to each packet.  TestTask must use the same
<P>
			label when responding to a command.  e.g. if the transmitted label is '0' then returned label is also '0',  label tx='3', label rx='3', etc.

<P>
Number of data bytes 	= ASCII encoded bytes count representing no bytes for transmission
<P>
Note that the number of bytes is encoded as ASCII(Num+48) so 0 to 9 = '0' to '9', 10 = ':', 11=';' etc....

<P>
Data		= Each byte of data is transmitted in its text representation as two ASCII chars
<P>
		   eg. to send 1 byte wide decimal value 200, the char string "C8" is transmitted.
<P>
In the body of this document the data associated with each command is either written literally (e.g. '01') or using a SINGLE lower case characters to represent each BYTE of data.


<P>
<B>NB :</B>
<P>
<B><FONT SIZE="-1">1) 	</FONT>Byte count is an unsigned integer, with most significant byte first, this is NOT ASCII coded.</B>
<P>
			   
<P>
<U> Command List DSL4000</U>
<DIV ALIGN=CENTER>
<TABLE BORDER=3 CELLPADDING=2>
<TR><TD WIDTH=114><B>Command Name</B>
<TD ALIGN=CENTER WIDTH=35><B>ASCII Value</B>
<TD WIDTH=158><B>Brief Description</B>
<TD ALIGN=CENTER WIDTH=29><B></B>
<TD ALIGN=CENTER WIDTH=29><B></B>
<TD ALIGN=CENTER WIDTH=31>
</TABLE>
</DIV>
<DIV ALIGN=CENTER>
<TABLE BORDER=3 CELLPADDING=2>
<TR><TD WIDTH=114><FONT SIZE="-2">Start Test</FONT>
<TD ALIGN=CENTER WIDTH=35><FONT SIZE="-2">'0'</FONT>
<TD WIDTH=158><FONT SIZE="-2">Go Into Test Mode</FONT>
<TD ALIGN=CENTER WIDTH=29><B></B>
<TD ALIGN=CENTER WIDTH=29>
<TD ALIGN=CENTER WIDTH=31>
<TR><TD><FONT SIZE="-2">RS232 Control Pins</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'1'</FONT>
<TD><FONT SIZE="-2">RTS/CTS Loopback</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Version numbers</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'2'</FONT>
<TD><FONT SIZE="-2">Obtain version numbers</FONT>
<TD ALIGN=CENTER><B><FONT SIZE="-2"> </FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Memory Tests</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'3'</FONT>
<TD><FONT SIZE="-2">Memory tests</FONT>
<TD ALIGN=CENTER><B><FONT SIZE="-2"> </FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'4'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Sound Stereo</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'5'</FONT>
<TD><FONT SIZE="-2">Controls stereo panning for MPEG audio</FONT>
<TD ALIGN=CENTER><B><FONT SIZE="-2"> </FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Sound Control</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'6'</FONT>
<TD><FONT SIZE="-2">Contols 7500FE generated sound.</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">LEDs</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'7'</FONT>
<TD><FONT SIZE="-2">Control the LEDs on the front panel</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Transmit RC5 IR</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'8'</FONT>
<TD><FONT SIZE="-2">Transmit RC5 IR</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
</TABLE>
</DIV>
<DIV ALIGN=CENTER>
<TABLE BORDER=3 CELLPADDING=2>
<TR><TD WIDTH=114><FONT SIZE="-2">Enable Keys/IR</FONT>
<TD ALIGN=CENTER WIDTH=35><FONT SIZE="-2">'9'</FONT>
<TD WIDTH=158><FONT SIZE="-2">The Key/IR register is echoed if it changes</FONT>
<TD ALIGN=CENTER WIDTH=29><B></B>
<TD ALIGN=CENTER WIDTH=29>
<TD ALIGN=CENTER WIDTH=31>
</TABLE>
</DIV>
<DIV ALIGN=CENTER>
<TABLE BORDER=3 CELLPADDING=2>
<TR><TD WIDTH=114><FONT SIZE="-2">Ethernet test</FONT>
<TD ALIGN=CENTER WIDTH=35><FONT SIZE="-2">'A'</FONT>
<TD WIDTH=158><FONT SIZE="-2">Ethernet echo test</FONT>
<TD ALIGN=CENTER WIDTH=29><B></B>
<TD ALIGN=CENTER WIDTH=29>
<TD ALIGN=CENTER WIDTH=31>
<TR><TD><FONT SIZE="-2">Mouse Test</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'B'</FONT>
<TD><FONT SIZE="-2">Tests the mouse input</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">PS/22 Keyboard Test</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'C'</FONT>
<TD><FONT SIZE="-2">Tests the PS/22 keyboard input</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">PS/22 Keyboard/Mouse Test</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'D'</FONT>
<TD><FONT SIZE="-2">PS/2 loopback test</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Verify I<SUP>2</SUP>C Channels</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'E'</FONT>
<TD><FONT SIZE="-2">Check all the devices on the I<SUP>2</SUP>C buss</FONT>
<TD ALIGN=CENTER><B><FONT SIZE="-2"> </FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'F'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Reset EEProm</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'G'</FONT>
<TD><FONT SIZE="-2">Reset full EEProm</FONT>
<TD ALIGN=CENTER><B><FONT SIZE="-2"> </FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Configure Modulator</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'H'</FONT>
<TD><FONT SIZE="-2">Set the TV standard and channel</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Modulator Control</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'I'</FONT>
<TD><FONT SIZE="-2">Modulator ON/OFF</FONT>
<TD ALIGN=CENTER><B><FONT SIZE="-2"> </FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Pseudo PAL</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'J'</FONT>
<TD><FONT SIZE="-2">Pseudo PAL</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Parallel Test</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'K'</FONT>
<TD><FONT SIZE="-2">Tests the parallel Port</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'L'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'M'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'N'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Generate OSG and test pattern</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'O'</FONT>
<TD><FONT SIZE="-2">STB displays OSG or a test pattern</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">MPEG full and &frac14; screen size </FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'P'</FONT>
<TD><FONT SIZE="-2">MPEG full and &frac14; screen size </FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'Q'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'R'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Serialisation Set</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'S'</FONT>
<TD><FONT SIZE="-2">Sets serialisation into EEPROM</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">General Debug</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'T'</FONT>
<TD><FONT SIZE="-2">Enable/disable debug</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">USB Control</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'U'</FONT>
<TD><FONT SIZE="-2">Detects USB devices</FONT>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">AC3 Control</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'V'</FONT>
<TD><FONT SIZE="-2">Controls AC3 on/off</FONT>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'W'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Flash Checksum</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'X'</FONT>
<TD><FONT SIZE="-2">Return checksum for on board flash chips</FONT>
<TD ALIGN=CENTER><B><FONT SIZE="-2"> </FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'Y'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Set MPEG Channel</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'Z'</FONT>
<TD><FONT SIZE="-2">Setup MPEG Channel</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Product ID</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">':'</FONT>
<TD><FONT SIZE="-2">Identifies Product and Test-Task version</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">';'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Serialisation</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'&lt;'</FONT>
<TD><FONT SIZE="-2">Read Serialisation </FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Read OS Version</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'='</FONT>
<TD><FONT SIZE="-2">Read OS version</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Play MPEG </FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'&gt;'</FONT>
<TD><FONT SIZE="-2">Play MPEG video from a multicast stream</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">RGB Test Banner Control</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'?'</FONT>
<TD><FONT SIZE="-2">Turn Test Banner on/off</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER>
<TD ALIGN=CENTER>
<TR><TD><FONT SIZE="-2">Flash Device ID</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'!'</FONT>
<TD><FONT SIZE="-2">Flash Device ID</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'"'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'#'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'$'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD><FONT SIZE="-2">CL-PS7500FE Peek and Poke</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'%'</FONT>
<TD><FONT SIZE="-2">Gets and Sets CL-PS7500FE registers</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'&amp;'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'''</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'('</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">')'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">'*'</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD><FONT SIZE="-2">Direct Pin Control</FONT>
<TD ALIGN=CENTER><FONT SIZE="-2">'+'</FONT>
<TD><FONT SIZE="-2">Control the SCART pins</FONT>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
<TR><TD>
<TD ALIGN=CENTER><FONT SIZE="-2">','</FONT>
<TD>
<TD ALIGN=CENTER><B><FONT SIZE="-2">-</FONT></B>
<TD ALIGN=CENTER><B></B>
<TD ALIGN=CENTER><B></B>
</TABLE>
</DIV>
<DIV ALIGN=CENTER>
<TABLE BORDER=3 CELLPADDING=2>
<TR><TD WIDTH=114>
<TD ALIGN=CENTER WIDTH=35>
<TD WIDTH=158>
<TD ALIGN=CENTER WIDTH=29><B></B>
<TD ALIGN=CENTER WIDTH=29><B></B>
<TD ALIGN=CENTER WIDTH=31><B></B>
</TABLE>
</DIV>
<P>
<B><FONT SIZE="-1">	- Implemented</FONT></B>
<P>
<B><FONT SIZE="-1">x	- No Longer Applicable</FONT></B>
<P>
<B><FONT SIZE="-1">-	- Not Applicable to this model</FONT></B>
<P>
<B><FONT SIZE="-1">??	- Implementation requires modification to standard command, or implementation unsure.</FONT></B>
<P>
<B><FONT SIZE="-1">**	- Command implemented on another product for different purpose as that listed here.</FONT></B>
<P>
<B><FONT SIZE="-1">O - Not Implemented at document date, but implementation required for future STB software releases</FONT></B>
<P ALIGN=CENTER>
<U>Command Descriptions</U>

<P>
<U>Command ASCII `0' - Start Test</U>
<P>
This command puts the receiver into test mode, all other test commands can then be recognised.

<P>
Transmit	:	:	'**000'
<P>
Ret			:	'**000'

<P>
<B>N.B. ** - SYNC,SYNC</B>
<B><U></U></B>
<B><U></U></B>
<P>
<U>Command ASCII `1' - RTS/CTS Loopback</U>
<P>
The RTS and CTS lines on the serial port must be physically linked together.  Test task
<P>
checks that CTS goes low when RTS is set low and that CTS goes high when RTS is set high. 			
<P>
Transmit		: '**101a'	a - 	0=RTS Low
<P>
							1=RTS High

<P>
Return		: '**101b'	b -	0 - CTS Low
<P>
1 - CTS High

<P>
<B>Note: Send RTS high twice for CTS high.</B>
<U></U>
<U></U>
<P>
<U>Command ASCII '2' Obtain Version Numbers</U>
<P>
The receiver returns the version of main code, ARM ID, IOMD ID, IOMD, ST3520 and DENC version.

<P>
Transmit			: '**200'

<P>
Return			: '**20@b<SUB>1</SUB>b<SUB>2</SUB>b<SUB>3</SUB>c<SUB>1</SUB>c<SUB>2</SUB>c<SUB>3</SUB>c<SUB>4</SUB>d<SUB>1</SUB>d<SUB>2</SUB>e<SUB>1</SUB>e<SUB>2</SUB>e<SUB>3</SUB>f<SUB>1</SUB>f<SUB>2</SUB>f<SUB>3</SUB>f<SUB>4</SUB>'
<P>
					b<SUB>1</SUB>b<SUB>2</SUB>b<SUB>3  </SUB>		-	ARM chip ID 
<P>
					c<SUB>1</SUB>c<SUB>2</SUB>c<SUB>3</SUB>c<SUB>4		</SUB>-	IOMD ID
<P>
					d<SUB>1</SUB>d<SUB>2</SUB>			-	IOMD version
<P>
					e<SUB>1			</SUB>-	Sti3520 ID	0 - Sti3520L,	1 - Sti3520A
<P>
e<SUB>2</SUB>e<SUB>3</SUB>			- 	STi3520 revision
<P>
f<SUB>1</SUB> 			-	DENC Type<SUB></SUB>
<P>
f<SUB>2</SUB>f<SUB>3</SUB>			-	Chip ID
<P>
f<SUB>4</SUB> 			-	DENC revision

<P>
<B>Note :</B> <B>If the DENC type is not 1 the Chip ID and revision will not be returned.</B>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<P>
<U>Command ASCII `3' - Memory Tests</U>
<P>
This command carries out the testing of all memory devices.

<P>
Transmit	:	:	'**30xab<SUB>1</SUB>b<SUB>2</SUB>'
<P>
						x	-	byte count
<P>
						a 	- 	0 = MPEG SDRAM
<P>
					     			1 = DRAM
<P>
					    			2 = Masked ROM
<P>
					     			3 = Flash 

<P>
						b<SUB>1</SUB>b<SUB>2</SUB>	-	DRAM size in MB
<P>
								(only include if a = 1)

<P>
Return		:	'**302ab'		a	-	device
<P>
								b 	- 	0 - OK
<P>
										1 - FAIL

<P>
<U>Command ASCII `4' -</U>
<U></U>
<U></U>
<P>
<U>Command ASCII `5' - Sound Stereo</U>
<P>
Controls stereo panning for MPEG audio.

<P>
Transmit		:	'**501a'		a - 0 - Both channels on
<P>
							     1 - Left channel off only
<P>
							     2 - Right channel off only

<P>
Return		: 	'**500'

<U></U>
<P>
<U>Command ASCII `6' - Sound Control</U>
<P>
Passes parameters to the Sound_Control SWI.  Makes an immediate sound.

<P>
Transmit		: 	'**60;aaaaabbbbbc'
<P>
aaaaa		-	Frequency in Hz (00000-20000)
<P>
					      	bbbbb		- 	Amplitude (0000-32767)
<P>
					c			- 	0 - Mute
<P>
1 - Left only
<P>
2 - Right Only 
<P>
3 - Both							<SUB></SUB>
<P>
Return		: 	'**600'

<P>
To mute the audio DACs use the following:

<P>
Transmit		:	**'601a'			a  - 	0 - mute
<P>
								1 - un-mute 
<P>
Return 		:	'**600'

<U></U>
<U></U>
<P>
<U>Command ASCII `7' - LEDS command</U>
<P>
This command controls the LEDS on the front panel.

<P>
Transmit		: 	'**702ab'	a - Standby LED 
<P>
							b - Active LED 
<P>
							1 - 	ON
<P>
0 -	OFF

<P>
Return		: 	'**700'
<U></U>
<U></U>
<P>
<U>Command ASCII `8' - Generate RC5 IR</U>
<P>
STB send RC5 IR code.  When 'Enable Keys' is enabled this should return the RC5 code transmitted.

<P>
Transmit		:	'**80abb'		a - byte count
<P>
								bb -  RC5 command 0 - 63 (ASCII coded decimal)


<P>
Return		:	'**800'<U></U>
<U></U>
<U></U>
<P>
<U>Command ASCII `9' - Enable Keys/IR</U>
<P>
This enables the front panel keys and IR.  Once enabled any key press or IR received is echoed back.

<P>
Transmit		: 	'**901a'			a - 1 - Enable
<P>
				      				     0 - Disable

<P>
Return		: 	'**904aaaa'		a - IR/Key code

<P>
Return		: 	'**900' 		When Enable/Disable command sent
<U></U>
<U></U>
<P>
<U>Command ASCII `A' Ethernet Test</U>
<P>
The Ethernet Test first checks the st_link_status[2] bit provided by the Ethernet driver.  This indicates that the interface self-test has passed.  The test then attempts to connect to the echo port on the specified server.  If the connection is successful a known sequence of data is sent to the echo port and test task checks that the data is echoed back correctly.  

<P>
Transmit	:	'**A00'		- will not attempt to connect to an echo port

<P>
Transmit	:	'**A0?aaa.bbb.ccc.ddd'   	

<P>
aaa.bbb.ccc.ddd - server IP address in 'dotted quad' notation 

<P>
Return		:	'**A02ab'					a - self test
<P>
b - 	echo test
<P>
  	0 -  	OK
<P>
					      	    					1 -  	Fail

<P>
<U>Command ASCII 'B' Mouse Test</U>
<P>
Returns the current state of the mouse pointer (-32768 to 32767) and buttons.

<P>
Transmit		:	'**B00'

<P>
Return		:	'**B0=b<SUB>1</SUB>b<SUB>2</SUB>b<SUB>3</SUB>b<SUB>4</SUB>b<SUB>5</SUB>d<SUB>1</SUB>d<SUB>2</SUB>d<SUB>3</SUB>d<SUB>4</SUB>d<SUB>5</SUB>efg' 	
<P>
		
<P>
b<SUB>1</SUB>b<SUB>2</SUB>b<SUB>3</SUB>b<SUB>4</SUB>b<SUB>5  	</SUB>- 00000-32768  	mouse X
<P>
d<SUB>1</SUB>d<SUB>2</SUB>d<SUB>3</SUB>d<SUB>4</SUB>d<SUB>5   	</SUB>- 00000-32768<SUB> </SUB>   	mouse Y
<P>
			e	      		- left mouse button, 		1 - ON, 0 - OFF
<P>
			f	      		- middle mouse button, 	1 - ON, 0 - OFF
<P>
			g	      		- right mouse button		1 - ON, 0 - OFF

<U></U>
<P>
<U>Command ASCII `C' PS2 Keyboard Test</U>
<P>
Read a byte from the keyboard buffer.

<P>
Transmit	:	:	'**C011'

<P>
Return		:	'**C01a'	a - Contents of keyboard buffer

<P>
OR if the buffer is empty :

<P>
Return		:	'**C00'

<P>
Flush the keyboard buffer.

<P>
Transmit	:	:	'**C012'	

<P>
Return		:	'**C00'	
<U></U>
<U></U>
<P>
<U>Command ASCII `D'  PS2 Keyboard/Mouse Test</U>
<P>
Tests the PS/2 keyboard and mouse interfaces using a loopback cable between the keyboard and mouse inputs.

<P>
Transmit 	:	'**D00'

<P>
Receive		:	'**D02ab'	a - Clock = 0 - Pass, 1 - Fail
<P>
							b - Data  = 0 - Pass, 1- Fail


<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<P>
<U>Command ASCII 'E' Verify I<SUP>2</SUP>C Channels</U>
<P>
Check all the devices on the I<SUP>2</SUP>C bus.

<P>
Transmit		:	'**E00'

<P>
Return		:	'**E04abcd'	a-d  		0  - OK
<P>
						       	1  - 	Fail
<P>
								       	X - 	Unable to test

<P>
									a	-	EEPROM
<P>
									b	-	Modulator
<P>
							c	-	DENC
<P>
							d	-	TDA8540T


<P>
<U>Command ASCII `F' -</U>
<U></U>
<U></U>
<P>
<U>Command ASCII `G' - Reset EEPROM</U>
<P>
Corrupts the EEPROM checksum so that the EEPROM is reset when the STB powered on.

<P>
Transmit		:	'**G00'

<P>
Return		: 	'**G01a'		a -	 0 -  OK
<P>
					     			 1 -  Fail
<P>
	

<P>
<U>Command ASCII 'H' Configure Modulator</U>
<P>
Sets the TV Standard  (e.g. PAL-I) and Channel (e.g. "21").

<P>
Transmit		:	"**H0abc<SUB>1</SUB>..cnd<SUB>1</SUB>..dn"		a     - 	total number of data bytes
<P>
						b    -	number of channel bytes (1-3)
<P>
										c<SUB>1</SUB>..cn -	channel
<P>
						d<SUB>1</SUB>..dn -    standard

<P>
						e.g 	*'*H08232PAL-I' for UHF 32 PAL-I
<P>
Return		:	"**H00"
<U></U>
<U></U>
<P>
<U>Command ASCII 'I' RF ----Modulator On/Off</U>
<P>
Switch the RF Modulator On/Off.

<P>
Transmit		:	"**I01a"		a -	0 - On
<P>
								1 - Off		
<P>
Return		:	"**I00"						
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<P>
<U>Command ASCII `J' - Pseudo PAL</U>
<P>
This toggles between system mode and PAL mode.
<U></U>
<P>
Transmit		:	'**J01a'		a - 0 - Normal system mode
<P>
								1 - PAL
<P>
Return		:	'**J00'

<P>
<B>Note : This command must be sent before video is played.</B>

<U></U>
<P>
<U>Command ASCII `K' - Test Parallel Port</U>
<P>
This command enables testing of the parallel port via an external piece of logic.

<P>
Automatic 'walking 0'.  Produces a 'walking 0' pattern on pins 1-9 and 14-17 (see table STB 400 Test List Fig 3.1).

<P>
Transmit		: 	'**K011'
<P>
	
<P>
Return		: 	'**K01a<SUB>1</SUB>a<SUB>2</SUB>'		 a - 00 = Pass
<P>
								If  fail occurs a pin number is returned. (01-09, 14-17)
<P>
	
<P>
Manual Walking '0's.

<P>
Transmit		: 	'**K02bb'	bb = 01-09 or 14-17 - Set appropriate pin low.

<P>
Return		: 	'**K02a<SUB>1</SUB>a<SUB>2</SUB>'		a - 00 = Pass
<P>
								If  fail occurs a pin number is returned (01-09, 14-17)

<P>
Read the status register.

<P>
Transmit			: 	'**K012'

<P>
Status Return 	:	'**K05b<SUB>1</SUB>b<SUB>2</SUB>b<SUB>3</SUB>b<SUB>4</SUB>b<SUB>5</SUB>'		b - Status of port
<U></U>
<U></U>
<P>
<U>Command ASCII `L' -</U>
<U></U>
<U></U>
<P>
<U>Command ASCII `M' - </U>
<U></U>
<U></U>
<P>
<U>Command ASCII `N' - </U>
<U></U>
<U></U>
<P>
<U>Command ASCII `O' - Generate OSG / Test Pattern</U>
<P>
This command displays the STB's OSG or a test pattern

<P>
Transmit		:	'**O01a'		a - 0 - OSG
<P>
						     1 - Test Pattern
<P>
Return		:	'**O00'

<P>
<B>Note:  To switch off the OSG/pattern send the RGB Banner off command.</B>
<U></U>
<U></U>
<P>
<U>Command ASCII `P' - MPEG Full and &frac14; screen size</U>
<P>
This command changes the screen size between Full and &frac14; .

<P>
Transmit		:	'**P01a'		a - 0 - Full Screen
<P>
						     1 - &frac14; screen
<P>
Return		:	'**P00'
<U></U>
<P>
<U>Command ASCII `Q' - </U>
<U></U>
<U></U>
<U></U>
<P>
<U>Command ASCII `R' - </U>
<U></U>
<U></U>
<P>
<U>Command ASCII 'S' - Set Serialisation</U>
<P>
This command requests the product to write the serial number into EEPROM.  See '&lt;' command to read back out. <B>Note. The MAC address is used as a unique serial number.</B>

<P>
Transmit		:	'**S0&lt;a<SUB>1</SUB>a<SUB>2</SUB>a<SUB>3</SUB>a<SUB>4</SUB>a<SUB>5</SUB>a<SUB>6</SUB>a<SUB>7</SUB>a<SUB>8</SUB>a<SUB>9</SUB>a<SUB>10</SUB>a<SUB>11</SUB>a<SUB>12</SUB>'

<P>
a<SUB>1</SUB>a<SUB>2</SUB>a<SUB>3</SUB>a<SUB>4</SUB>a<SUB>5</SUB>a<SUB>6</SUB>a<SUB>7</SUB>a<SUB>8</SUB>a<SUB>9</SUB>a<SUB>10</SUB>a<SUB>11</SUB>a<SUB>12 	</SUB>- MAC address

<P>
Return		:	'**S01a'			a -  	0 - OK
<P>
							       	       1 - Fail

<P>
			<U></U>
<P>
<U>Command ASCII `T' - General Debug </U>
<P>
Toggles on screen debug information. 

<P>
Transmit		:	'**T01a'		a =	1 - Debug ON
<P>
				      				0 - Debug OFF

<P>
Return 		:	'**T00'

<P>
A debug command with no data terminates TestTask.

<P>
Transmit		:	'**T00' Exit test tesk

<P>
Return		:	'**T00'	(before exiting)









<U></U>
<P>
<U>Command ASCII `U' - Check USB</U>
<P>
This command checks that a USB device is connected, it returns the Chip ID and device descriptor.
<B></B>
<P>
Transmit	: '**U01a'				a - 1 - Check Chip ID
<P>
					            	2 - Check Device descriptor

<P>
<B>Form 1</B>
<P>
Return		: '**U0xaaaa'			x - byte count
<P>
aaaa - Chip ID

<P>
<B>Form 2</B>
<P>
Return		: '**U0@b1..b16'		b - Device descriptor 16 bytes HEX ASCII

<U></U>
<P>
<U>Command ASCII `V' - AC3 Audio</U>
<P>
This command controls AC3 audio from the external module

<P>
Transmit	: '**V01a'			a - 0 - AC3 Off (normal stereo)
<P>
					            1 - AC3 On

<P>
Return		: '**V00'

<U></U>
<P>
<U>Command ASCII `W' - </U>
<U></U>
<U></U>
<P>
<U>Command ASCII `X' - Return checksum for Flash chips</U>
<P>
This command returns the checksum for the on board flash chips.

<P>
Transmit		:	'**X00'	
<P>
							

<P>
Return			:	'**X08a<SUB>1</SUB>a<SUB>2</SUB>a<SUB>3</SUB>a<SUB>4</SUB>a<SUB>5</SUB>a<SUB>6</SUB>a<SUB>7</SUB>a<SUB>8</SUB>'	 	a<SUB>1</SUB>a<SUB>2</SUB>a<SUB>3</SUB>a<SUB>4</SUB>a<SUB>5</SUB>a<SUB>6</SUB>a<SUB>7</SUB>a<SUB>8 </SUB>- 32 bit check		

<P>
The checksum is generated by exor-ing the 32 bit word and its address (relative to the flash itself) and then adding all the results, discarding the overflow.<U></U>
<U></U>
<U></U>
<P>
<U>Command ASCII `Y' - </U>
<U></U>
<U></U>
<P>
<U>Command ASCII `Z' - Setup MPEG Channel</U>
<P>
This command sets the MPEG channel to use

<P>
Transmit		:	'**Z0Oa1....an		a1..an - Channel setup

<P>
Return		: 	'**Z00'

<P>
e.g. <TT>Z0O1_MPEG2(live)_239.192.1.5/55555</TT>
<TT></TT>
<U></U>
<P>
<U>Command ASCII `:' - ID of Product</U>
<P>
This command returns the product ID variant version and 'test-task' version.

<P>
Transmit		:	'**:00'

<P>
Return		:	'**:06aabbcc		aa - Product
<P>
								bb - variant of product
<P>
 								cc -	test-task software version


<P>
<U>Command ASCII `;' - </U>
<U></U>
<U></U>
<P>
<U>Command ASCII `&lt;' - Serialisation</U>
<P>
This command checks and returns the MAC address.  Fail is returned if the information cannot be read from EEPROM.

<P>
Transmit		: 	'**&lt;00'	
<U></U>
<P>
Return		:	'**&lt;0&lt;a<SUB>1</SUB>a<SUB>2</SUB>a<SUB>3</SUB>a<SUB>4</SUB>a<SUB>5</SUB>a<SUB>6</SUB>a<SUB>7</SUB>a<SUB>8</SUB>a<SUB>9</SUB>a<SUB>10</SUB>a<SUB>11</SUB>a<SUB>12</SUB>'
<P>
	
<P>
						a<SUB>1</SUB>a<SUB>2</SUB>a<SUB>3</SUB>a<SUB>4</SUB>a<SUB>5</SUB>a<SUB>6</SUB>a<SUB>7</SUB>a<SUB>8</SUB>a<SUB>9</SUB>a<SUB>10</SUB>a<SUB>11</SUB>a<SUB>12 - </SUB>MAC address
<U></U>
<U></U>
<P>
<U>Command ASCII `=' - Read OS version</U>
<P>
This command returns the OS version.


<P>
Transmit		: 	'**=00'

<P>
Return		:	'**ab<SUB>1..</SUB>bn'	- OS version

<P>
		
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<U></U>
<P>
<U>Command ASCII `&gt;' Play MPEG </U>
<P>
Plays MPEG video from a multicast stream.

<P>
Transmit		:	'**&gt;0ab<SUB>1</SUB>..bn'		a - byte count
<P>
								b<SUB>1</SUB>..bn - video URL 

<P>
Return 		:	'**&gt;00'

<P>
A play MPEG command with no data means stop video playback.
<U></U>
<P>
Transmit		:	'**&gt;00'
<P>
					
<P>
Return 		:	'**&gt;00'
<U></U>
<U></U>
<P>
<U>Command ASCII '?' - Test Banner Control</U>
<P>
Turns the RGB test screen on/off.

<P>
Transmit		:	'**?01a'		a - 	0 - Banner OFF
<P>
								1 - RGB Banner ON
<P>
								2 - White Pattern ON
<P>
Return		:	'**?00'
<U></U>
<U></U>
<P>
<U>Command ASCII `!' - Flash Manuf+Device ID</U>
<P>
The second form is to get the flash device and manufacturer code.

<P>
Transmit		:	'**!00'		

<P>
Return		: 	'**!04aabb'                aa - Manufacturer ID
<P>
								    bb - Device ID
<U></U>
<U></U>
<P>
<U>Command ASCII `%' - CL-PS7500FE Peek and Poke</U>
<P>
This maps directly to the Peek and Poke function on the CL-PS7500FE to give access to the programmable registers. There are over 100 of these in addition to ARM processor.  Details of the CL-PS7500FE are listed in the CL-PS7500FE data book[1].

<P>
Packet size determines whether to peek or poke.

<P>
Peek Form:
<P>
Transmit		:	'**%02aa'	aa - Register Code for ARM ascii encoded hex

<P>
Return		:	'**%02bb'	bb - Value returned by ARM ascii encoded hex

<P>
Poke Form:<U></U>
<P>
Transmit		:	'**%04aabb'	aa - 	Register Code for ARM ascii encoded hex
<P>
							bb - byte to poke ascii encoded 

<P>
Return		:	'**%00'
<U></U>
<P>
<U>Command ASCII `+' - Direct Pin Control</U>
<P>
This command controls the pins with regard to SCART's.

<P>
Transmit		: 	'**+01a'	a-	0 - TV pin8	0V
<P>
							1 - TV pin8	6V  (16:9)
<P>
2 - TV pin8	12V (4:3) 
<P>
3 -TV pin16	0V
<P>
4 - TV pin16	5V

<P>
Return		:	'**+00'
<U></U>
<U></U>
<P>
<U>References</U>
<U></U>
<P>
1 - CL-PS7500FE Advance Data Book <A HREF="http://www.cirrus.com/products/overviews/ps7500fe.html">http://www.cirrus.com/products/overviews/ps7500fe.html</A>

<P>
2 - DCI-4 Functional Specification, 0284,036/FS

</BODY>
</HTML>
