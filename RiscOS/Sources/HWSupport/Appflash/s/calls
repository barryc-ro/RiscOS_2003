; Routines for Flash Update module

I_bit	*	(1:SHL:27)

	AREA	|C$$code|, CODE, READONLY


	EXPORT	|asm_irqs_off|[LEAF]
|asm_irqs_off|
	ORRS	pc, lr, #&0C000000


	EXPORT	|asm_irqs_on|[LEAF]
|asm_irqs_on|
	BICS	pc, lr, #&0C000000

	EXPORT	|asm_write_enable|[LEAF]
|asm_write_enable|
	STMFD	sp!, {r1}
	
	LDR	r1,[r0]
	ORRS	r1,r1,#&80
	STR	r1,[r0]
	
	LDMFD	sp!, {r1}

	MOVS	pc, lr	

	EXPORT	|asm_write_disable|[LEAF]
|asm_write_disable|
	STMFD	sp!, {r1}
	
	LDR	r1,[r0]
	BICS	r1,r1,#&80
	STR	r1,[r0]
	
	LDMFD	sp!, {r1}

	MOVS	pc, lr	

	END
	
