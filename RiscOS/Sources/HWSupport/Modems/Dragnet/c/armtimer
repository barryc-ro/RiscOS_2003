/*name and version number:@(#)armtimer.c	1.1*/
/*date of get: 		  01/12/01 11:49:20*/
/*date of delta:	  01/12/01 11:25:03*/
#include "llglob_d.h"
#include "arm_glob.h"
#include "allglobs.h"

void
arm_timer_init( void )
{
	x_timer = 0;

#if defined(YS)
	// Mosquito must be polled <1.3ms to support 115.2Kbps
	// 1 ms @ 26Mhz
    PWM_Ptr->PWM_ITMAX_COUNT_0 = 1*0xcb2;
    PWM_Ptr->PWM_ITCOUNT_0 = 1*0xcb2;
#else
			// 4 ms @ 26Mhz
    PWM_Ptr->PWM_ITMAX_COUNT_0 = 4*0xcb2;
    PWM_Ptr->PWM_ITCOUNT_0 = 4*0xcb2;
#endif
    
	PWM_Ptr->PWM_CONTROL = 0;
	PWM_Ptr->PWM_MASK = PWM_MASK_I0E;
	// 1 ms
    PWM_Ptr->PWM_COUNT_RATE = PWM_COUNT_RATE_PWM_2
		| PWM_COUNT_RATE_WT_2
		| PWM_COUNT_RATE_IT_8;  // last one is the TIMER Divider

	// Start only timer 0 spinning, TIMER macros will do the rest for 1, 2 and 3
	// Timer 0 will give 1ms tick after interrupt is enabled
    PWM_Ptr->PWM_CONTROL = PWM_CONTROL_IT0E;
}
