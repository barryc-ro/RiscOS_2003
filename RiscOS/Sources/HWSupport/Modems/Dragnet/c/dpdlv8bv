/*name and version number:@(#)dpdlv8bv.c	1.10*/
/*date of get: 		  10/03/00 17:08:48*/
/*date of delta:	  09/29/00 14:27:47*/
/****************************************************************
File :  dpv8biv.c
Description :
	Venus V.8bis download

Procedures Contained :
	dp_download_v8bis()

*****************************************************************/

#include "llglob_d.h"

#if defined(V8BIS) || defined(V92)
#include "dpglob.h"
//msm// #include "z80glob.h"

#include "dpv8biv.h"
#include "allglobs.h"

/****************************************************************
Routine : dp_download_V8bis
Description :
	Download the DSP code to do V.8bis.
*****************************************************************/
void dp_download_V8bis( void )
{
	#if defined(CS_4)
	if ( G(sa_v8bisDnload) )
	{
		printf("v.8bis-code already loaded\n");
		return;
	}
	#endif // CS_4

	dp_modem_command(MODEM_IDLE, 0, 0);
	DOWNLOAD_DSP(wV8bis);
	dp_modem_command(MODEM_IDLE, 0, 0);

	#if defined(CS_4)
	// change ROM callback for CS-4
	// e.g. patch the patch
	// printf("CS-4: Patch at 0x0dbd=0x6759\n");
	dp_write_dsp_ram ( 0xdbd, 0x6759 ) ;
	G(sa_v8bisDnload) = TRUE;
	#endif  // CS_4

	dp_startup_prime_pump();
}

#endif	//V8BIS || V92
