/*name and version number:@(#)v_xchg.h	1.4*/
/*date of get: 		  09/06/00 16:59:36*/
/*date of delta:	  05/22/00 13:50:52*/
/*****************************************************************************
** File        : v_xchg.h                                                  *
** Version     : 2.2                                                         *
**---------------------------------------------------------------------------*
** Description :                                                             *
**   This file should be included by any modules wishing to use the basic    *
** media exchanger (i.e. currently main.c)                                   *
**---------------------------------------------------------------------------*
**                               HISTORY                                     *
** Date            Ver   Dev  Comments                                       *
** 31st Oct  1998  1.0   RGT  Initial Revision                               *
**                                                                           *
**[Release 2]----------------------------------------------------------------*
** Date            Ver   Dev  Comments                                       *
** 25th Jan  1999  2.0   RGT  Re-write for new architecture. Created structs *
**                            for core exchanger process, plus external refs *
**                            to RTP/IFP and test library modules.           *
**                                                                           *
** 16th Feb  1999  2.1   RGT  Added in prototype for set_coder - this should *
**                            have been in on the last version but was not   *
**                            used.                                          *
**                                                                           *
**                                                                           *
** 20th Apr  1999  2.2   RGT  Changed library declarations these are not in  *
**                            non-banked memory now (there were problems).   *
**                            Also pruned many state machine structure items *
**                            that are now handled in the new stats engine.  *
**                            Changed the library return values from Bool to *
**                            ENUM type to improve classification of errors. *
**                                                                           *
** 5th  May  1999  2.3   RGT  Added peakJitter element to transmit structure *
**                            for dynamic buildout in non silence supp. mode *
**                                                                           *
******************************************************************************/
#if !defined __XCHG_H__
	#define __XCHG_H__

	#include <v_defs.h>	// for access to standard type definitions 

/****************************************************************************
          ####   ###   #   #   ###  #####   ###  #   #  #####  ###
         #      #   #  ##  #  #       #    #   # ##  #    #   #
         #      #   #  # # #   ###    #    ##### # # #    #    ###
         #      #   #  #  ##      #   #    #   # #  ##    #       #
          ####   ###   #   #  ####    #    #   # #   #    #   ####
*****************************************************************************/

	/*************************************************
	** queue_frame function return values            *
	**************************************************/
		#define	TOO_OLD		2
		#define	QUEUED		4
		#define DUPLICATE	8
		#define OVERLOAD	0xFF

	/************************************************
	** Packet Types - should be in v_pnet.h really ! *
	*************************************************/
		#define PNET_MEDIA	0x00
		#define RAW_MEDIA	0x10
		#define CMD_PKT		0x20

/****************************************************************************
                #   #   ###    ####  ####    ###    ###
                ## ##  #   #  #      #   #  #   #  #
                # # #  #####  #      ####   #   #   ###
                #   #  #   #  #      #  #   #   #      #
                #   #  #   #   ####  #   #   ###   ####
*****************************************************************************/


/****************************************************************************
            #####  #   #  ####   #####  ####   #####  #####  ###
              #    #   #  #   #  #      #   #  #      #     #
              #     ###   ####   ###    #   #  ###    ###    ###
              #      #    #      #      #   #  #      #         #
              #      #    #      #####  ####   #####  #     ####
*****************************************************************************/
	#ifndef ASSEMBLER

		struct voip_globs;
		typedef struct voip_globs VGLOB;

		typedef struct {
			byte	* nextFreeByte;
			void	  (*lib)(VGLOB *, frame_t *);
			void	  (*config)(VGLOB *);
			byte	  pktIndex;
			byte	  frameIndex;
			byte	  pstnTransDelay;
		} rxExchangerInfo_t;

		typedef struct {
			void	  (*lib)(VGLOB *, packet_t *);
			void	  (*config)(VGLOB *);
			word	  lastFrameID;
			word	  jitter;
			word	  peakJitter;
			byte	  pktIndex;
			byte	  frameIndex;
			byte	  pnetTransDelay;
		} txExchangerInfo_t;


		typedef struct {
			rxExchangerInfo_t	rx;
			txExchangerInfo_t	tx;
		} exchangerSM_t;

		typedef enum {
			OKAY = 0,          FAX_FRAME,      VOICE_FRAME,    
			RTP_BAD_CODEC,     RTP_BAD_PKT,   
			IFP_BAD_FRAME,     IFP_BAD_PKT,    IFP_BAD_PNET_FRAME,
			PSTN_FAX_TRANS,    PNET_FAX_TRANS
		} libRetVal;

	#endif	// ASSEMBLER


#endif	// __XCHG_H__
