/* Interface to the SystemAPB of the L7205
 * Tue 25th July 2000 DR Ellis
 */
#include "SystemAPB.h"
#include "utils.h"
#include "memory.h"
#include <stdio.h>

char Timer[0x44];

int SystemAPB_init (void) {
    fout ("Initialising SystemAPB\n");
    return 0;
}

AbortOrNot
SystemAPB_clock (
    BusState*   state
) {
    switch (state->address & L7205_SYSTEM_APB_BRIDGE_MASK) {
    case L7205_INT_BASE:        break;
    case L7205_RTC_BASE:        break;

    case L7205_TIMER_BASE:
        if (state->write)
        {
            Timer[state->address & 0xff] = state->data;
        } else {
            state->data = Timer[state->address & 0xff];
        }
        return DataSuccess;
    break;

    case L7205_KEYBOARD_BASE:   break;
    case L7205_GPIO_BASE:       break;
    case L7205_DC_BASE:         break;
    case L7205_SMIREG_BASE:     break;
    default:
        fout ("Unmapped SystemAPB access\n");
        replay_regs ();
        return DataAbort;
        break;
    }

    fout ("CommsASB access %x\n", state->address);

    return DataSuccess;
}

void IOMD_tick (int num) {
}
